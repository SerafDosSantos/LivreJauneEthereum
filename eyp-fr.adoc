== ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION REGISTRE

*BERLIN VERSION 630ed56 – 2022-02-13*

DR. GAVIN BOIS FONDATEUR, ÉTHERUM & PARITÉ

GAVIN@PARITY.IO

Abstrait. Le paradigme de la blockchain, lorsqu'il est associé à des transactions sécurisées par cryptographie, a démontré son utilité à travers un certain nombre de projets, Bitcoin étant l'un des plus remarquables. Chacun de ces projets peut être considéré comme une application simple sur une ressource de calcul décentralisée, mais unique. Nous pouvons appeler ce paradigme un modèle transactionnel singleton machine avec état partagé.

Ethereum implémente ce paradigme de manière généralisée. En outre, il fournit une pluralité de telles ressources, chaque avec un distinct Etat et en fonctionnement code mais capable pour interagir par un passage de message cadre avec autres. Nous discuter son motif, la mise en oeuvre questions, la Opportunités ce fournit et la futur obstacles nous envisager.

[arabic]
. Introduction

Avec omniprésent l'Internet Connexions dans plus des endroits du monde, la transmission mondiale de l'information est devenue incroyablement bon marché. Des mouvements ancrés dans la technologie comme Bit- coin ont démontré par la puissance du défaut, les mécanismes de consensus et le respect volontaire du social Contrat, que ce est possible pour utiliser la l'Internet pour Fabriquer un système de transfert de valeur décentralisé et partageable à travers le monde et pratiquement gratuit à utiliser. Ce système peut être considéré comme une version très spécialisée d'un cryptographe- machine d'état basée sur les transactions et sécurisée. Suivi des systèmes tels que Namecoin ont adapté cette « monnaie l'application" de la technologie dans d'autres applications bien que plutôt simpliste ceux.

Ethereum est un projet qui tente de construire la génération technologie généralisée; technologie sur laquelle toutes les transactions des concepts de machine à états basés peuvent être construits. De plus il vise à fournir au développeur final une solution étroitement intégrée système de bout en bout pour créer des logiciels sur un paradigme de calcul exploré dans le courant dominant : une approche de confiance objet Messagerie calculer cadre.

[arabic]
. *Conduite Facteurs.*
Là sont beaucoup objectifs de cette projet; l'un des principaux objectifs est de faciliter les transactions entre des personnes consentantes qui n'auraient autrement aucun moyen se faire confiance. Cela peut être dû à la géographie séparation, interfaçage difficulté, ou alors peut-être la incompatible- capacité, incompétence, réticence, dépense, incertitude, les inconvénients ou la corruption des systèmes juridiques existants. Par en précisant un changement d'état système par un riche et unam- langage bigu, et en outre l'architecture d'un système de telle sorte que nous pouvons raisonnablement nous attendre à ce qu'un accord être Donc forcée de manière autonome, nous pouvez fournir un moyens pour cette finir.

____
Les transactions dans ce système proposé auraient plusieurs les attributs ne pas souvent trouvé dans la réel monde. Le incorruptible- capacité de jugement, souvent difficile à trouver, vient naturellement d'un interprète algorithmique désintéressé. Transparence, ou être capable de voir exactement comment un état ou un jugement est venu à propos du journal des transactions et des règles ou des instructions codes, ne se produit jamais parfaitement dans les systèmes humains puisque Naturel Langue est nécessairement vague, information

fait souvent défaut, et les vieux préjugés sont difficiles à secouer.

Globalement, nous souhaitons fournir un système tel que les utilisateurs peut être garanti que, peu importe avec quel autre individu des particuliers, systèmes ou alors organisations elles ou ils interagir, elles ou ils pouvez le faire avec une confiance absolue dans les résultats possibles et comment ceux résultats pourrait viens à propos.
____

[arabic, start=2]
. *Précédent travail.* link:#_bookmark73[Buterin [2013a] a d'] abord proposé la noyau de ce travail fin novembre 2013. Bien que maintenant évolué à bien des égards, la fonctionnalité clé d'un bloc- chaîne avec un langage Turing-complet et une la capacité de stockage inter-transaction illimitée reste modifié.

____
link:#_bookmark91[Dwork et Naor [1992]] ont fourni les premiers travaux sur la utilisation d'une preuve cryptographique des dépenses de calcul ture (“preuve de travail”) comme moyen de transmettre une valeur signaler sur Internet. Le signal de valeur a été utilisé ici comme un Spam dissuasion mécanisme plutôt que quelconque type de devise, mais critique démontré la potentiel pour un canal de données de base pour véhiculer un _signal économique fort_ , permettant à un récepteur de faire une assertion physique sans avoir à compter sur la _confiance_ . link:#_bookmark69[Arrière] link:#_bookmark69[[2002]] a produit plus tard un système dans un similaire veine.

Le premier exemple d'utilisation de la preuve de travail comme signal économique fort pour sécuriser une monnaie a été par link:#_bookmark107[Vish-] link:#_bookmark107[numurthy et al.] link:#_bookmark107[[2003].] Dans ce cas, le jeton était utilisé pour contrôler le commerce de fichiers peer-to-peer, fournissant « consommateurs » avec la possibilité d'effectuer des micro-paiements pour « fournisseurs » pour leurs services. Le modèle de sécurité offert par la preuve de travail a été complétée par des signatures numériques et un registre afin de s'assurer que le dossier historique ne pouvait pas être corrompu et que les acteurs malveillants ne pouvaient pas falsifier le paiement ou se plaindre injustement de la prestation de services éry. Cinq ans plus tard, link:#_bookmark87[N akamoto [2008] a] introduit un autre un tel jeton de valeur sécurisé par preuve de travail, un peu plus large dans portée. Le fruit de ce projet, Bitcoin, est devenu le premier largement adopté global décentralisé transaction registre.

D'autres projets construits sur le succès de Bitcoin ; les altcoins introduit de nombreuses autres monnaies par altération au protocole. Certains des plus connus sont Litecoin et Primecoin, discuté par link:#_bookmark101[Sprankel [2013].] Autres projets recherché pour prendre la coeur valeur teneur mécanisme de la pro- tocol et réutiliser ce; link:#_bookmark70[Arron [2012]] discute, pour Exemple,

1

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 2

le projet Namecoin qui vise à fournir une solution décentralisée résolution de nom système.

D'autres projets visent toujours à s'appuyer sur le réseau Bitcoin. travail lui-même, tirant parti de la grande quantité de valeur placée dans le système et la grande quantité de calcul qui va dans le mécanisme de consensus. Le projet Mastercoin, proposé pour la première fois par link:#_bookmark109[Willett] link:#_bookmark109[[2013],] vise à construire un monde plus riche protocole impliquant de nombreuses fonctionnalités supplémentaires de haut niveau sur top du protocole Bitcoin grâce à l'utilisation d'un numéro de pièces auxiliaires au protocole de base. Le Coloré Pièces de monnaie

lui-même - ce serait beaucoup trop grand). Ils ponctuent également le série de transactions avec des incitations pour les nœuds à _exploiter_ . Cette l'incitation a lieu comme une fonction de transition d'état, ajouter valeur pour un nommé Compte.

L'exploitation minière est le processus qui consiste à consacrer des efforts (travailler) à renforcer une série de transactions (un bloc) par rapport à toute autre potentiel concurrent bloc. Ce est atteint Merci pour un preuve cryptographiquement sécurisée. Ce schéma est connu sous le nom de preuve de travail et est discuté dans détail dans section link:#11.5._Mining_Proof-of-Work[11.5.]

Officiellement, nous étendre pour:

projet, proposé par link:#_bookmark89[Rosenf eld et al. [2012],] prend une approche similaire mais stratégie plus simplifiée, embellissant les règles d'un transaction afin de briser la fongibilité des Bitcoins base devise et Autoriser la création et suivi de jetons par un spécial "chroma-wallet"-conscient du protocole pièce de

(2)

(3)

(4)
____

_*σ* t_ +1 ≡ link:#_bookmark67[Π (] _*σ* t , B_ )

_B_ ≡ ( _...,_ ( _T_ 0 _, T_ 1 _, ..._ ) _, ..._ )

Π ( _*σ* , B_ ) ≡ link:#_bookmark65[Ω(] _B,_ link:#_bookmark0[Υ ( Υ (] _*σ* , T_ 0 ) _, T_ 1 ) _..._ )

Où link:#_bookmark65[Ω] est la bloc-finalisation Etat passage fonction-

____
Logiciel.

Supplémentaire travail possède a été Fini dans la région avec Jeter- la fondation de la décentralisation ; Ripple, discuté par link:#_bookmark74[Boutellier et Heinzen [2014],] a cherché à créer une « éré » système pour devise échanger, effectivement créer un nouveau système de compensation financière. Il a démontré que des gains d'efficacité élevés peuvent être réalisés si la décentralisation prémisse est mis au rebut.

Les premiers travaux sur les contrats intelligents ont été réalisés par link:#_bookmark103[Szabo] link:#_bookmark103[[1997]] et link:#_bookmark86[Meunier [1997].] Environ la années 1990 ce devenu dégager que l'application algorithmique des accords pourrait devenir un important Obliger dans Humain la coopération. Mais non spécifique système a été proposé pour mettre en œuvre un tel système, il a été proposé que l'avenir du droit serait fortement affecté par de tels systèmes. Dans cette optique, Ethereum peut être considéré comme un général la mise en oeuvre de tel un _crypto-loi_ système.

Pour un liste de termes utilisé dans cette papier, référer pour Appen- dix link:#Appendix_A._Terminology[UN.]
____

[arabic, start=2]
. {blank}
+
____
Le Chaîne de blocs Paradigme
____

____
Ethereum, pris comme un entier, pouvez être vu comme un basé sur les transactions Etat machine: nous commencer avec un gen- esis état et exécute progressivement des transactions pour transformer dans un état actuel. C'est cet état actuel que nous J'accepte comme la canonique "version" de la monde de Ethereum. L'État peut inclure de telles informations comme compte bal- ances, réputations, confiance arrangements, Les données se rapportant aux informations du monde physique ; bref, n'importe quoi qui peut actuellement être représenté par un ordinateur est admis- possible. Les transactions représentent donc un arc valide entre deux États; la partie 'valide' est importante—il en existe beaucoup plus invalide Etat changements que valide Etat changements. Invalide Etat les changements peuvent, par exemple, être des choses telles que la réduction d'un compte équilibre sans une augmentation égale et opposée ailleurs. UN valide Etat passage est une qui vient à propos par un transaction. Officiellement:

tion (une fonction qui récompense une partie désignée); link:#4.3._The_Block[_B_] est-ce bloc, qui comprend une série de transactions entre certains autre Composants; et link:#_bookmark67[Π] est la au niveau du bloc transition d'état une fonction.

C'est la base du paradigme de la blockchain, un modèle qui forme l'épine dorsale non seulement d'Ethereum, mais tout décentralisé basée sur le consensus transaction systèmes pour Date.
____

[arabic]
. *Valeur.* Afin d'encourager le calcul au sein du réseau, il doit y avoir une méthode convenue pour la transmission valeur ting. Pour résoudre ce problème, Ethereum a une capacité intrinsèque devise, Éther, connu aussi comme EPF et parfois référé pour par _ la Vieille Anglais ¯ D. Le le plus petit sous- dénomination d' Ether , et donc celui dans lequel toutes les valeurs entières de la monnaie sont comptées, est le Wei. Un éther est défini comme étant 10 ^18^ Wei. Il existe d'autres sous-dénominations de Éther:

____
Multiplicateur Nom

10 0 Wei

10 ^12^ Szabo

10 ^15^ Finney

10 ^18^ Éther

Tout au long de la cadeau travail, quelconque référence pour valeur, dans le cadre d'Ether, de devise, d'un solde ou d'un paiement, devrait être assumé pour être dénombré dans Wei.
____

[arabic, start=2]
. *Quelle Histoire ?* Puisque le système est décentralisé et toutes les parties ont la possibilité de créer un nouveau bloc sur quelques plus âgée préexistant bloc, la résultant structure est nécessairement un arbre de blocs. Afin de former un consensus quant à quel chemin, de la racine link:#_bookmark153[(le bloc de genèse] ) à la feuille (le bloc contenant les transactions les plus récentes) via cette arbre structure, connu comme la chaîne de blocs, là doit être un schéma convenu. Si jamais il y a un désaccord entre les nœuds quant au chemin de la racine à la feuille dans le bloc arbre est la 'meilleur' chaîne de blocs, alors un _fourchette_ se produit.

____
{empty}(1) [#_bookmark0 .anchor]##*_σ_*
____

_j_ +1

____
≡ Υ( _*σ* t , J_ )

Cette voudrais moyenne que passé un donné indiquer dans temps (bloc), plusieurs États de la système mai coexister: quelques nœuds être-

où Υ est la Ethereum Etat passage une fonction. Dans Ethereum, Υ, ensemble avec *_σ_* sont considérablement Suite pou- énervant que quelconque existant comparable système; Υ permet com- composants pour effectuer des calculs arbitraires, tandis que *_σ_* permet Composants pour boutique arbitraire Etat entre transactions. Les transactions sont regroupées en blocs ; les blocs sont enchaînés ensemble en utilisant un cryptographique hacher comme un moyens de référer- ence. Blocs une fonction comme un journal, enregistrement un séries de transactions ensemble avec la précédent bloc et un iden- tifier pour la final Etat (mais faire ne pas boutique la final Etat

croire une bloc pour contenir la canonique transactions, d'autres nœuds croyant qu'un autre bloc est canonique, contenant potentiellement des produits radicalement différents ou incompatibles transactions. Ceci doit être évité à tout prix car l'ONU- la certitude qui s'ensuivrait tuerait probablement toute confiance dans la entier système.

Le schéma que nous utilisons pour générer un consensus est un version simplifiée du protocole GHOST introduite par link:#_bookmark100[Sompolinsky et Zohar [2013].] Ce processus est décrit dans détail dans section link:#10._Blocktree_to_Blockchain[dix.]

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 3

Parfois, un chemin suit un nouveau protocole d'un hauteur particulière (numéro de bloc). Ce document décrit une version de la protocole, à savoir le _Berlin_ version défini par link:#_bookmark72[Beiko et al. [2021b].] Afin de suivre en arrière le historique d'un chemin, il faut référencer plusieurs versions de ce document. Voici les numéros de bloc du protocole mises à jour sur la Ethereum principale réseau:
____

[width="100%",cols="45%,55%",options="header",]
|===
a|
____
Nom
____

|Première Bloc Numéro
a|
____
Ferme _F_
____

|1150000
a|
____
_F_ TangerineSifflet
____

|2463000
a|
____
_F_ SpuriousDragon
____

|2675000
a|
____
_Fa_ Byzance
____

|4370000
a|
____
_F_ Constantinople
____

|7280000
a|
____
_Saint_ -Pétersbourg
____

|7280000
a|
____
_F_ Istanbul
____

|9069000
a|
____
_F_ MuirGlacier
____

|9200000
a|
____
_F_ Berlin
____

|12244000
a|
____
_F_ Londres
____

|12965000
a|
____
Flèche _FGlacier_
____

|13773000
|===

____
Parfois, les acteurs ne sont pas d'accord sur un changement de protocole, et une fourche permanente se produit. Afin de distinguer être- entre les blockchains divergentes, EIP-155 par link:#_bookmark79[Buterin] link:#_bookmark79[[2016b]] introduit la concept de chaîne IDENTIFIANT, qui nous dénoter par _β_ .

Pour la Ethereum principale réseau

{empty}(5) [#_bookmark1 .anchor]##_β_ = 1
____

[arabic, start=3]
. {blank}
+
____
Conventions
____

____
Nous utilisons un certain nombre de conventions typographiques pour la notation formelle, dont certaines sont assez particulières à la cadeau travail:

Les deux ensembles de valeurs d'état hautement structurées de « niveau supérieur » ues, sont indiqués par des lettres grecques minuscules en gras. Ils tombent dans ceux d'état-monde, qui sont notés *_σ_* (ou un une variante là-dessus) et ceux de état de la machine, *_µ_* .

Les fonctions en fonctionnement sur très structuré valeurs sont dénoté avec un majuscule grec lettre, par exemple link:#_bookmark0[Υ,] la Ethereum Etat passage une fonction.

Pour la plupart des fonctions, une lettre majuscule est utilisée, par exemple _C_ , la fonction de coût général. Ceux-ci peuvent être souscrits à désignent des variantes spécialisées, par exemple link:#_bookmark146[_C_ SSTORE] , la fonction de coût tion pour la link:#_bookmark145[STORE] opération. Pour spécialisé et peut-être

fonctions définies en externe, nous pouvons formater comme une machine à écrire texte, par exemple la Keccak-256 hacher une fonction (comme par version 3 de la gagnant entrée pour la SHA-3 concours par link:#_bookmark75[Bertoni] link:#_bookmark75[et Al. [2011],] plutôt que la final SHA-3 spécification), est

noté KEC (et généralement appelé Keccak ordinaire). Aussi, KEC512 fait référence pour la Keccak-512 hacher une fonction.

Tuples sont typiquement dénoté avec un majuscule lettre,

par exemple _T_ , est utilisé pour désigner une transaction Ethereum. Cette symbole mai, si par conséquent défini, être indice pour référer pour un individuel composant, par exemple link:#_bookmark40[_T_ n] , dénote la nonce de mentionné transaction. Le formulaire de la indice est utilisé pour

désigner son type ; par exemple, les indices majuscules font référence aux tuples avec inscriptible Composants.

Scalaires et séquences d'octets de taille fixe (ou, synonyme, tableaux) sont dénoté avec un Ordinaire minuscule lettre, par exemple _n_ est utilisé dans le document pour désigner une link:#_bookmark40[transaction nonce.] Ceux avec un notamment spécial sens mai être Grec,

par exemple _δ_ , le nombre d'éléments requis sur la pile pour un donné opération.

Les séquences de longueur arbitraire sont généralement désignées par un lettre minuscule en gras, par exemple *o* est utilisé pour désigner l'octet séquence donnée comme données de sortie d'un appel de message. Pour valeurs particulièrement importantes, une lettre majuscule en gras peut être utilisé.

Partout, nous supposons que les scalaires sont des intégraux non négatifs. Gers et Donc appartenir pour la Positionner N. _ Le Positionner de tout octet séquences est B , officiellement défini dans annexe link:#Appendix_B._Recursive_Length_Prefix[B] Si tel un ensemble de séquences est restreint à celles d'un longueur, ce est dénoté avec un indice, Donc la Positionner de tout

les séquences d'octets de longueur 32 sont nommées B 32 et l'ensemble des tout non négatif entiers plus petite que 2 ^256^ est nommé N 256 . Cette est officiellement défini dans section link:#4.3._The_Block[4.3.]

Les crochets sont utilisés pour indexer et référencer composants individuels ou sous-séquences de séquences, par exemple *_µ_ s* [0] désigne le premier élément de la pile de la machine. Pour sous-séquences, les ellipses sont utilisées pour spécifie le prévu gamme, pour inclure des éléments aux deux limites, par exemple *_µ_ m* [0 _.._ 31] dénote la première 32 éléments de la Machines Mémoire.

Dans le cas de l'état global *_σ_* , qui est une séquence de comptes, eux-mêmes tuples, les crochets sont utilisés pour référence un individuel Compte.

Lorsque nous considérons des variantes de valeurs existantes, nous suivons la règle que dans un donné portée pour définition, si nous supposons que la valeur 'd'entrée' non modifiée soit désignée par la espace réservé alors la modifié et utilisable valeur est

dénoté comme , et intermédiaire valeurs voudrais être ∗ , ∗∗

&c. Lors d'occasions très particulières, afin de maximiser lisibilité et seulement si le sens est sans ambiguïté, nous pouvons utiliser des indices alphanumériques pour désigner les valeurs intermédiaires, particulièrement ceux de particulier Remarque.

Lors de l'examen de l'utilisation des fonctions existantes, compte tenu d'un fonction _f_ , la fonction link:#_bookmark27[_f_ ^∗^] désigne un élément similaire version du mappage de fonction à la place entre les séquences. Ce est officiellement défini dans section link:#4.3._The_Block[4.3.]

Nous définissons un certain nombre de fonctions utiles tout au long. [#_bookmark2 .anchor]####Une de la Suite commun est _.€_ , qui _ _ e v alue pour la dernière article dans la donné séquence:

{empty}(6) _.€_ ( *x* ) ≡ *x* [ ll *x* ll − 1]
____

[arabic, start=4]
. {blank}
+
____
Blocs, État et Transactions
____

____
Ayant introduit la basique notions derrière Ethereum, nous discuterons de la signification d'une transaction, d'un bloc et la Etat dans Suite détail.
____

[arabic]
. *Monde État.* Le monde Etat ( _état_ ), est un carte- ping entre les adresses (identifiants 160 bits) et le compte états (une structure de données sérialisée en tant que RLP, voir l'annexe link:#Appendix_B._Recursive_Length_Prefix[B).] Mais ne pas stockée sur la chaîne de blocs, ce est assumé que l'implémentation maintiendra cette cartographie dans une modi- fié Merkle Patricia arbre ( _trie_ , voir l'annexe link:#Appendix_D._Modified_Merkle_Patricia_Tre[D).] L'essai nécessite une base de données simple qui maintient une carte- ping de tableaux d'octets vers des tableaux d'octets ; nous nommons ce sous-jacent base de données la base de données d'état. Cela a un certain nombre d'avantages; premièrement le noeud racine de cette structure est cryptographiquement dépendant sur tout interne Les données et comme tel son hacher pouvez être utilisé comme une identité sécurisée pour l'ensemble de l'état du système. Deuxièmement, étant une structure de données immuable, elle permet à tout précédent Etat (à qui racine hacher est connu) pour être rappelé en modifiant simplement le hachage racine en conséquence. Depuis que nous stocker tous ces hachages racine dans la blockchain, nous sommes en mesure de trivialement revenir pour vieille États.

____
ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 4

L'état du compte, *_σ_* [ _a_ ], comprend les quatre des champs:

[#_bookmark3 .anchor]##*nonce :* une valeur scalaire égale au nombre de trans- Actions expédié depuis cette adresse ou alors, dans la Cas de comptes avec code associé, le nombre de les créations de contrats effectuées par ce compte. Pour ac- compte de l'adresse _a_ dans l'état *_σ_* , ce serait pour- mally dénoté *_σ_* [ _une_ ] n .

*solde:* UN scalaire valeur égal pour la Numéro de Wei

possédé _ par _ cette adresse. Formellement _ dénoté *_σ_* [ _une_ ] ~b~ .

*racine de stockage :* Un hachage de 256 bits du nœud racine d'un arbre Merkle Patricia qui encode la configuration de stockage tentes du compte (un mappage entre 256 bits entier valeurs), codé dans la essayer comme un cartographie à partir du hachage Keccak 256 bits de l'entier 256 bits clés aux valeurs entières 256 bits codées RLP. Le hacher est officiellement dénoté *_σ_* [ _une_ ] s .

*hachage de code :* Le hacher de la EVM code de cette

compte—ce est la code que obtient réalisé devrait cette adresse recevoir un message appel; ce est immuable et Donc, contrairement à tout autre des champs, ne peux pas être modifié après chantier. Tous ces fragments de code sont contenus dans la base de données de l'État sous leur corres- hachages répondants pour une récupération ultérieure. Ce hachage est officiellement dénoté *_σ_* [ _une_ ] c , et Donc la code mai être

dénoté comme *b* , donné que CEC ( *b* ) = *_σ_* [ _une_ ] c .

Puisque nous souhaitons généralement ne pas nous référer à la racine du trie hachage mais à l'ensemble sous-jacent de paires clé/valeur stockées dans, nous définir un pratique équivalence:
____

[arabic, start=7]
. TRIE _L_ ^∗^ ~je~ ( *_σ_* [ _une_ ] *~s~* ) ≡ *_σ_* [ _une_ ] ~s~

____
La fonction de réduction pour l'ensemble de paires clé/valeur dans la essayer, _L_ ^∗^ ~je~ , est d' amende comme la élément en t transformation de la base une fonction _L_ je , donné comme:
____

[arabic, start=8]
. _L_ je ( _k, v_ ) ≡ KEC ( _k_ ) _,_ RLP ( _v_ ) où:

____
{empty}(9) _k_ ∈ B 32 ∧ _v_ ∈ N

Ce devoir être entendu que *_σ_* [ _une_ ] *s* est ne pas un 'physique' membre du compte et ne contribue pas à son utilisation ultérieure sérialisation.

Si la *codeHash* domaine est la Keccak-256 hacher de la vider corde, c'est à dire *_σ_* [ _une_ ] c = KEC () , alors la nœud représente un Facile Compte, parfois référé pour comme un "hors contrat" Compte.

Ainsi nous mai définir un état-monde s'effondrer une fonction _L_ S :

{empty}(10) _L_ S ( *_σ_* ) ≡ \{ _p_ ( _une_ ) : *_σ_* [ _une_ ] ∅ }

où

{empty}(11) _p_ ( _une_ ) ≡ KEC ( _une_ ) _,_ RLP ( *_σ_* [ _une_ ] ~n~ _, *σ *_[ _une_ ] ~b~ _, *σ *_[ _une_ ] ~s~ _, *σ *_[ _une_ ] ~c~ )

Cette une fonction, _L_ S , est utilisé aux côtés de la essayer une fonction pour fournir une courte identité (hachage) de l'état du monde. Nous présumer:

{empty}(12) ∀ _une_ : *_σ_* [ _une_ ] = ∅ ∨ ( _une_ ∈ B 20 ∧ _v_ ( *_σ_* [ _une_ ])) où _v_ est la Compte validité une fonction:

+++(13 ) _v_ ( _x_ ) ≡+++ _xn_ ~_~ ∈ N ~25 6~ ∧ _x_ ~b~ ∈ N ~25 6~ ∧ _x_ ~s~ ∈ B ~3 2~ ∧ _x_ ~c~ ∈ B ~32~

Un Compte est _vider_ lorsque ce possède non code, zéro nonce et zéro solde:

(14)

VIDE ( _*σ* , une_ ) ≡ *_σ_* [ _une_ ] ~c~ = KEC () ∧ *_σ_* [ _une_ ] ~n~ = 0 ∧ *_σ_* [ _une_ ] ~b~ = 0

Même les contrats précompilés appelables peuvent avoir un vide état du compte. C'est parce que leurs états de compte ne habituellement contenir la code décrivant son comportement.

Un compte est _mort_ lorsque son état de compte est inexistant ou alors vider:

{empty}(15) MORT ( _*σ* , un_ ) ≡ *_σ_* [ _une_ ] = ∅ ∨ VIDE ( _*σ* , un_ )
____

[arabic]
. *La transaction.* Une transaction (formellement, _T_ ) est un instruction unique signée cryptographiquement construite par un acteur de cinéma extérieurement pour la portée de Ethereum. Le expéditeur d'une transaction ne peut être un contrat. Alors qu'on suppose que l'acteur externe ultime sera de nature humaine, des outils logiciels seront utilisés pour sa construction et sa diffusion. pays link:#_bookmark10[^1^] . EIP-2718 par link:#_bookmark110[Zoltu [2020]] introduit la notion de différents types de transactions. À partir de la version berlinoise de le protocole, il existe deux types de transactions : 0 (hérité) et 1 (EIP-2930 par link:#_bookmark80[Butérine et Suède [2020b]).] Plus loin, il existe deux sous-types de transactions : celles qui résultent dans les appels de message et ceux qui entraînent la création de nouveaux comptes avec code associé (appelé officieusement "création de contrat"). Tous les types de transactions spécifient un nombre de commun des champs:

____
[#_bookmark4 .anchor]##*taper:* EIP-2718 transaction taper; officiellement _Tx_ . _

*nonce :* UN scalaire valeur égal pour la Numéro de trans- [#_bookmark5 .anchor]####Actions expédié par la expéditeur; officiellement _Tn_ . _

*prix du gaz :* UN scalaire valeur égal pour la Numéro de

Wei à payer par unité de _gaz_ pour tous les calculs les frais occasionnés par l'exécution de la présente [#_bookmark6 .anchor]####transaction; officiellement _T_ p .

*Limite de gaz :* UN scalaire valeur égal pour la maximum

quantité de gaz qui doit être utilisée dans l'exécution cette opération. Ceci est payé d'avance, avant tout le calcul est fait et ne peut pas être augmenté plus tard; officiellement _Tg_ . _

*pour:* Le 160 bits adresse de la message appels recette-

ent ou, pour une opération de création de contrat, ∅ , utilisé ici pour dénoter la seul membre de B 0 ; officiellement [#_bookmark7 .anchor]##_T_ t .

*valeur:* UN scalaire valeur égal pour la Numéro de Wei pour

être transféré pour la message appels destinataire ou alors, en cas de création de contrat, en tant que dotation [#_bookmark8 .anchor]####pour la nouvellement créé Compte; officiellement _Tv_ . _

*r, s :* Valeurs correspondant pour la Signature de la

transaction et utilisé pour déterminer l'expéditeur de la transaction; formellement _T_ r et _Ts_ . _ C'est ex- pané dans annexe link:#Appendix_F._Signing_Transactions[F.]

EIP-2930 (taper 1) transactions aussi avoir:

*liste d'accès :* [#_bookmark9 .anchor]####Liste des entrées d'accès à réchauffer ; pour- mally _TA_ . *~_~* Chaque accéder liste entrée _E_ est un tuple de un Compte adresse et un liste de stockage clés:

_E_ ≡ ( _E_ a _, E_ *s* ).

*ID de chaîne :* ID de chaîne ; formellement _T_ c . Doit être égal à la réseau chaîne IDENTIFIANT link:#_bookmark1[_β_] .

*yParité :* Signature Oui parité; officiellement _T_ y .

1 [#_bookmark10 .anchor]####Notamment, ces « outils » pourraient finalement devenir si causalement éloignés de leur initiation basée sur l'homme - ou les humains pourraient devenir si éloignés causalement neutres - qu'il pourrait y avoir un point où ils pourraient à juste titre être considérés comme des agents autonomes. par exemple, les contrats peuvent offrir des primes à humains pour être expédié transactions pour lancer leur exécution.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 5

Les transactions héritées n'ont pas de liste d' *accès* ( _T_ *~A~* = ()), tandis que *chainId* et *yParity* pour les transactions héritées sont combiné dans un Célibataire valeur:

{empty}[#_bookmark11 .anchor]##*w :* un scalaire valeur codage Y parité et possibilité ID de chaîne bly ; formellement _T_ w . _T_ w = 27 + _T_ y ou _T_ w = 2 _β_ +35+ _T_ y (voir EIP-155 par link:#_bookmark79[Butérine [2016b]).]

En outre, un Contrat création transaction (indépendamment qu'il s'agisse héritage ou alors EIP-2930) contient:

*initialisation :* Un illimité Taille octet déployer en précisant la Code EVM pour la procédure d'initialisation du compte, officiellement _T_ *~je~* .

*init* est un Code EVM fragment; ce Retour la *corps* , un deuxième fragment de code qui s'exécute à chaque fois que le compte reçoit un message d'appel (soit via un trans- action ou due à l'exécution interne de code). *init* est exécuté une seule fois lors de la création du compte et est supprimé immédiatement après.

Dans contraste, un message appel transaction contient:

*Les données:* Un tableau d'octets de taille illimitée spécifiant saisir Les données de la message appel, officiellement _Td_ . *~_~*

annexe link:#Appendix_F._Signing_Transactions[F] spécifie la fonction, _S_ , qui mappe trans- actions à l'expéditeur, et passe par l'ECDSA de la courbe SECP-256k1, en utilisant le hash de la transaction (excepté la dernier Trois Signature des champs) comme la données pour signe. Pour la cadeau nous simplement affirmer que la expéditeur de un donné transaction _J_ pouvez être représentée avec _S_ ( _T_ ).

(16)

[#_bookmark12 .anchor]##( _T_ n _, T_ p _, T_ g _, T_ t _, Télé ,_ _ *p* _, T_ w _, T_ r _, T_ s ) si _T_ x = 0

[#_bookmark13 .anchor]##*hachage parent :* Le Keccak 256 bits hacher de la parent bloc de entête, dans son intégralité; officiellement _H_ p .

*ommersHash :* Le Keccak 256 bits hacher de la om-

mers liste portion de cette bloc; officiellement _H_ o .

*Bénéficiaire:* L'adresse 160 bits à laquelle tous les frais collectés à partir de l'exploitation minière réussie de ce bloc être transféré; officiellement _Hc_ . _

*étatRoot :* Le Keccak 256 bits hacher de la racine

nœud du trie d'état, après que toutes les transactions sont réalisé et finalisations appliqué; officiellement _Hr_ . _

*transactionsRoot :* Le Keccak hachage 256 bits de la

racine nœud de la essayer structure peuplé avec chaque transaction dans la partie liste des transactions du bloc; officiellement _H_ t .

*reçusRoot :* Le Keccak 256 bits hacher de la racine

nœud de la structure de trie peuplée de la re- reçus de chaque transaction dans la liste des transactions portion de la bloc; officiellement _Il_ . _

*logsBloom :* Le Floraison filtre composé depuis indice-

informations disponibles (adresse de l'enregistreur et rubriques du journal) contenues dans chaque entrée de journal à partir de la réception de chaque transaction dans la liste des transactions ; officiellement _H_ ~b~ .

*difficulté:* UN scalaire valeur correspondant pour la dif-

niveau de difficulté de ce bloc. Cela peut être calculé depuis la précédent bloc de difficulté niveau et la horodatage ; officiellement _Hd_ . ~_~

*Numéro:* UN scalaire valeur égal pour la Numéro de un-

blocs cestor. Le bloc de genèse a un certain nombre de zéro; officiellement link:#_bookmark30[_Salut_] . link:#_bookmark30[_]

où

c n p g t v

*UN* r _ s x

[#_bookmark14 .anchor]####de gaz dépense par bloc; officiellement _H_ ~l~ .

*gazutilisé :* UN scalaire valeur égal pour la total gaz utilisé

{empty}(17) *p* _T_ *~je~* si _T_ ~t~ = ∅

_T_ *~d~* autrement

Ici, nous supposons que tous les composants sont interprétés par le RLP sous forme de valeurs entières, à l'exception de la liste d'accès _TA_ *~_~* et la arbitraire longueur octet tableaux _T_ *~je~* et _Td_ . *~_~*

{empty}(18) _T_ x ∈ \{ 0 _,_ 1 } ∧ _T_ c = _β_ ∧ _T_ n ∈ N 256 ∧ _T_ p ∈ N 256 ∧ _T_ g ∈ N 256 ∧ _T_ v ∈ N 256 ∧ _T_ w ∈ N 256 ∧ _T_ r ∈ N 256 ∧ _T_ s ∈ N 256 ∧ _T_ ~y~ ∈ N ~1~ ∧ _T_ *~d~* ∈ B ∧ _T_ *~je~* ∈ B

où

{empty}(19) N n = \{ _P_ : _P_ ∈ N ∧ _P <_ 2 _n_ }

Le hachage d'adresse _T_ *t* est légèrement différente : il s'agit soit d'un Hachage d'adresse de 20 octets ou, dans le cas d'un contrat- création transaction (et Donc officiellement égal pour ∅ ), ce est

la RLP vider octet séquence et Donc la membre de B 0 :

dans transactions dans cette bloc; officiellement _Hg_ . _

*horodatage :* une valeur scalaire égale à la valeur raisonnable sortie de time() d'Unix au début de ce bloc ; [#_bookmark15 .anchor]####officiellement link:#_bookmark32[_Hs_] . link:#_bookmark32[_]

*extraData :* Un arbitraire octet déployer contenant Les données

correspondant à ce bloc. Celui-ci doit être de 32 octets ou [#_bookmark16 .anchor]####moins de; officiellement _Hx_ . _

*mixHash :* UN 256 bits hacher qui, combiné avec la

fois, prouve qu'une quantité suffisante de calcul tation a été effectuée sur ce bloc ; officiellement [#_bookmark17 .anchor]##_Hm_ . _

*nonce :* UN 64 bits valeur qui, combiné avec la mélanger-

hash, prouve qu'une quantité suffisante de calcul tion a été effectuée sur ce bloc ; officiellement link:#_bookmark33[_Hn_] . link:#_bookmark33[_]
____

[arabic, start=20]
. _J_

____
∈ f B 20 si _T_ t = ∅

[#_bookmark18 .anchor]####Le autre deux Composants dans la bloc sont simplement un liste

B 0 sinon
____

[arabic]
. [#4.3._The_Block .anchor]##*Le Bloc.* Le bloc dans Ethereum est la recueillir- informations pertinentes (connu sous le nom de bloc _header_ ), _H_ , ainsi que les informations correspondant à les transactions comprises, *T* , et un ensemble d'autres blocs les en-têtes *U* dont on sait qu'ils ont un parent égal au le parent du parent du bloc actuel (ces blocs sont appelés _ommers_ link:#_bookmark20[^2^] ). Le bloc entête contient plusieurs des morceaux de information:

____
de ommer bloc en-têtes (de la même format comme au dessus de),

_BU_ *~_~* et un séries de la transactions, _BT_ . *~_~* Officiellement, nous pouvez référer pour un bloc _B_ :
____

[arabic, start=21]
. _B_ ≡ ( _BH ,_ ~_~ _B_ *~T~* _, B_ *~U~* )

____
2 [#_bookmark20 .anchor]##_heures_ est un neutre de genre terme pour moyenne "frère et sœur de parent"; voir https://nonbinary.miraheze.org/wiki/Gender_neutral_language_in_English%23Aunt/Uncle[https://nonbinary.miraheze.org/wiki/Gender_neutral_language_in_] https://nonbinary.miraheze.org/wiki/Gender_neutral_language_in_English%23Aunt/Uncle[Anglais#tante/oncle]

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 6
____

[arabic]
. {empty}[#_bookmark21 .anchor]##_Reçu de transaction._ Pour encoder des informations à propos un transaction concernant qui ce mai être utile pour former une preuve sans connaissance, ou indexer et rechercher, nous encoder un reçu de chaque transaction contenant certaines informations formation dès son exécution. Chaque reçu, noté _B_ *~R~* [ _i_ ] pour la _je_ e transaction, est placé dans un link:#_bookmark118[trie] indexée [#_bookmark22 .anchor]####et la racine enregistré dans la entête comme link:#_bookmark24[_Il_] . link:#_bookmark24[_]

____
Le transaction le reçu, _R_ , est un tuple de cinq éléments com-

en prenant : le type de transaction, _R_ x , le code de statut de la transaction, _R_ z , le gaz cumulé utilisé dans le bloc contenant le reçu de la transaction immédiatement après la transaction a eu lieu, _R_ u , l'ensemble des journaux créés par l'exécution de la transaction, link:#_bookmark116[_R_ *~l~*] et la floraison filtre composé _ _ _ _ depuis information dans ceux journaux, link:#_bookmark114[_R_ ~b~] :
____

[arabic, start=2]
. _Validité holistique._ On peut affirmer la validité d'un bloc si et seul si ce satisfait plusieurs conditions: ce doit être dans- ternellement compatible avec l'ommer et le bloc de transaction hachages et les transactions données _B_ *~T~* (comme spécifié dans sec link:#11._Block_Finalisation[11),] lorsqu'il est exécuté dans l'ordre sur l'état de base *_σ_* (dérivé à partir de l'état final du bloc parent), entraînent une nouvelle Etat de la identité _Hr_ : _

____
{empty}(33) [#_bookmark23 .anchor]##_H_ r ≡ TRIE ( _L S_ (Π( _*σ* , B_ ))) ∧ _H_ ~o~ ≡ KEC ( RLP ( _L_ ^∗^ _~H~_ ( _B_ *~U~* ))) ∧ _H_ ~t~ ≡ TRIE ( \{∀ _je <_ ll _B_ *~T~* ll _, je_ ∈ N :

_pT_ ( ~je~ _, B_ *~T~* [ _je_ ]) } ) ∧

[#_bookmark24 .anchor]##_H_ ~e~ ≡ TRIE ( \{∀ _je <_ ll _B_ *~R~* ll _, je_ ∈ N :

_p_ ~R~ ( _je, B_ *~R~* [ _je_ ]) } ) ∧

[#_bookmark26 .anchor]##_R_ x est égal au link:#_bookmark4[type] de l'opération correspondante.

Le une fonction _LR_ _ se prépare un transaction le reçu pour être transformé dans un RLP sérialisé octet déployer:
____

[arabic, start=23]
. _L_ ~R~ ( _R_ ) ≡ ( _R_ ~z~ _, R_ ~tu~ _, R_ ~b~ _, R_ *~l~* )

____
Nous affirmer que la statut code _R_ z est un non négatif

où _p_ T ( _k, v_ ) et _p_ R ( _k, v_ ) sont des transformées RLP par paires- mais avec un traitement spécial pour les transactions EIP-2718. tions :

(34)

_p_ ( _k, J_ ) RLP ( _k_ ) _,_ RLP ( link:#_bookmark12[_L_ T] ( _T_ )) si _T_ x = 0

( _T_ x ) · RLP ( _L_ T ( _T_ )) autrement

entier:
____

[arabic, start=24]
. _R_ z ∈ N

____
Nous affirmer que _R_ tu , la cumulatif gaz utilisé, est un non- négatif entier et que la journaux Floraison, _R_ ~b~ , est un hacher de

et

(35)

_p_ R ( _k, R_ ) ≡

RLP ( _k_ ) _,_

RLP ( link:#_bookmark26[_L_ R] ( _R_ )) si _R_ x = 0

( _R_ x ) · RLP ( _L_ R ( _R_ )) autrement

Taille 2048 morceaux (256 octets):
____

[arabic, start=25]
. _R_ ~tu~ ∈ N ∧ _R_ ~b~ ∈ B ~256~

____
Le séquence _R_ *~l~* est un séries de Journal entrées, ( _O_ ~0~ _, O_ ~1~ _, ..._ ). Une entrée de journal, _O_ , est un tuple de l'adresse de l'enregistreur, _O a_ , a série éventuellement vide de sujets de journal de 32 octets, _O_ *t* et certains Numéro de octets de Les données, _O_ *~d~* :

{empty}(26) _O_ ≡ ( _O_ ~un~ _,_ ( _O_ ~*t* 0~ _, O_ ~*t* 1~ _, ..._ ) _, O_ *~d~* )

{empty}(27) _O_ ~un~ ∈ B ~20~ ∧ ∀ _x_ ∈ _O_ *~t~* : _x_ ∈ B ~32~ ∧ _O_ *~d~* ∈ B

Nous définissons la fonction de filtre de Bloom, _M_ , pour réduire un log entrée dans un Célibataire 256 octets hacher:

( · est le _ _ enchaînement de par te _ arr a ys).

En outre:

{empty}(36) TRIE ( _L_ S ( *_σ_* )) = _P_ ( _BH __ ) _H_ r

Ainsi TRIE ( _L_ S ( *_σ_* )) est le hachage du nœud racine du Merkle Patricia arbre structure contenant la valeur clé paires de l'état *_σ_* avec des valeurs codées en utilisant RLP, et _P_ ( _B_ H ) est la parent bloc de _B_ , défini directement.

Les valeurs issues du calcul des transactions notamment les link:#_bookmark21[reçus de transaction,] _B_ *~R~* , et que défini par la link:#_bookmark67[fonction d'accumulation d'état] de la transaction link:#_bookmark67[tion, Π,] sont formalisé plus tard dans section link:#11.4._State_&_Nonce_Validation[11.4.]
____

[arabic]
. _Sérialisation._ Le une fonction _LB_ _ et _L_ H sont la prépa-

____
{empty}(28) _M_ ( _O_ ) ≡
____

_x_ ∈\{ _O_ une }∪ _O_ *t*

_M_ 3:2048 ( _x_ )

____
ration les fonctions pour un bloc et bloc entête respectivement. Nous affirmer la les types et Commande de la structure pour lorsque

où _M_ 3:2048 est un spécialisé Floraison filtre que ensembles Trois

la RLP transformation est obligatoire:

morceaux dehors de 2048, donné un arbitraire octet séquence. Ce Est-ce que

cette par prise la d'ordre inférieur 11 morceaux de chaque de la trois premières paires d'octets dans un hachage Keccak-256 de l'octet séquence. link:#_bookmark28[^3^] Officiellement:

(37)

(38)

_L_ ~H~ ( _H_ ) ≡ ( _H_ ~p~ _, Oh ,_ ~_~ _H_ ~c~ _, Hr ,_ ~_~ _H_ ~t~ _, Il ,_ ~_~ _H_ ~b~ _, Hd ,_ ~_~

_Salut ,_ ~_~ _Hl ,_ ~_~ _H_ ~g~ _, Hs ,_ ~_~ _Hx ,_ ~_~ _Hm ,_ ~_~ _H_ ~n~ )

_L_ ~B~ ( _B_ ) ≡ _L_ ~H~ ( _B_ ~H~ ) _, L_ ∗ T ( _B_ *~T~* ) _, L_ ^∗^ ~H~ ( link:#_bookmark18[_B_ *~U~*] )

{empty}(29) _M_

( *x* : *X* ∈

*y* : *y* ∈ B 256 où: (0 _,_ 0 _, ...,_ 0) à l'exception:

où _L_ J prend un spécial se soucier de EIP-2718 transactions:

B 2047 − _m_ ( *X* _, je_ ) ( *y* ) = 1

KEC ( *x* )[ _je, je_ + 1] mode 2048
____

(39)

____
_L_ J
____

( _T_ ) = link:#_bookmark12[_L_ T] ( _T_ ) si _T_ x = 0

____
( _T_ x ) · RLP ( _L_ T ( _T_ )) autrement

où B est la fonction de référence de bit telle que B j ( *x* ) est égal à le bit d'index _j_ (indexé à partir de 0) dans le tableau d'octets *x* . Notamment, ce traite *X* comme big-endian (Suite important morceaux

sera avoir plus petite indices).

[#_bookmark27 .anchor]####avec _L_ ^∗^ ~T~ et _L_ ^∗^ ~H~ être _ élément en t séquence transformations , Donc:

_F_ ∗[#_bookmark28 .anchor]#### ( _x_ 0 _, x1 ,_ _ _..._ ) ≡ _F_ ( _x_ 0 ) _, F_ ( _x_ 1 ) _, ..._ pour quelconque une fonction _F_

3 11 morceaux = 2 ^204 8^ , et la l o w-commande 11 morceaux est la moi dulo _ 2048 de la opérande , _ qui _ _ _ est dans cette Cas est " chacun _ _ _ de la première Trois paires d' octets dans un Keccak-256 hacher de la octet séquence."

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 7

Le composant les types sont défini Donc:

{empty}(41) link:\l[_H_] link:#_bookmark13[p] ∈ B 32 ∧ _H_ o ∈ B 32 ∧ _H_ c ∈ B 20 ∧ link:#_bookmark23[_Hr_ _] ∈ B 32 ∧ _H_ t ∈ B 32 ∧ link:#_bookmark24[_H_ e] ∈ B 32 ∧ link:#_bookmark25[_H_ ~b~] ∈ B ~256~ ∧ _Hd_ ~_~ ∈ N ∧ link:#_bookmark30[_Salut_ ~_~] ∈ N ∧ link:#_bookmark29[_H_ ~l~] ∈ N ∧ _H_ ~g~ ∈ N ∧ link:#_bookmark32[_H_ ~s~] ∈ N ~256~ ∧ link:#_bookmark15[_H_ x] ∈ B ∧ _H_ m ∈ B 32 ∧ link:#_bookmark17[_H_ n] ∈ B 8

où

{empty}(42) B n = \{ _B_ : _B_ ∈ B ∧ ll _B_ ll = _n_ }

Nous disposons désormais d'un cahier des charges rigoureux pour la construc- tion d'une structure de bloc formelle. La fonction RLP RLP (voir annexe link:#Appendix_B._Recursive_Length_Prefix[B)] fournit la méthode canonique de trans- formant cette structure en une séquence d'octets prêts pour transmission terminé la câble ou alors stockage localement.

link:#_bookmark77[[2016a].] Dans la version _Byzance_ , avec EIP-649, la glace l'âge a été retardé en créant un faux numéro de bloc, _H_ ~i~ , qui est obtenu en soustrayant trois millions de la valeur réelle numéro de bloc, ce qui en d'autres termes a réduit _E_ et le différence de temps entre les blocs, afin de permettre plus temps pour développer preuve de participation et empêcher la réseau de « geler ». Par la suite, EIP-1234 par link:#_bookmark94[Schoedon] link:#_bookmark94[[2018],] EIP-2384 par link:#_bookmark83[Conner [2019],] EIP-3554 par link:#_bookmark102[Hancock] link:#_bookmark102[[2021],] et EIP-4345 par link:#_bookmark71[Beiko et Al. [2021a]] a augmenté la [#_bookmark29 .anchor]####soustraire _κ_ .

La limite canonique des gaz _H_ ~l~ d'un bloc d'en-tête _H_ doit remplir la relation:
____

[arabic, start=2]
. _Bloc Entête Validité._ On définit _P_ ( _B_ H parent bloc de _B_ , officiellement:

) pour être la

____
(53)

_H_ ~l~ _< P_ ( _H_ ) ~H~ l

+ _P_ ( _H_ ) H l
____

1024

[#_bookmark30 .anchor]## +++_P_ ( _H_ )+++

____
Le bloc Numéro est la parents bloc Numéro augmenter- menté par une:

(44 ) _Salut_ [#_bookmark31 .anchor]####≡ _P_ ( _H_ ) Salut _ + 1

Le canonique difficulté de un bloc de entête _H_ est défini comme _D_ ( _H_ ):

(45)

_H_ ~l~ ;;: 5000

[#_bookmark32 .anchor]##_H_ s est la horodatage (dans d'Unix temps()) de bloc _H_ et doit remplir la relation:

_D_ ( _H_ ) ≡

où:

maximum _ré_
____

min

_, P_ ( _H_ ) H d

____
+ _X_ × _ς_ 2

+ _E_ autrement

{empty}(54) _H_ s _> P_ ( _H_ ) H s

(46)

(47)

(48)

_D_ min ≡ 2 17

_x P_ ( _H_ ) H d 2048

_ς_ 2 ≡ maximum ( _y_ −

+++_H_ s − _P_ ( _H_ ) H+++ s
____

_,_ − 99

____
Ce mécanisme impose une homéostasie en termes de temps entre blocs; un plus petite période entre la dernière deux blocs entraîne une augmentation du niveau de difficulté et donc Additionnel calcul obligatoire, rallongement la probable suivant période. Inversement, si la période est aussi grande, la

(49)

(50)

(51)

_y_ 1 si ll _P_ ( _H_ ) *~U~* ll = 0

2 autrement

_E_ ≡ 2 l _H_ i _t_ ÷ 100000 J − 2

_Salut_ ~_~ ≡ max( _H_ ~je~ − _κ,_ 0)

difficulté, et [#_bookmark33 .anchor]####attendu temps pour la suivant bloc, est réduit.

Le non fois, link:#_bookmark17[_H_ n] , doit satisfaire la rapports:

2 256

5000000

9000000

9700000

  10700000 si _Salut_ _

;;: _F_
____

FlècheGlacier

____
∧m ___ = _H_ m

[#_bookmark34 .anchor]####n _,_ *d* ).

ock's header _H_ , mais _sans_ le nonce et mélange-hachage Composants, *ré* être la courant GAD, un grande Les données Positionner avait besoin pour calculer la mélange-hachage, et PoW

Le _Propriété_ difficulté paramètre, _ς_ 2 , est utilisé pour affecter

un dynamique homéostasie de temps entre blocs, comme la temps entre les blocs varie, comme indiqué ci-dessous, tel que mis en œuvre dans EIP-2 par link:#_bookmark76[Butérine] link:#_bookmark76[[2015].] Dans la Propriété Libération, le symbole de difficulté exponentielle, _E_ provoque la difficulté à augmenter lentement (tous les 100 000 blocs) à un rythme exponentiel taux, et augmentant ainsi la différence de temps de bloc, et mettre une pression de temps sur la transition vers la preuve de participation. Cet effet, connu sous le nom de "bombe de difficulté", ou "ère glaciaire", a été expliqué dans EIP-649 par link:#_bookmark95[Schoedon et Butérine [2017]]

et retardé et mis en œuvre plus tôt dans EIP-2. _ς_ 2 était aussi modifié dans EIP-100 avec l'utilisation de _x_ , l'ajustement facteur ci-dessus, et le dénominateur 9, afin de cibler la moyenne bloc temps y compris oncle blocs par link:#_bookmark77[Butérine]

est la preuve de travail une fonction (voir section link:#11.5._Mining_Proof-of-Work[11.5):] cette évaluer-

ates à un tableau avec le premier élément étant le mix-hash, à prouver que un Corriger DAG possède a été utilisé, et la seconde Objet être un pseudo-aléatoire Numéro cryptographiquement dépendant de _H_ et *d* . Étant donné un approximativement uniforme Distribution dans le plage [0 _,_ 2 ^64^ ), la temps prévu pour trouver un Solution est proportionnel pour la difficulté, _Hd_ . ~_~

C'est le fondement de la sécurité de la blockchain et est la raison fondamentale pour laquelle un nœud malveillant peut- ne pas propager les blocs nouvellement créés qui, autrement, écraser ("réécrire") l'historique. Parce que le nonce doit s'asseoir satisfait à cette exigence, et parce que sa satisfaction dépend sur le contenu du bloc et à son tour sa composition transactions, créer Nouveau, valide, blocs est difficile et,

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 8

terminé temps, a besoin environ la total calculer Puissance [#_bookmark35 .anchor]####de la fiable portion de la exploitation minière pairs.

Ainsi nous sont capable pour définir la bloc entête validité une fonction _V_ ( _H_ ):

256
____

[arabic, start=56]
. _V_ ( _H_ ) ≡ _n H_ ∧ _m_ = _H_ m ∧

____
_Hd_ ~_~ = _ré_ ( _H_ ) ∧

_H_ ~g~ ≤ _H_ ~l~ ∧
____

[arabic, start=6]
. Transaction Exécution

____
L'exécution d'une transaction est la partie la plus complexe du protocole Ethereum : il définit la transition d'état fonction link:#_bookmark0[Υ.] Il est supposé que toutes les transactions exécutées première passer la initial essais de intrinsèque validité. Celles-ci inclure:
____

[arabic]
. La transaction est bien formé RLP, avec pas d'addi- national traînant octets ;
. la transaction Signature est valide;

____
_H_ ~l~ _< P_ ( _H_ ) ~H~ l

+ _P_ ( _H_ ) H l

1024

_P_ ( _H_ ) H l
____

[arabic, start=3]
. {blank}
+
____
la link:#_bookmark40[transaction nonce] est valide (équivalent pour la link:#_bookmark3[expéditeur comptes courant nonce);]
____
. {blank}
+
____
la expéditeur Compte possède non Contrat code déployé
____

____
_H_ ~l~ ;;: 5000 ∧

_H_ s _> P_ ( _H_ ) H s ∧

_Salut_ _ = _P_ ( _H_ ) Salut _ + 1 ∧

ll _H_ x ll ≤ 32

où ( _n, m_ ) = PoW ( _H_ n _, H_ n _,_ *ré* )

Notant aditionellement que *extraData* doit être à plus 32 octets.

{empty}5. Gaz et paiement

Afin d'éviter les problèmes d'abus de réseau et d'éviter les inévitables questions issues de Turing complètent- ness, tous les calculs programmables dans Ethereum sont soumis pour frais. Le frais programme est spécifié dans unités de _gaz_ (voir Ap- appendice link:#Appendix_G._Fee_Schedule[g] pour la frais associé avec divers calcul). Ainsi tout fragment donné de calcul programmable (cette comprend créer contrats, fabrication message appels, utiliser et accéder au stockage du compte et exécuter des op- rations sur la machine virtuelle) a un consensus universel Coût dans termes de gaz.

Chaque transaction a une quantité spécifique de gaz associée é avec ce: *GasLimit* . Cette est la montant de gaz qui est implicitement acheté à partir du solde du compte de l'expéditeur. L'achat a lieu au prix du *gaz correspondant* , aussi spécifié dans la transaction. Le transaction est consi- ered invalide si la Compte solde ne peux pas Support tel un achat. Ce est nommé *GasLimit* puisque quelconque inutilisé gaz à la finir de la transaction est remboursé (à la même taux d'achat) sur le compte de l'expéditeur. Le gaz ne existent en dehors de l'exécution d'une transaction. Ainsi pour comptes avec de confiance code associé, un relativement haute gaz limite mai être Positionner et la gauche seule.

En général, Ether achetait du gaz qui n'est pas recyclé. financé est livré à l' adresse du _bénéficiaire_ , l'adresse de un Compte typiquement en dessous de la contrôler de la mineur. Transacteurs sont libre pour spécifier quelconque *gazPrix* que elles ou ils souhaite, cependant les mineurs sont libres d'ignorer les transactions comme ils choisissent. Un prix du gaz plus élevé sur une transaction avant Coût la expéditeur Suite dans termes de Éther et livrer une plus grande valeur pour le mineur et sera donc plus susceptible d'être sélectionné pour être inclus par plus de mineurs. Les mineurs, en général, choisira d'annoncer le prix minimum du gaz pour lequel ils exécuteront des transactions et les commerçants seront libres de sonder ces prix pour déterminer le prix du gaz à offre. Puisqu'il y aura une distribution (pondérée) de min- prix du gaz acceptables, les opérateurs devront nécessairement ont un compromis à faire entre la baisse du prix du gaz et maximiser les chances que leur transaction soit miné dans un opportun manière.
____

[arabic, start=5]
. la gaz limite est non plus petite que la intrinsèque gaz,

____
_g_ 0 , utilisé par la transaction; et
____

[arabic, start=6]
. {blank}
+
____
la expéditeur Compte solde contient à moins la Coût, _v_ 0 , obligatoire dans à l'avant Paiement.
____

____
Officiellement, nous considérer la une fonction link:#_bookmark0[Υ,] avec _J_ être un transaction et *_σ_* la Etat:

(57 *_)_* = Υ( _*σ* , J_ )

Ainsi *_σ_* est l'état post-transactionnel. Nous définissons également link:#_bookmark42[Υg ^_^] pour évaluer pour la montant de gaz utilisé dans la exécution d'une transaction, link:#_bookmark42[Υ *^l^*] à évaluer par rapport aux charges à payer de la transaction éléments de log et link:#_bookmark42[Υ ^z^] pour évaluer le code d'état résultant depuis la transaction. Celles-ci sera être officiellement défini plus tard.
____

[arabic]
. [#6.1._Substate .anchor]##*Sous-état.* Tout au long de l'exécution de la transaction, nous assurons Crue certaines informations qui sont traitées immédiatement suite à l'opération. Nous appelons cela la _transaction accumulée. sous-état de tion_ , ou sous- _état accumulé_ en abrégé, et représentent ce comme _Un_ , qui est un tuple :

____
{empty}(58) _Un_ ≡ ( _Un_ *~s~* _,_ *~Al~* _, _ A_ *~t~* _, A_ ~r~ _, Un_ *~un~* _,_ *~AK~* ) ___

Le contenu du tuple inclut _A_ *s* , l'ensemble d'autodestruction : un ensemble de comptes qui seront éliminés suite à la trans- l'achèvement de l'action. [#_bookmark38 .anchor]##_A_ *~l~* est la série log : il s'agit d'une série de archivé et indexable 'points de contrôle' dans VM code exécution qui permettent aux appels contractuels d'être facilement suivis par onlook- ers externes au monde Ethereum (tels que décentralisés frontaux d'application). _A_ *t* est l'ensemble des comptes touchés, de qui la vider ceux sont supprimé à la finir de un transac- tion. [#_bookmark37 .anchor]##_Un_ r est le solde du remboursement, augmenté grâce à l'utilisation la

link:#_bookmark145[STORE] instruction dans Commande pour réinitialiser Contrat stockage pour

zéro à partir d'une valeur non nulle. Bien que pas immédiatement remboursé, ce est autorisé pour partiellement décalage la total exécution frais. Enfin, EIP-2929 par link:#_bookmark81[Buterin et Swende [2020a]] introduit [#_bookmark39 .anchor]##_A_ *a* , l'ensemble des adresses de compte consultées, et _A_ *~K~* , l'ensemble des clés de stockage accédées (plus précisément, chaque élément *~de~* _AK_ est un tuple d'une adresse de compte de 20 octets et un 32 octets stockage insérer).

Nous définissons le sous-état accumulé vide _A_ ^0^ ne pas avoir s'autodétruit, non journaux, non touché comptes, zéro rembourser bal-

ance, tous les contrats précompilés dans les adresses consultées, et non accédé stockage:

{empty}(59) _Un_ ^0^ ≡ ( ∅ _,_ () _,_ ∅ _,_ 0 _, π,_ ∅ )

où _link:#_bookmark51[π]_ est la Positionner de tout précompilé adresses.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 9
____

[arabic, start=2]
. *Exécution.* Nous définissons le gaz intrinsèque _g_ 0 , la quantité de gaz que cette transaction nécessite d'être payé avant l'exécution, comme suit :

____
accumulé sous-état _UN_ et statut code _z_ : (66)

 ** link:#_bookmark44[Λ] 4 ( *_σ_* 0 _, A_ ^∗^ _, S_ ( _T_ ) _, S_ ( _T_ ) _, g ,_

_g_ 0 ≡

f link:#_bookmark136[_G_ txdatazero] si _je_ = 0

link:#_bookmark47[Θ] 4 ( *_σ_* 0 _, UN , S_ ( _T_ ) _, S_ ( _T_ ) _, T_ t _,_

 _T_ ~t~ _, g , T_ ~p~ _, Télé ,_ ~_~ _Télé ,_ ~_~ _T_ *~d~* _,_ 0 _,_ T ) autrement

_je_ ∈ _T_ *je* _,T_ *ré*

link:#_bookmark137[_G_ txdatanonzero] autrement

où

+ link:#_bookmark135[_G_ txcreate] si _T_ t = ∅

0 sinon

(67)

(68)

_Un_ ^∗^ ≡ _Un_ ^0^ à l'exception

_Un_ ^∗^ *~un~* ≡ _Un_ ^0^ ∪ \{ _S_ ( _T_ ) } ∪ ~_E_ ∈ _T_~

\{ link:#_bookmark9[_E_] une }

+ link:#_bookmark138[transaction__ G__]

_TA_ *_* − 1

(69)
____

*un*

____
_A_ ^∗^ *~K~* ≡ L

*UN*

\{ ∀ _je <_ ll _E_ ll _,_ *_* _je_ ∈ N : ( _E_ a _, E_ *s* [ _je_ ]) }

+
____

_j_ =0

____
Adresse de la liste d'accès _G_ + ll _T_ *A* [ _j_ ] *s* ll _G_ accessliststorage

_E_ ∈ _TA_ *_*

et _g_ est la montant de gaz restant après déduire

où _T_ *~je~* _, T_ *~d~* signifie la série d'octets de la transaction associé Les données et initialisation code EVM, en fonction, dépendemment sur qu'il s'agisse la transaction est pour création de contrat ou alors message-

appel. _G_ txcreate est ajoutée si la transaction est Contrat- création, mais pas si un résultat de code EVM. link:#_bookmark132[~Adresse de la liste d'accès~ _G_] et link:#_bookmark133[_G_ ~accessliststorage~] sont les frais d'échauffement et stockage accéder, respectivement. _g_ est pleinement défini dans Ap-

appendice link:#Appendix_G._Fee_Schedule[G.]

Le à l'avant Coût _v_ 0 est calculé comme:

{empty}(61) _contre_ 0 ≡ link:#_bookmark6[_T_ g] link:#_bookmark5[_T_ p] + link:#_bookmark7[_Télévision_ _]

Le validité est déterminé comme:

la basique montant obligatoire pour Payer pour la existence de la transaction:
____

[arabic, start=70]
. _g_ ≡ _T_ g − _g_ 0

____
Notez que nous utilisons link:#_bookmark47[Θ] 4 et link:#_bookmark44[Λ] 4 pour indiquer le fait que seul le les quatre premières composantes des valeurs des fonctions sont prises ; la finale représente la valeur de sortie de l'appel de message (un octet déployer) et est inutilisé dans la le contexte de transaction évaluer-

tion.

Après le traitement de l'appel de message ou de la création du contrat, le compteur de remboursement doit être incrémenté pour les comptes que ont été auto-détruit tout au long de son invocation.
____

[arabic, start=71]
. _Un_ r ≡ _Un_ r + _R_ autodestruction

____
_je_ ∈ _A_ *s*

{empty}(62) _S_ ( _T_ ) = ∅

[#_bookmark40 .anchor]## ∧

Puis la Etat est finalisé par déterminer la montant

_T_ n = *_σ_* [ _S_ ( _T_ )] n ∧

_g_ 0 _T_ g ∧

_v_ ~0~ *_σ_* [ _S_ ( _T_ )] ~b~ ∧

allocation depuis la rembourser compteur, pour la expéditeur à la original taux.

_T_ ~g~ _B_ ~H l~ − link:#_bookmark2[_.€_] ( _B_ *~R~* ) ~u~

Noter la final état; la somme de la transactions gaz
____

[arabic, start=72]
. _ +
g_ ^∗^ ≡ _g_

____
+ min
____

_T_ g − _g_

_, Un_ ~r~

____
limite, _T_ g , et la gaz utilisé dans cette bloc avant, donné par

link:#_bookmark2[_.€_] ( _B_ *~R~* ) ~u~ , je dois être _ non plus grand que la bl o c k's *GasLimi t* , _B_ ~Hl~ . Aussi, avec un léger abuser de de notation, nous présumer que *_σ_* [ _S_ ( _T_ )] ~c~ = KEC () , *_σ_* [ _S_ ( _T_ )] ~n~ = 0, et *_σ_* [ _S_ ( _T_ )] ~b~ = 0 si *_σ_* [ _S_ ( _T_ )] = ∅ .

Le exécution de un valide transaction commence avec un changement irrévocable apporté à l'état : le link:#_bookmark3[nonce de la] link:#_bookmark3[compte de l'expéditeur,] _S_ ( _T_ ), est incrémenté de un et le solde est réduit par partie de la à l'avant Coût, _T_ g _T_ p . Le

Le total remboursable montant est la légitimement rester-

gaz _g_ , ajoutée à link:#_bookmark37[_A_ r] , cette dernière composante étant plafonné à un maximum de la moitié (arrondi à l'inférieur) du quantité totale utilisée _T_ g − _g_ . Donc, _g_ ^∗^ est le gaz total que restes après la transaction possède a été réalisé.

Le Éther pour la gaz est donné pour la mineur, à qui adresse est spécifié comme la Bénéficiaire de la cadeau bloc

_B._ _ Alors nous définir la pré-finale Etat *_σ_* ^∗^ dans termes de la

provisoire Etat *_σ_* P :

gaz disponible pour la procéder calcul, _g_ , est défini

comme _T_ g − _g_ 0 . Le calcul, qu'il s'agisse Contrat création
____

[arabic, start=73]
. {blank}

____
*_σ_* ∗ ≡ *_σ_* P à l'exception

ou un appel de message, aboutit à un état éventuel (qui peut juridiquement équivalent à l'état actuel), le passage à qui est déterministe et jamais invalide : il ne peut y avoir invalide transactions depuis cette indiquer.
____

[arabic, start=74]
. {blank}
. {blank}
. {blank}

____
*_σ_* ^∗^ [ _S_ ( _T_ )] ~b~ ≡ *_σ_* ~P~ [ _S_ ( _T_ )] ~b~ + _g_ ^∗^ _T_ ~p~

*_σ_* ^∗^ [ _m_ ] ~b~ ≡ *_σ_* ~P~ [ _m_ ] ~b~ + ( _T_ ~g~ − _g_ ^∗^ ) _T_ ~p~ _m_ ≡ _BHC_ ~_~

Nous définir la point de contrôle Etat *_σ_* 0 :
____

Le final Etat, *_σ_* , est atteint après suppression tout comptes

[#_bookmark41 .anchor]####que Soit apparaître dans la auto-destruction Positionner ou alors sont touché

____
(63)

(64)

*_σ_* 0 ≡ *_σ_* à l'exception:

*_σ_* ~0~ [ _S_ ( _T_ )] ~b~ ≡ *_σ_* [ _S_ ( _T_ )] ~b~ − _T_ ~g~ _T_ ~p~

et vider:
____

[arabic, start=77]
. {blank}

____
*_σ_* ≡ *_σ_* ^∗^ à l'exception

(65)

*_σ_* 0 [ _S_ ( _T_ )] n ≡ *_σ_* [ _S_ ( _T_ )] n + 1
____

[arabic, start=78]
. {blank}

____
∀ _je_ ∈ _Un_ *s* : *_σ_* [ _je_ ] = ∅

Évaluation *_σ_* P

depuis *_σ_* 0

dépend sur la transaction taper;
____

[arabic, start=79]
. {blank}

____
∀ _je_ ∈ _Un_ *t* : *_σ_* [ _je_ ] = ∅ si MORT ( *_σ_* ∗ _, je_ )

Soit Contrat création ou alors message appel; nous définir la tuple de post-exécution provisoire Etat *_σ_* P , restant gaz _g_ ,

[#_bookmark42 .anchor]####Et finalement, nous spécifier Υ ^g^ , la total gaz utilisé dans cette transaction Υ *^l^* , la journaux créé par cette transaction et

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 10

Υ ^z^ , la statut code de cette transaction:

(90)

*_σ_* ^∗^ [ _une_ ] = 1 _, v_ + _v ,_ link:#_bookmark118[TRIE] ( ∅ ) _,_ KEC ()
____

[arabic, start=80]
. {blank}
. {blank}

____
Υ g ( _*σ* , J_ ) ≡ _T_ g − _g_ ∗

Υ *^l^* ( _*σ* , J_ ) ≡ link:#_bookmark38[_A_ *~l~*]

(91)

*_σ_* ^∗^ [ _s_ ] =

∅ si *_σ_* [ _s_ ] = ∅ ∧ _v_ = 0

*un* ^∗^ autrement
____

[arabic, start=82]
. {blank}

____
Υ ^z^ ( _*σ* , J_ ) ≡ _z_

(92)

*un* ^∗^ ≡ ( *_σ_* [ _s_ ] ~n~ _, *σ *_[ _s_ ] ~b~ − _v , *σ *_[ _s_ ] *~s~* _, *σ *_[ _s_ ] ~c~ )

Ceux-ci sont utilisés pour aider à définir le link:#_bookmark21[reçu de transaction] et sont aussi utilisé link:#_bookmark66[plus tard] pour Etat et nonce validation.
____

[arabic, start=6]
. {blank}
+
____
Contrat Création
____

____
Il existe un certain nombre de paramètres intrinsèques utilisés lorsque créer un compte: expéditeur ( _s_ ), agent d'origine link:#_bookmark46[^4^] ( _o_ ), gaz disponible ( _g_ ), prix du gaz ( _p_ ), dotation ( _v_ ) ensemble avec un arbitraire tableau d'octets de longueur, *je* , l'initialisation EVM code, la cadeau profondeur de la message-appel/contrat- pile de création ( _e_ ), le sel pour l'adresse du nouveau compte ( _ζ_ ) et enfin l' autorisation d'apporter des modifications au Etat ( _w_ ). Le sel _ζ_ pourrait être disparu ( _ζ_ = ∅ ); officiellement,

{empty}(83) _ζ_ ∈ B 32 ∪ B 0

où _v_ est la valeur préexistante du compte, dans le cas où ce a été précédemment dans existence:

{empty}(93) _v_ 0 si *_σ_* [ _une_ ] = ∅

*_σ_* [ _une_ ] ~b~ autrement

Enfin, le compte est initialisé par l'exécution du code EVM d'initialisation *i* en fonction de l'exécution modèle (voir section link:#9._Execution_Model[9).] L'exécution du code peut affecter plusieurs événements qui ne sont pas internes à l'état d'exécution : la le stockage du compte peut être modifié, d'autres comptes peuvent être créés et d'autres appels de messages peuvent être passés. En tant que tel, la fonction d'exécution de code link:#9.4._Execution_Overview[Ξ] s'évalue à un tuple du résultant Etat *_σ_* ^∗∗^ , disponible gaz restant _g_ ^∗∗^ , la concernant- sultant accumulé sous-état _Un_ ^∗∗^ et la corps code de la Compte *o* .

Si la création a été causé par link:#_bookmark150[CRÉER2] , alors _ζ_ ∅ .

[#_bookmark44 .anchor]####On définit formellement la fonction de création comme la fonction Λ, qui s'évalue à partir de ces valeurs, ainsi que Etat *_σ_* et la accumulé sous-état _Un_ , pour la tuple contenant le nouvel état, le gaz restant, le nouveau sous-état accumulé, le statut code et production ( _*σ* , g , UN , z,_ *o* ):

{empty}(84) ( _*σ* , g , UN , z,_ *o* ) ≡ Λ ( _*σ* , UN, s, o, g, p, v,_ *je* _, e, , _ w_ )

L'adresse du nouveau compte est définie comme étant le le plus à droite 160 morceaux de la Keccak-256 hacher de la link:#_bookmark113[RLP] encodage de la structure ne contenant que l'expéditeur et le link:#_bookmark3[compte nonce.] Pour link:#_bookmark150[CREATE2] la règle est différente et est décrit dans EIP-1014 par link:#_bookmark82[Buterin] link:#_bookmark82[[2018].] Combiner les deux cas, nous définissons l'adresse résultante pour le nouveau Compte _un_ :

{empty}(94) ( *_σ_* ^∗∗^ _, g_ ^∗∗^ _, A_ ^∗∗^ _,_ *o* ) ≡ Ξ( *_σ_* ^∗^ _, g, A_ ^∗^ _, je_ )

où _je_ contient la paramètres de la link:#9.3._Execution_Environment[exécution environ-] link:#9.3._Execution_Environment[hommes] , que est:

{empty}(85) _un_ [#_bookmark45 .anchor]####≡ ADR ( _s, *σ *_[ _s_ ] n − 1 _, , __ *je* )

{empty}(86) ADR ( _s, n, , __ *je* ) ≡ B 96 _.._ 255 KEC _LA_ ( _s_ , _n, , __ *je* )

_je_ *~d~* évalue au tuple vide car il n'y a pas de données d'entrée pour cette appel. _Je_ H possède non spécial traitement et est déterminé

(87)

_LA_ ( _s_ , _n, ζ,_ *je* ) ≡

RLP ( _s, n_ ) si _ζ_ = ∅

{empty}(255) · _s_ · _ζ_ · KEC ( *i* ) autrement

depuis la chaîne de blocs.

Code exécution épuise gaz, et gaz mai ne pas aller au dessous de zéro, Donc exécution mai sortie avant que la code possède viens

où · est la concaténation de tableaux d'octets, B _~a..b~_ ( _X_ ) évaluant correspond à une valeur binaire contenant les bits d'indices dans le Portée [ _un, b_ ] de la binaire Les données _X_ , et *_σ_* [ _x_ ] est la adresse Etat de _X_ , ou alors ∅ si rien existe. Noter nous utiliser une moins de que

la valeur nonce de l'expéditeur ; nous affirmons que nous avons augmenté mentionné le nonce du compte de l'expéditeur avant cet appel, et donc la valeur utilisée est le nonce de l'expéditeur au début de la responsable transaction ou alors VM opération.

L'adresse du nouveau compte est ajoutée à l'ensemble des accédé comptes:
____

[arabic, start=88]
. _Un_ ^∗^ ≡ _UN_ à l'exception _Un_ ^∗^ *~un~* ≡ _Un_ *~un~* ∪ \{ _un_ }

____
Le nonce du compte est initialement défini comme un, le bal- ance comme la valeur passé, la stockage comme vider et la hachage de code en tant que hachage Keccak 256 bits de la chaîne vide ; le solde de l'expéditeur est également réduit de la valeur transmise. Ainsi la muté Etat devient *_σ_* ^∗^ :
____

[arabic, start=89]
. *_σ_* ^∗^ ≡ *_σ_* à l'exception:

____
à un état d'arrêt naturel. Dans cette (et plusieurs autres) ex- cas exceptionnels, nous disons qu'une exception de manque de gaz (OOG) a s'est produit: Le évalué Etat est défini comme être la vider Positionner, ∅ , et la entier créer opération devrait avoir non effet sur l'état, le laissant effectivement tel qu'il était immédiatement avant pour tenter la création.

Si le code d'initialisation se termine avec succès, un dernier création de contrat Coût est payé, la dépôt de code Coût, _c_ , proportionnel pour la Taille de la créé contrat de code:

{empty}(104) _c_ ≡ ~Dépôt de code~ _G_ × tout *va* bien

Si là est ne pas suffisant gaz restant pour Payer cette, c'est à dire

_g_ ^∗∗^ _< c_ , alors nous aussi déclarer un panne d'essence exception.

Le gaz restant sera nul dans de tels cas exceptionnels. condition, c'est-à-dire si la création a été conduite comme la réception tion d'une transaction, cela n'affecte pas le paiement de le coût intrinsèque de la création de contrats ; il est payé quoi qu'il en soit. Toutefois, la valeur de la transaction n'est pas transférée à la avorté contrat de adresse lorsque nous sont panne d'essence.

4 [#_bookmark46 .anchor]####qui pouvez différer depuis la expéditeur dans la Cas de un message appel ou alors Contrat création ne pas directement déclenché par un transaction mais à venir depuis la exécution de Code EVM

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 11

Si tel un exception Est-ce que ne pas se produire, alors la restant le gaz est remboursé à l'initiateur et à l'état maintenant modifié est autorisé à persister. Ainsi formellement, on peut préciser résultant Etat, gaz, accumulé sous-état et statut code comme ( _*σ* , g , UN , z_ ) où:

(105)

_g_ 0 si _F_

_g_ ^∗∗^ − _c_ autrement

(106)

*_σ_* si _F_ ∨ *_σ_* ^∗∗^ = ∅

**  *_σ_* sauf :

destinataire ( _r_ ), le compte dont le code doit être exécuté ( _c_ , généralement le même que le destinataire), gaz disponible ( _g_ ), valeur ( _v_ ) et le prix du gaz ( _p_ ) avec un octet de longueur arbitraire déployer, *ré* , la saisir Les données de la appel, la cadeau profondeur de la appel-message/création-contrat pile ( _e_ ) et finalement la autorisation pour Fabriquer modifications pour la Etat ( _w_ ).

De côté depuis évaluer pour un Nouveau Etat et accumulé transaction sous-état, message appels aussi avoir un En plus composant - les données de sortie désignées par le tableau d'octets *o* . Cette est ignoré lorsque exécution transactions, pourtant mes- sauge appels pouvez être initié exigible pour Code VM exécution et dans cette Cas cette information est utilisé.

(110)

( *_σ_* _, g_ _, UN_ _, z ,_ *o* ) ≡ [#_bookmark47 .anchor]####Θ ( _*σ* , UN, s, o, r , c, g , p, v , v_ ˜ _,_ *ré* _, e, w_ )

*_σ_* ≡

(107)

*_σ_* [ _un_ ] = ∅ si MORT ( *_σ_* ^∗∗^ _, un_ )

*_σ_* ^∗∗^ à l'exception:
____

  *_σ_* [ _une_ ] c = KEC ( *o* ) autrement

Noter que nous avoir besoin pour différencier entre la valeur que

____
est pour être transféré, _v_ , depuis la valeur apparent dans la exécution co n t e x t, _v_ ˜ , pour la DELEG A TECALL instruction. Nous définir *_σ_* 1 , la première de transition Etat comme la origine- finale Etat mais avec la valeur transféré depuis expéditeur pour

_A A_ ^∗^ si _F_ ∨ *_σ_* ^∗∗^ = ∅

_Un_ ^∗∗^ autrement

(108)

_z_ 0 si _F_ ∨ *_σ_* ^∗∗^ = ∅

1 autrement

où (109)

_F_ ≡ *_σ_* [ _une_ ] = ∅ ∧ *_σ_* [ _une_ ] _c_ = KEC () ∨ *_σ_* [ _une_ ] _n_ = 0 ∨

( *_σ_* ^∗∗^ = ∅ ∧ *o* = ∅ ) ∨

_g_ ^∗∗^ _< c_ ∨

destinataire:

{empty}(111) *_σ_* ~1~ [ _r_ ] ~b~ ≡ *_σ_* [ _r_ ] ~b~ + _v_ ∧ *_σ_* ~1~ [ _s_ ] ~b~ ≡ *_σ_* [ _s_ ] ~b~ − _v_

sauf si _s_ = _r_ .

Tout au long de la cadeau travail, ce est assumé que si *_σ_* 1 [ _r_ ] n'était pas défini à l'origine, il sera créé en tant que compte sans code ni état et solde nul et nonce. Ainsi la précédent équation devrait être pris pour moyenne:

{empty}(112) *_σ_* ~1~ ≡ *_σ_* ~1~ à l'exception:

ll *o* ll _>_ 24576

[#_bookmark48 .anchor]##(113) *_σ_* 1 [ _s_ ] ≡ f ∅

si *_σ_* ~1~ [ _s_ ] = ∅

∧ _v_ = 0

L'exception dans la détermination de *_σ_* dicte que *o* , la séquence d'octets résultante de l'exécution de la code d'initialisation, spécifie le code de corps final pour le nouvellement créé Compte.

Notez que l'intention est que le résultat soit soit une réussite nouveau contrat créé avec succès avec sa dotation, ou pas Nouveau Contrat avec non transférer de valeur. Dans une addition, ob-

servir que si l'exécution du code d'initialisation link:#_bookmark151[revient] ( *_σ_* ^∗∗^ = ∅ ∧ *o* = ∅ ), le gaz résultant _g_ n'est pas épuisé (à condition de là a été non autre exception), mais non Nouveau ac-

compter est créé.

7.1. *Subtilités.* Notez que tant que le code d'initialisation est en cours d'exécution, l'adresse nouvellement créée existe mais avec pas de code corporel intrinsèque link:#_bookmark49[^5^] . Ainsi tout message d'appel reçu pendant ce temps, aucun code ne sera exécuté. Si l'exécution de l'initialisation se termine par un SELFDESTRUCT instruction, la question est sans objet puisque le compte sera supprimé avant la fin de la transaction. Pour une normale ARRÊT code, ou si la code revenu est autrement vide, alors l'état se retrouve avec un compte zombie, et tout ce qui reste solde sera être fermé à clé dans la Compte pour toujours.
____

[arabic, start=6]
. {blank}
+
____
Message Appel
____

____
Dans le cas de l'exécution d'un appel de message, plusieurs paramètres eters sont obligatoire: expéditeur ( _s_ ), transaction auteur ( _o_ ),

*un* 1 autrement

{empty}(114) *à* ~1~ ≡ *_σ_* ~1~ [ _s_ ] ~n~ _, *σ*_ ~1~ [ _s_ ] ~b~ − _v , *σ*_ ~1~ [ _s_ ] *~s~* _, *σ*_ ~1~ [ _s_ ] ~c~

{empty}(115) et *_σ_* ~1~ ≡ *_σ_* à l'exception:

(116)

*_σ_* ~1~ [ _r_ ] ≡ (0 _, v ,_ TRIE ( ∅ ) _,_ CEC (())) si *_σ_* [ _r_ ] = ∅ ∧ _v_ = 0

*_σ_* ~1~ [ _r_ ] ≡ ∅ si *_σ_* [ _r_ ] = ∅ ∧ _v_ = 0

σ *___* ~1~ [ _r_ ] ≡ *un* ~1~ sinon

{empty}(117) *un* ~1~ ≡ ( *_σ_* [ _r_ ] ~n~ _, *σ *_[ _r_ ] ~b~ + _v , *σ *_[ _r_ ] *~s~* _, *σ *_[ _r_ ] ~c~ )

Le code associé au compte (identifié comme le fragment ment dont le hachage Keccak-256 est *_σ_* [ _c_ ] c ) est exécuté selon au modèle d'exécution (voir section link:#9._Execution_Model[9).] Tout comme avec con- tract création, si la exécution s'arrête dans un exceptionnel mode (c'est-à-dire en raison d'une alimentation en gaz épuisée, sous- flux, destination de saut invalide ou instruction invalide), puis aucun gaz n'est remboursé à l'appelant et l'état revient à la indiquer immédiatement avant pour solde transférer (c'est à dire *_σ_* ).

5 [#_bookmark49 .anchor]####Pendant initialisation code exécution, EXTCODETAILLE sur la adresse devrait retourner zéro, qui est la longueur de la code de la Compte pendant que

CODETAILLE devrait retourner la longueur de la initialisation code (comme défini dans link:#H.2._Instruction_Set[H.2).]

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 12

[#_bookmark50 .anchor]####où
____

[arabic, start=131]
. Ξ ≡

____
et

*_σ σ_* si *_σ_* ^∗∗^ = ∅

*_σ_* ^∗∗^ autrement

0 si *_σ_* ^∗∗^ = ∅ ∧
____

*o* = ∅

_g_ ^∗∗^ autrement

____
_UNE UNE_ si *_σ_* ^∗∗^ = ∅

_Un_ ^∗∗^ autrement

f 0 si *_σ_* ^∗∗^ = ∅

Ξ ECREC ( *_σ_* 1 _, g, A, je_ ) si _c_ = 1 Ξ SHA256 ( *_σ_* 1 _, g, A, je_ ) si _c_ = 2 Ξ RIP160 ( *_σ_* 1 _, g, A, je_ ) si _c_ = 3 Ξ ID ( *_σ_* 1 _, g, UN, je_ ) si _c_ = 4 Ξ EXPMOD ( *_σ_* 1 _, g, A, je_ ) si _c_ = 5 ΞBN _ AJOUTER ( *_σ_* 1 _, g, A, je_ ) si _c_ = 6 ΞBN _ MUL ( *_σ_* 1 _, g, A, je_ ) si _c_ = 7 Ξ SNARKV ( *_σ_* 1 _, g, A, je_ ) si _c_ = 8 Ξ BLAKE2 F ( *_σ_* 1 _, g, UN, je_ ) si _c_ = 9

Ξ( *_σ_* 1 _, g, UN, je_ ) sinon

modèle formel d'une machine à états virtuelle, connu comme le Machine virtuelle Ethereum (EVM). C'est un _quasi-_ Turing- machine complète ; la _quasi -_ qualification vient de la fait que le calcul est intrinsèquement borné par un paramètre, _gas_ , qui limite la quantité totale de tation Fini.
____

[arabic]
. *Bases.* L'EVM est une architecture simple basée sur la pile ture. La taille du mot de la machine (et donc la taille de la pile éléments) est de 256 bits. Cela a été choisi pour faciliter le Keccak- 256 schéma de hachage et calculs de courbes elliptiques. Le Le modèle de mémoire est un simple tableau d'octets adressé par mot. Le pile a une taille maximale de 1024. La machine a également un indépendant stockage maquette; cette est similaire dans concept à la mémoire mais plutôt qu'un tableau d'octets, c'est un mot- tableau de mots adressable. Contrairement à la mémoire, qui est volatile, le stockage est non volatil et est maintenu dans le cadre du système Etat. Tout Emplacements dans tous les deux stockage et Mémoire sont bien défini initialement comme zéro.

____
La machine ne suit pas la norme von Neu- homme architecture. Plutôt que stocker programme code dans généralement accessible Mémoire ou alors stockage, ce est stockée séparément dans un virtuel ROM interactif seul par un spécialisé instruction.

La machine peut avoir une exécution exceptionnelle pendant plusieurs raisons, y compris les débordements de pile et les instructions non valides tions. Comme l'exception de panne de gaz, ils ne partent pas changements d'état intacts. Au contraire, la machine s'arrête immédiatement. rapidement et signale le problème à l'agent d'exécution (soit la transaction processeur ou alors, récursivement, la frai exécution environnement) qui sera accord avec ce séparément.
____

[arabic, start=2]
. *Frais Aperçu.* Frais (dénomination dans gaz) sont inculpé dans trois circonstances distinctes, toutes trois comme préalable à l'exécution d'une opération. La première et le plus courant est la redevance intrinsèque au calcul de l'opération (voir annexe link:#Appendix_G._Fee_Schedule[G).] Deuxièmement, le gaz peut être déduit dans Commande pour formulaire la Paiement pour un subalterne

[arabic, start=132]
. KEC ( _I_ *~b~* ) = *_σ_* [ _c_ ] ~c~

____
Ce est assumé que la client sera avoir stockée la paire ( KEC ( _je_ *~b~* ) _, je_ *~b~* ) à quelques indiquer avant dans Commande pour Fabriquer la détermination de _je_ *~b~* réalisable.

Comme pouvez être vu, là sont neuf exceptions pour la usage du cadre général d'exécution Ξ pour l'évaluation des appel de messages : ce sont des contrats dits 'précompilés', conçu comme une pièce préliminaire de l'architecture qui peut plus tard deviennent _des extensions natives_ . Les contrats aux adresses 1 à 9 exécuter la fonction de récupération de clé publique à courbe elliptique, le schéma de hachage SHA2 256 bits, le hachage RIPEMD 160 bits schéma, la fonction d'identité, précision arbitraire modulaire exponentiation, addition de courbe elliptique, scalaire de courbe elliptique multiplication, un elliptique courbe jumelage Chèque, et la BLAKE2 fonction de compression F respectivement. Leur plein définition formelle est dans l'annexe link:#Appendix_E._Precompiled_Contracts[E.] [#_bookmark51 .anchor]####Nous désignons l'ensemble des la adresses de la précompilé contrats par _π_ :

(133 _)_ ≡ \{ 1 _,_ 2 _,_ 3 _,_ 4 _,_ 5 _,_ 6 _,_ 7 _,_ 8 _,_ 9 }
____

[arabic, start=6]
. {blank}
+
____
[#9._Execution_Model .anchor]####Exécution Modèle
____

____
Le modèle d'exécution spécifie comment l'état du système est modifié étant donné une série d'instructions de bytecode et un petit tuple de environnemental Les données. Cette est spécifié par un

appel de message ou création de contrat ; cela fait partie du Paiement pour CRÉER , CRÉER2 , APPEL et CODE D'APPEL . Pour terminer, gaz mai être payé exigible pour un augmenter dans la usage de la Mémoire.

Terminé un comptes exécution, la total frais pour Mémoire- usage payable est proportionnel pour le plus petit plusieurs de 32 octets que sont obligatoire tel que tout Mémoire indices (qu'il s'agisse pour lis ou alors écrivez) sont inclus dans la Portée. Cette est payé pour sur un juste à temps base; comme tel, référencement un région de Mémoire à moins 32 octets plus grand que quelconque pré- une mémoire correctement indexée se traduira certainement par une Mémoire usage frais. Exigible pour cette frais ce est très peu probable adresses sera déjà aller au dessus de 32 bits bornes. Que mentionné, implémentations doit être capable pour faire en sorte cette éventualité. Stockage frais avoir un légèrement nuancé comportement - à dans- centiviser minimisation de la utiliser de stockage (qui cor- répond directement pour un plus grande Etat base de données sur tout nœuds), la exécution frais pour un opération que efface un entrée dans la stockage est ne pas seul renoncé, un qualifié rembourser est donné; dans fait, cette rembourser est effectivement payé à l'avant puisque la initial usage de un stockage emplacement frais substantiellement Suite

que Ordinaire usage.

Voir annexe link:#Appendix_H._Virtual_Machine_Specificatio[H] pour un rigoureux définition de la EVM gaz Coût.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 13
____

[arabic]
. [#9.3._Execution_Environment .anchor]##*Environnement d'exécution.* En plus du système état tem *_σ_* , le gaz restant pour le calcul _g_ , et le sous- état accumulé _A_ , il existe plusieurs éléments importants informations utilisées dans l'environnement d'exécution que l'agent d'exécution doit fournir ; ceux-ci sont contenus dans le tuple _Je_ :
* _je_ un , la adresse de la Compte qui possède la code que est exécution.
* _je_ o , la expéditeur adresse de la transaction que origine- iné cette exécution.
* _je_ p , la le prix de gaz dans la transaction que d'origine- [#_bookmark54 .anchor]####noué cette exécution.
* _je_ , *~_~* la octet déployer que est la saisir Les données pour cette exécution; si la exécution agent est un transaction,

____
devrait arrêt.

{empty}(135) Ξ( _*σ* , g, UN, je_ ) ≡ ( _*σ* , *µg* ,_ _ _UN ,_ *o* )

{empty}(136) ( _*σ* , *µ* , UN , ...,_ *o* ) ≡ _X_ ( _*σ* , *µ* , UN, je_ )
____

[width="100%",cols="43%,37%,12%,8%",options="header",]
|===
a|
____
(137)
____

|*_µg_* _ a|
____
≡
____

|_g_
a|
____
(138)
____

|*_µpc_* _ a|
____
≡
____

|0
|===

____
[#_bookmark55 .anchor]####  ∅ _, *µ* , UN, je ,_ ∅ si _Z_ ( _*σ* , *µ* , UN, je_ )

cette voudrais être la transaction Les données.
____

* _je_ suis , la adresse de la Compte qui causé la

____
_X_ ( _*σ* , *µ* , UN, je_ )

≡ **  ∅ _, *µ*_ _, UN, je ,_ *o* si _w_ =

REVENIR

code pour être exécuter ; si la exécution agent est un transaction, cette voudrais être la transaction expéditeur.
____

* _je_ v , la valeur, dans Wei, passé pour cette Compte comme partie de la même procédure comme exécution; si la

____
l'agent d'exécution est une transaction, ce serait le transaction valeur.
____

* _je_ *~b~* , la octet déployer que est la machine code pour être

____
réalisé.
____

* _Je_ H , la bloc entête de la cadeau bloc.

____
où (144)

(145)

(146)

_O_ ( _*σ* , *µ* , UN, je_ ) *o* si *o* = ∅

 _X O_ ( _*σ* , *µ* , A, je_ ) autrement

*o* ≡ _H_ ( _*µ* , je_ )

( _un, b, c, ré_ ) · _e_ ≡ ( _un, b, c, ré, e_ )

*_µ_* ≡ *_µ_* à l'exception:
____

* _je_ e , la profondeur de la cadeau message-appel ou alors

____
création de contrat (c'est à dire la nombre de APPELS _ ou alors

CRÉER(2) s être réalisé à cadeau).

(147)
____

*_µg_* _

____
≡ *_µg_* _
____

* _ +
C_ ( _*σ* , *µ* , UN, je_ )
** _je_ w , la autorisation pour Fabriquer modifications pour la

____
Etat.

Le modèle d'exécution définit la fonction Ξ, qui peut calculer l'état résultant *_σ_* , le gaz restant _g_ , la sous- état accumulé résultant _A_ et la sortie résultante, *o* , compte tenu de ces définitions. Pour le contexte actuel, nous allons définir ce comme:

{empty}(134) ( _*σ* , g , UN ,_ *o* ) ≡ Ξ( _*σ* , g, UN, je_ )

où nous sera rappelles toi que _Un_ , la accumulé sous-état, est défini dans section link:#6.1._Substate[6.1.]
____

[arabic]
. [#9.4._Execution_Overview .anchor]##*Présentation de l'exécution.* Il faut maintenant définir le Ξ une fonction. Dans la plupart des implémentations pratiques, ce sera modelé comme un itératif progression de la paire comprenant l'état du système complet, *_σ_* et l'état de la machine, *_µ_* . Pour- mally, nous le définissons récursivement avec une fonction _X_ . Cette les usages un itérateur une fonction _O_ (qui définit la résultat de un

____
Noter que, lorsque nous évaluer Ξ, nous laissez tomber la Quatrième

élément _je_ et extrait la restant gaz *_µg_* _ depuis la résultant machine Etat *_µ_* .

_X_ est donc cyclé (récursivement ici, mais les implémentations sont généralement censés utiliser une simple boucle itérative) jusqu'à ce que soit _link:#_bookmark59[Z]_ devient vrai indiquant que l'état actuel est exceptionnel et que la machine doit être arrêtée et tout changements mis au rebut ou alors jusqu'à _link:#_bookmark60[H]_ devient un séries (plutôt que l'ensemble vide) indiquant que la machine a atteint un contrôlé arrêt.
____

[arabic]
. _Machine État._ Le machine Etat *_µ_* est défini comme la tuple ( _g, ordinateur personnel,_ *moi* _, je,_ *s* ) qui sont la gaz disponible, la

____
compteur de programme _pc_ ∈ N 256 , le contenu de la mémoire, la actif Numéro de mots dans Mémoire (compte en continu

à partir de la position 0), et le contenu de la pile. La mémoire Contenu *_µ_* sont un séries de des zéros de Taille 2 ^256^ .

Pour la facilité de en train de lire, la instruction mnémotechnique,

écrit en petites majuscules (par exemple ADD ), doit être interprété comme leur numérique équivalents ; la plein table de des instructions et leur détails est donné dans annexe link:#Appendix_H._Virtual_Machine_Specificatio[H]

Pour la fins de définir _Z_ , _H_ et _Ô_ , nous définir _w_

comme la courant opération pour être réalisé:

Célibataire cycle de la Etat machine) ensemble avec les fonctions

_link:#_bookmark59[Z]_ qui détermine si la cadeau Etat est un link:#_bookmark59[exceptionnel]

{empty}(148) _w_ ≡

f _je_ *~b~* [ *_µ_* p c
____

] si *_µpc_* _

____
_<_ ll _je_ *~b~* ll

link:#_bookmark59[arrêt] de la machine et link:#_bookmark60[_H_] , spécifiant la sortie données de l'instruction si et seulement si l'état actuel est un [#_bookmark58 .anchor]##link:#_bookmark60[Ordinaire s'arrêter] Etat de la machine.

La séquence vide, notée (), n'est pas égale à la ensemble vide, noté ∅ ; c'est important lors de l'interprétation la sortie de _H_ , qui s'évalue à ∅ lorsque l'exécution doit Continuez mais un séries (potentiellement vider) lorsque exécution

link:#_bookmark143[ARRÊTER] sinon

Nous supposons également les quantités fixes de _δ_ et _α_ , en spécifiant la pile éléments supprimé et ajoutée, tous les deux inscriptible sur l'instruction et une fonction de coût d'instruction _C_ évaluant uating pour la plein Coût, dans gaz, de exécution la donné instruction.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 14
____

[arabic, start=2]
. [#_bookmark59 .anchor]##_Exceptionnel Arrêt._ La fonction d'arrêt exceptionnelle tion _Z_ est défini comme:

____
(149)

_Z_ ( _*σ* , *µ* , UN, je_ ) ≡ _*µg* _ < C_ ( _*σ* , *µ* , UN, je_ ) ∨

[#_bookmark60 .anchor]####9.4.4. _Arrêt normal._ La fonction d'arrêt normale _H_ est défini :

(154)

  _H_ RETOUR ( *_µ_* ) _ si _w_ ∈ \{ link:#_bookmark149[RETOUR] _,_ REVE R T }

_δ w_ = ∅ ∨ ll **_µ_ ~s ~**ll _< δw __ ∨

( _w_ = SAUTER ∧ *_µs [_ 0* ] ∈ _/ D_ ( _je_ *~b~* )) ∨

_H_ ( _*µ* , je_ ) ≡

() si _w_ ∈ \{ link:#_bookmark143[ARRÊTER] _,_ link:#_bookmark152[AUTODESTRUCTION] }

 ∅ sinon

où

( _w_ = JUMPI ∧ *_µs [_ 1* ] = 0 ∧

*_µs [_ 0* ] ∈ _/ D_ ( _je_ *~b~* )) ∨

( _w_ = RETOURDATACOPIE ∧

*_µ_ s* [1] + *_µ_ s* [2] _>_ ll *_µ_ o* ll ) ∨ ll **_µ_ ~s ~**ll − _δ w_ + _α w >_ 1024 ∨ ( ¬ _je_ w ∧ _O_ ( _w, *µ *_)) ∨

( _w_ = STORE ∧ _*µg* __ Allocation d'appel _G_ )

Les opérations d'arrêt de retour de données, link:#_bookmark149[RETOURNER] et REVERT , ont une fonction spéciale _H_ RETURN . A noter également la différence entre la séquence vide et la séquence vide Positionner comme discuté link:#_bookmark58[ici.]
____

[arabic, start=2]
. *Le Exécution Cycle.* Les éléments de la pile sont ajoutés ou supprimé de la partie la plus à gauche et la plus basse de l'index séries; tout autre éléments rester inchangé:

____
{empty}(150) _O_ ( _w, *µ *_) ≡ _w_ ∈ \{ CRÉER _,_ CRÉER2 _,_ STORE _,_

AUTODESTRUCTION } ∨

LOG0 ≤ _w_ ∧ _w_ ≤ LOG4 ∨

_w_ = APPEL ∧ *_µs_ [* 2] = 0

(155)

(156)

(157)

(158)
____

_O_ ( _*σ* , *µ* , UN, Je_ ) ≡ ( _*σ* , *µ* , UN , je_ )

____
∆ ≡ _αw __ − _δw __

ll *_µ_ s* ll ≡ ll *_µ_ s* ll + ∆

∀ _x_ ∈ [ _α w ,_ ll *_µ_ s* ll ) : *_µs_* [ _x_ ] *_* ≡ *_µs_* [ _x_ *~_~* − ∆]

Celui-ci précise que l'exécution est dans un arrêt exceptionnel. l'état de fonctionnement s'il n'y a pas assez de gaz, si l'instruction est invalide (et donc son indice _δ_ est indéfini), s'il y a sont insuffisant pile éléments, si un SAUTER / SAUTER destination n'est pas valide, la nouvelle taille de la pile serait supérieure à 1024 ou Etat modification est tenté pendant un statique appel. Le comme-

Le gaz est réduit par la des instructions gaz Coût et pour la plupart des instructions, le compteur de programme s'incrémente sur chaque cycle, pour les trois exceptions, on suppose une fonction _J_ , indice par une de deux des instructions, qui évalue pour la selon valeur:

Tut lecteur sera prendre conscience de que cette implique que non instruction

peut, à travers son exécution, cause un exceptionnel arrêt. Aussi, la exécution est dans un exceptionnel s'arrêter Etat si la gaz

(159)

*_µ_* g ≡ *_µg_* _ − _C_ ( _*σ* , *µ* , UN, je_ )

   link:#_bookmark147[_J_ SAUT P] ( *_µ_* ) si _w_ = SAUTER

laissé avant l'exécution d'une instruction link:#_bookmark145[SSTORE] est inférieur à ou alors égal pour la appel traitement link:#_bookmark134[_G_ ~appelle l'allocation~] . Le dernière état a été introduit dans EIP-1706 par link:#_bookmark96[Forshtat et Weiss [2019]]

(160)

*_µ_* pc ≡

link:#_bookmark148[_J_ SAUTPI] ( *_µ_* ) si _w_ = JUMPI

  _N_ ( *_µ_* p c _, w_ ) sinon

(partie de EIP-2200 par link:#_bookmark105[Soie] [ link:#_bookmark105[2019]).]

Dans général, nous présumer la Mémoire, accumulé sous-état

et système Etat faire ne pas monnaie:
____

[arabic, start=3]
. _Validité de la destination de saut._ Nous utilisions auparavant _D_ comme fonction pour déterminer l'ensemble des destinations de saut valides. nations étant donné le code qui est exécuté. Nous définissons ceci comme quelconque position dans la code occupé par un JUMPDEST instruction.

____
(161)

(162)

(163)

(164)

*_µ_ m* ≡ **_µm_ _ _µ _**je ≡ *_µ_* je

_Un_ ≡ _UN_

*_σ_* ≡ *_σ_*

Tous ces postes doivent être sur instruction valide lié- bélier, plutôt que de rester assis dans la partie données de PUSH opérations et doit apparaître dans le cadre explicitement défini portion de la code (plutôt que dans la implicitement défini link:#_bookmark143[ARRÊT] opérations que Piste ce).

Officiellement:

{empty}(151) _ré_ ( *c* ) ≡ _ré_ J ( *c* _,_ 0) où:

(152)

\{} si _je_ ;;: ll *c* ll

_ré_ ( *c* _, je_ ) \{ _je_ } ∪ _DJ_ ( c _,_ *_* _N_ ( _je,_ *c* [ _je_ ]))

si *c* [ _je_ ] = JUMPDEST

_DJ_ ( c _,_ *_* _N_ ( _je,_ *c* [ _je_ ])) sinon

où _N_ est la suivant valide instruction position dans la code, saut la Les données de un POUSSER instruction, si quelconque: (153)

  _je_ + _w_ − PUSH1 + 2

Cependant, les instructions modifient généralement un ou plusieurs composantes de ces valeurs. Composants modifiés répertoriés par instruction sont c'est noté dans annexe link:#Appendix_H._Virtual_Machine_Specificatio[H,] aux côtés de valeurs pour _α_ et _δ_ et un officiel la description de la gaz conditions.
____

[arabic, start=6]
. {blank}
+
____
[#10._Blocktree_to_Blockchain .anchor]####Blocktree pour Chaîne de blocs
____

____
La blockchain canonique est un chemin de la racine à la feuille dans toute l'arborescence des blocs. Afin d'avoir un consensus terminé qui chemin ce est, conceptuellement nous identité la chemin qui a eu le plus de calculs effectués dessus, ou, le chemin _le plus lourd ._ De toute évidence, un facteur qui aide à déterminer la le plus lourd chemin est la bloc Numéro de la feuille, équivalent pour la Numéro de blocs, ne pas compte la non miné link:#_bookmark153[genèse] link:#_bookmark153[bloquer,] dans le chemin. Plus le chemin est long, plus la total de l'effort minier qui doit avoir été fait pour arriver à la feuille. Cela s'apparente aux régimes existants, tels que que employé dans Dérivé de Bitcoin protocoles.

Puisqu'un en-tête de bloc inclut la difficulté, l'en-tête seule est suffisant pour valider la calcul Fini. Quelconque

_N_ ( _je, w_ ) ≡

si _w_ [ APPUYER1 _,_ PUSH32 ]

  _je_ + 1 sinon

bloc contribue vers la total calcul ou alors _total difficulté_ de un chaîne.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 15

comme:
____

Ainsi nous définir la total difficulté de bloc _B_ récursivement

____
Si là sont collisions de la Bénéficiaire adresses être- interpolation ommers et la bloc (c'est à dire deux ommers avec la

(165)

(166)

_B_ ~t~ ≡ _B_ ~t~ + _B_ ~d~ _B_ ≡ _P_ ( _BH_ ) _

même Bénéficiaire adresse ou alors un ommer avec la même béné- adresse ficiaire comme bloc actuel), les ajouts sont appliqués [#_bookmark62 .anchor]####cumulativement.

Comme tel donné un bloc _B_ , _B_ t est son total difficulté, _B_ est son parent bloc et _B_ ~d~ est son difficulté.

Nous définir la bloc récompense dans Wei : (176)
____

[arabic, start=11]
. [#11._Block_Finalisation .anchor]####Bloc Finalisation

____
Le processus de finalisation un bloc implique quatre étapes:
____

[arabic]
. Valider (ou alors, si exploitation minière, déterminer) ommers ;

____
Bloc _R_ = 10 18 ×

5 si _Salut_ _ _< Fa_ Byzance

3 si _Fa_ Byzance _Salut <_ _ _F_ Constantinople

[#11.4._State_&_Nonce_Validation .anchor]####  2 si _Salut_ _ ;;: _F_ Constanti nople _ _
____

[arabic, start=2]
. valider (ou alors, si exploitation minière, déterminer) transactions;
. appliquer récompenses;
. Vérifier (ou alors, si exploitation minière, calculer un valide) Etat et link:#_bookmark17[bloc nonce.]

____
11.1. *Ommer Validation.* Le validation de link:#_bookmark18[ommer] les link:#_bookmark18[en-têtes] ne signifient rien de plus que de vérifier que chaque om- mer entête est tous les deux un valide entête et satisfait la relation

de _N_ ème génération ommer pour la cadeau bloc où _N_ ≤ 6.

Le maximum de ommer en-têtes est deux. Officiellement:

11.4. *État & Nonce Validation.* Nous mai à présent définir

la fonction, Γ, qui mappe un bloc _B_ à son état d'initiation : (177)

Γ( _B_ ) *_σ_* 0 si _P_ ( _BH_ ) _ = ∅

*_σ_* je : link:#_bookmark118[TRIE] ( _L_ S ( *_σ_* je )) = _P_ ( _B_ H ) H r autrement

Ici, TRIE ( _L_ S ( *_σ_* je )) moyens la hacher de la racine nœud de un trie d'état *_σ_* i ; on suppose que les implémentations seront boutique cette dans la Etat base de données, qui est banal et efficace

puisque la essayer est par nature un immuable Les données structure.

{empty}(167) ll _B_ *~U~*
____

ll 2

____
*U* ∈ _B_ *U*
____

link:#_bookmark35[_V_ ( *U*] ) ∧ _k_ ( *U* _, P_ ( *B*

*H* ) *H*

_,_ 6)

____
Et enfin nous définissons Φ, la fonction de transition de bloc, qui Plans un incomplet bloc _B_ pour un Achevée bloc _B_ :

où _k_ dénote la "est-parent" biens:

(168)

{empty}(178) Φ( _B_ ) ≡ _B_ : _B_ = _B_ ^∗^ à l'exception:

_k_ ( _U, H, n_ ) ≡

_faux_ si _n_ = 0

_s_ ( _U, H_ )

(179)

_B_ ~n~ = _n_ : _x_

2 256

link:\l[_Hd_ ~_~]

  ∨ _k_ ( _U , P_ ( _H_ ) H _, n_ − 1) autrement

{empty}(180) _B_ ~m~ = _m_ avec ( _x, m_ ) = PoW ( _B_ link:#_bookmark34[n ∗] _, n,_ *ré* )

(169)

_s_ ( _U , H_ ) ≡ ( _P_ ( _H_ ) = _P_ ( _U_ ) ∧ _H U_ ∧ _tu_ ∈ _/ B_ ( _H_ ) *~U~* )

où _B_ ( _H_ ) et _P_ ( _H_ ) sont la bloc et la parent bloc de la correspondant entête _H_ respectivement.
____

[arabic, start=2]
. *Transaction Validation.* Le donné *gazUtilisé* doit correspondre fidèlement aux transactions répertoriées : link:#_bookmark14[_B_ ~Hg~] , la total gaz utilisé dans la bloc, doit être égal pour la accumulé gaz utilisé selon pour la final transaction:

____
{empty}(170) link:#_bookmark14[_B_ H] g = link:#_bookmark2[_.€_] ( link:#_bookmark22[*R* ) u]
____

[arabic, start=3]
. *Demande de récompense.* L'application des récompenses à un bloc consiste à relever le solde des comptes de l'adresse bénéficiaire du bloc et de chaque ommer par un un certain montant. Nous élevons le compte bénéficiaire du bloc par _ link:#_bookmark62[~bloc~ _R_] ; link:#_bookmark62[~_~ ~_~ ~_~] pour chacun _ _ ommer, nous _ augmenter la bl o c k's b bénéficiaire d'un complément ^+++1+++^ de la récompense globale et du bénéfice ciaire de l'ommer est récompensé en fonction du bloc nombre [#_bookmark65 .anchor]##. Officiellement nous définir la une fonction Ω :

____
(171)

Ω( _B , *σ *_) ≡ *_σ_* : *_σ_* = *_σ_* sauf :

Avec *ré* être un base de données comme spécifié dans annexe link:#Appendix_J._Ethash[J]

Comme précisé au début du présent travail, link:#_bookmark67[Π] est la fonction de transition d'état, qui est définie en termes de link:#_bookmark65[Ω,] la fonction de finalisation du bloc et link:#_bookmark0[Υ,] la transaction- évaluation une fonction, tous les deux à présent bien défini.

Comme précédemment détaillé, *R* [ _n_ ] ~z~ , *R* [ _n_ ] *~l~* et *R* [ _n_ ] ~u~ sont le _n_ ième code d'état correspondant, les journaux et le gaz cumulé utilisé après chacun _ _ transaction ( *R* [ _n_ ] ~b~ , il _ Quatrième com p one n t dans le tuple, a déjà été défini en termes de logs). Nous définissons également le _n_ ième état *_σ_* [ _n_ ], qui est défini simplement comme la Etat résultant depuis appliquer la correspondant

transaction à l'état résultant de la transaction précédente. action (ou l'état initial du bloc dans le cas du premier tel transaction):
____

{empty}(182) [#_bookmark66 .anchor]##*_σ_* [ _n_ ] = link:\l[Γ(] _B_ ) si _n <_ 0

link:\l[Υ(] *_σ_* [ _n_ − 1] _, B_ *~T~* [ _n_ ]) autrement

____
Dans la Cas de _B_ *~R~* [ _n_ ] ~u~ , nous _ prendre _ _ un similaire approche _ _ définir _ chaque Objet comme la gaz utilisé dans évaluer la correspondre- ing transaction sommé avec la précédent Objet (ou alors zéro, si ce est la première), donnant nous un course total:

{empty}(172) *_σ_* [ *B* ] = *_σ_* [ *B* ] + ( 1 + ll *B U* ll _R_

   0 si _n <_ 0

(173)

∀ *U* ∈ *BU ~_~* :

  + *R* [ _n_ − 1] tu sinon

f ∅ si *_σ_* [ *U* ] = ∅ ∧ _R_ = 0

Pour *R* [ _n_ ] *~l~* , nous utiliser la link:#_bookmark42[Υ] une fonction que nous conver-

*_σ_* [ *U* c ] =
____

c

____
*un* autrement

gentiment défini dans la transaction exécution une fonction.

{empty}(184) *R* [ _n_ ] *~l~* = Υ *^l^* ( *_σ_* [ _n_ − 1] _, B_ *~T~* [ _n_ ])

{empty}(174) *un* ≡ ( *_σ_* [ _U_ ~c~ ] ~n~ _, *σ *_[ _U_ ~c~ ] ~b~ + _R , *σ *_[ _U_ ~c~ ] *~s~* _, *σ *_[ _U_ ~c~ ] ~c~ )

{empty}(175) _R_ ≡ ( 1 + +++1+++ ( _U_ − _B_ ) _R_
____

bloc

____
Nous définir link:#_bookmark42[*R* [ _n_ ] z] dans un similaire manière.

{empty}(185) *R* [ _n_ ] ~z~ = Υ ^z^ ( *_σ_* [ _n_ − 1] _, B_ *~T~* [ _n_ ])

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 16

[#_bookmark67 .anchor]####Enfin, nous définissons Π comme le nouvel état étant donné le bloc re- fonction ward link:#_bookmark65[Ω] appliquée à la résultante de la transaction finale Etat, link:#_bookmark2[_.€_] ( *_σ_* ):

{empty}(186) Π( _*σ* , B_ ) ≡ Ω( _B , .€_ ( *_σ_* ))

Ainsi, le mécanisme complet de transition de bloc est dé- une amende, à l'exception pour PoW , la preuve de travail une fonction.

[#11.5._Mining_Proof-of-Work .anchor]####11.5. *Exploitation minière Preuve de travail.* Le exploitation minière preuve de- travail (PoW) existe comme un cryptographiquement sécurise nonce que prouve au-delà raisonnable doute que un particulier quantité de calcul a été dépensée dans la détermination mination d'une valeur de jeton _n_ . Il est utilisé pour faire respecter la chaîne de blocs Sécurité par donnant sens et foi pour la notion de difficulté (et, par extension, total dif- difficulté). Cependant, depuis l'extraction de nouveaux blocs vient avec une récompense attachée, la preuve de travail ne fonctionne pas seulement comme un méthode de sécurisation confiance que la chaîne de blocs restera canonique dans le futur, mais aussi comme une richesse Distribution mécanisme.

Pour ces deux raisons, il y a deux objectifs importants du fonction de preuve de travail ; premièrement, il doit être aussi accessible que possible au plus grand nombre. L'exigence de, ou récompense de, matériel spécialisé et peu commun devrait être minimisé. Cela rend le modèle de distribution comme ouvrir comme possible, et, idéalement, fait du la loi de exploitation minière un échange simple de l'électricité à l'éther à peu près au même taux pour personne environ la monde.

Deuxièmement, ce devrait ne pas être possible pour Fabriquer super-linéaire profits, et surtout pas avec une barrière initiale élevée. Tel un mécanisme permet un bien financé adversaire pour Gain un gênant montant de la du réseau total exploitation minière Puissance et comme tel donne eux un super-linéaire récompense (Donc biaiser Distribution dans leur favoriser) comme Bien comme réduire la réseau Sécurité.

L'un des fléaux du monde Bitcoin est les ASIC. Ceux-ci sont pièces spécialisées de matériel de calcul qui n'existent que pour faire une seule tâche link:#_bookmark98[(Smith [1997]).] Dans le cas de Bitcoin, la tâche est la fonction de hachage SHA256 link:#_bookmark84[(Courtois et al. [2014]).] Tandis que Les ASIC existent pour une fonction de preuve de travail, les deux objectifs sont mis en danger. Pour cette raison, une fonction de preuve de travail résistant aux ASIC (c'est-à-dire difficile ou économiquement inefficace à mettre en œuvre dans du matériel de calcul spécialisé) possède a été identifié comme la proverbial argent balle.

Deux directions exister pour ASIC résistance; d'abord Fabriquer il séquentiel à mémoire dure, c'est-à-dire concevoir la fonction telle que la détermination de la link:#_bookmark17[nonce] a besoin un terrain de mem- ory et bande passante tel que la Mémoire ne peux pas être utilisé en parallèle pour découvrir plusieurs nonces simultanément. Le deuxième est de faire le type de calcul dont il aurait besoin pour faire à usage général ; la signification de « matériel spécialisé » pour un polyvalent tâche Positionner est, naturellement, général but Matériel et comme tel produit de base bureau des ordinateurs sont probable pour être jolie proche pour "spécialisé Matériel" pour la tâche. Pour Ethereum 1.0 nous avoir choisi la première chemin.

Suite officiellement, la preuve de travail une fonction prend la formulaire de PoW :

(187)

256

_m_ = link:#_bookmark16[_H_ m] ∧ _n_ link:#_bookmark31[_H_] avec ( _moi, n_ ) = PoW ( link:#_bookmark34[_H_ n] _, H_ n _,_ *ré* )

Où _H_ n est l'en-tête du nouveau bloc mais _sans_ la composants nonce et mix-hash ; _H_ n est le nonce du entête; *d* est un grand ensemble de données nécessaire pour calculer le mix- Hacher et _Hd_ ~_~ est la Nouveau bloc de difficulté valeur (c'est à dire la

bloquer la difficulté de la section link:#10._Blocktree_to_Blockchain[10).] PoW est la preuve de travail fonction qui évalue un tableau avec le premier élément étant le mixHash et le deuxième élément étant un pseudo- nombre aléatoire cryptographiquement dépendant de _H_ et *d* . L'algorithme sous-jacent s'appelle Ethash et est décrit au dessous de.

11.5.1. _Éthash._ Éthash est la PoW algorithme pour Ethereum

1.0. C'est la dernière version de Dagger-Hashimoto, intro- réalisé par link:#_bookmark78[Buterin] link:#_bookmark78[[2013b]] et link:#_bookmark90[Dryja] link:#_bookmark90[[2014],] bien qu'il ne peut plus s'appeler ainsi puisque beaucoup de les caractéristiques originales des deux algorithmes ont été radicalement modifié avec R&D de février 2015 au 4 mai 2015 link:#_bookmark106[(Jentzs ch] link:#_bookmark106[[2015]).] L'itinéraire général que l'algorithme prend est comme suit :

Il existe une graine qui peut être calculée pour chaque bloc en parcourant les en-têtes de bloc jusqu'à ce que indiquer. A partir de la graine, on peut calculer un pseudo-aléatoire cachette, link:#_bookmark155[_J_ ~cacheinit~] octets en taille initiale. Magasin clients légers le cache. De la cachette, nous pouvons générer un jeu de données, link:#_bookmark156[_J_ ~datasetinit~] octets en taille initiale, avec la propriété que chaque l'élément de l'ensemble de données ne dépend que d'un petit nombre de éléments de la cache. Les clients complets et les mineurs stockent le base de données. Le base de données grandit linéairement avec temps.

L'exploitation minière consiste à saisir des tranches aléatoires de l'ensemble de données et les hacher ensemble. La vérification peut se faire avec mémoire faible en utilisant le cache pour régénérer le éléments de l'ensemble de données dont vous avez besoin, vous n'avez donc qu'à boutique la cache. Le grande base de données est mis à jour une fois tous

link:#_bookmark157[_J_ ~époque~] blocs, donc le vaste majorité de un mineur l'effort sera être en train de lire la base de données, ne pas fabrication changements pour ce. Le

les paramètres mentionnés ainsi que l'algorithme sont expliqués dans détail dans annexe link:#Appendix_J._Ethash[J]
____

[arabic, start=12]
. {blank}
+
____
Exécution Contrats
____

____
Il existe plusieurs modèles d'ingénierie contractuelle qui permettre des comportements utiles particuliers ; deux d'entre eux que nous sera brièvement discuter sont Les données flux et Aléatoire Nombres.
____

[arabic]
. *Flux de données.* Un contrat de flux de données est un contrat qui pro- fournit un service unique : il donne accès aux informations de le monde extérieur au sein d'Ethereum. La précision et l'actualité de ces informations n'est pas garantie et il est la tâche d'un auteur de contrat secondaire - le contrat qui utilise la Les données nourrir—à déterminer comment beaucoup confiance pouvez être mis dans quelconque Célibataire Les données nourrir.

____
Le schéma général implique un contrat unique au sein de Ethereum qui, lorsqu'il reçoit un appel de message, répond avec quelques opportun information concernant un externe phénomène- non. Un exemple pourrait être la température locale de New York. Cela serait mis en œuvre sous la forme d'un contrat qui renvoyé cette valeur d'un point connu dans le stockage. De bien sûr ce point de stockage doit être maintenu avec le corriger une telle température, et donc la deuxième partie de la modèle voudrais être pour un externe serveur pour Cours un Ethereum nœud, et immédiatement sur Découverte de un Nouveau bloc, crée une nouvelle transaction valide, envoyée au contrat, mettant à jour ladite valeur en stockage. Le code du contrat accepterait de telles mises à jour seul depuis la identité contenu sur mentionné serveur.
____

[arabic, start=2]
. *Nombres aléatoires.* Fournir des nombres aléatoires au sein d'un système déterministe est naturellement impossible tâche. Cependant, on peut approximer avec un pseudo-aléatoire Nombres par utilisant Les données qui est en général inconnaissable

____
ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 17

au moment de la transaction. Ces données pourraient inclure le le hachage du bloc, l'horodatage du bloc et le bénéfice du bloc adresse ciaire. Afin de rendre la tâche difficile aux mineurs malveillants pour contrôler ces valeurs, il faut utiliser le link:#_bookmark144[BLOCKHASH] opération dans Commande pour utiliser hachages de la précédent 256 blocs sous forme de nombres pseudo-aléatoires. Pour une série de tels nombres, une solution triviale serait d'ajouter une quantité constante et hachage la résultat.
____

[arabic, start=13]
. {blank}
+
____
Futur les directions
____

____
La base de données d'état ne sera pas obligée de conserver toutes les données passées Etat link:#_bookmark118[essayer] structures dans la futur. Ce devrait maintenir un âge pour chaque nœud et finalement Jeter nœuds que ne sont ni assez récents ni points de contrôle. Points de contrôle, ou un ensemble de nœuds dans la base de données qui permettent à un trie d'état du bloc à traverser, pourrait être utilisé pour placer un limite maximale de la quantité de calcul nécessaire dans Commande pour récupérer quelconque Etat tout au long de la chaîne de blocs.

La consolidation de la blockchain pourrait être utilisée afin [#_bookmark70 .anchor]####de re- duc la montant de blocs un client voudrais avoir besoin pour Télécharger pour agir comme un nœud minier complet. Une archive compressée du structure triée à des moments donnés (peut-être un sur [#_bookmark69 .anchor]####chaque 10 000e bloc) pourrait être maintenu par le réseau de pairs, refondre efficacement le link:#_bookmark153[bloc de genèse.] Cela réduirait le montant à télécharger sur une seule archive [#_bookmark71 .anchor]####plus un dur maximum limite de blocs.

Enfin, la compression de la blockchain pourrait peut-être être con- canalisé : nœuds dans l'état trie qui n'ont pas envoyé/reçu [#_bookmark72 .anchor]####un transaction dans une quantité constante de blocs pourrait être jeté dehors, réduire tous les deux Fuite d'éther et la croissance de la Etat base de données.

13.1. *Évolutivité. L'évolutivité reste une* préoccupation éternelle .[#_bookmark75 .anchor]## Avec un généralisé Etat passage une fonction, ce devient dif- difficile de partitionner et de paralléliser les transactions pour appliquer la stratégie de diviser pour mieux régner. Sans réponse, la [#_bookmark74 .anchor]####dynamique la plage de valeurs du système reste essentiellement fixe et la moyen transaction valeur augmente, la moins de valeur de ils deviennent ignorés, étant économiquement inutile d'in- inclure dans le grand livre principal. Cependant, plusieurs stratégies [#_bookmark73 .anchor]####existent qui peuvent potentiellement être exploitées pour fournir un Suite évolutif protocole.

Une certaine forme de structure hiérarchique, réalisée soit par consolider les petites chaînes plus légères dans le [#_bookmark78 .anchor]####principal bloc ou alors immeuble la principale bloc par la incrémental- combinaison et adhésion (par preuve de travail) de des ensembles de transactions plus petits peuvent permettre la parallélisation des [#_bookmark76 .anchor]####trans- combinaison d'action et construction de blocs. Le parallélisme pourrait proviennent également d'un ensemble prioritaire de chaînes de blocs parallèles [#_bookmark77 .anchor]##, consolider chaque bloc et avec dupliquer ou alors invalide transactions jeté dehors par conséquent.

Enfin, un calcul vérifiable, s'il est fait [#_bookmark79 .anchor]####généralement capable et suffisamment efficace, peut fournir un itinéraire pour permettre au preuve de travail pour être la vérification de final Etat.
____

[arabic, start=14]
. {blank}
+
____
Conclusion
____

____
Nous avons introduit, discuté et formellement défini[#_bookmark81 .anchor]#### [#_bookmark82 .anchor]####la protocole d'Ethereum. Grâce à ce protocole, le lecteur peut implémenter un nœud sur le réseau Ethereum et [#_bookmark80 .anchor]####rejoindre d'autres dans un système d'exploitation social sécurisé décentralisé. Contrats mai être auteur dans Commande pour algorithmiquement spécifier et de manière autonome imposer règles de interaction.
____

[arabic, start=15]
. {blank}
+
____
Remerciements
____

____
Beaucoup Merci pour Aéron Buchanan pour création la Révisions de _Homestead_ , Christoph Jentzsch pour l'auteur du Algorithme Ethash et Yoichi Hirai pour avoir fait la plupart des Modifications EIP-150. Entretien important, correction utile tions et suggestions ont été à condition de par un Numéro de autres de l'organisation Ethereum DEV et Ethereum com- m uni t y un t grande y compris Rafale a v Simonson, P a w e l w Bylica, Jutta Steiner, Nick _ _ Épargnants , _ _ Viktor T r ´ on, Marquez _ _ Sim o vic, Giacomo Tazzari et, de cours, Vitalik Butérine.
____

[arabic, start=16]
. {blank}
+
____
Disponibilité
____

____
Le la source de cette papier est entretenu à https://github.com/ethereum/yellowpaper/[https:]

https://github.com/ethereum/yellowpaper/[//github.com/ethereum/yellowpaper/] . Un auto- Le PDF généré se trouve sur https://ethereum.github.io/yellowpaper/paper.pdf[https://ethereum.github.] https://ethereum.github.io/yellowpaper/paper.pdf[io/yellowpaper/paper.pdf] .

Références

Jacob Aron. Le logiciel BitCoin trouve une nouvelle vie. _Nouveau scientifique_ , 213(2847):20, 2012. URL http://www.sciencedirect.com/science/article/pii/S0262407912601055[http://www.sciencedirect.] http://www.sciencedirect.com/science/article/pii/S0262407912601055[com /science/article/pii/S0262407912601055] .

Adam Arrière. Haschcash - Amortissable Publiquement Auditable

Fonctions de coût, 2002. URL http://www.hashcash.org/papers/amortizable.pdf[http://www.hashcash.org/] http://www.hashcash.org/papers/amortizable.pdf[papiers/amortissable.pdf] .

Tim Beiko, James Hancock et Thomas Jay Rush. EIP- 4345 : Retard de la bombe de difficulté à juin 2022, octobre 2021a. URL https://eips.ethereum.org/EIPS/eip-4345 .

Tim Beiko et Al. Berlin réseau améliorer spécifique-

tion, 2021b. URL https://github.com/ethereum/eth1.0-specs/blob/master/network-upgrades/mainnet-upgrades/berlin.md[https://github.com/ethereum/] https://github.com/ethereum/eth1.0-specs/blob/master/network-upgrades/mainnet-upgrades/berlin.md[eth1.0-specs/blob/master/network-upgrades/] https://github.com/ethereum/eth1.0-specs/blob/master/network-upgrades/mainnet-upgrades/berlin.md[mainnet-upgrades/berlin.md] .

Guide Bertoni, Jeanne Démons, Michal Peter, et Gilles Van Assche. Le KECCAK SHA-3 sous- mission, 2011. URL https://keccak.team/files/Keccak-submission-3.pdf[https://keccak.team/files/]

https://keccak.team/files/Keccak-submission-3.pdf[Keccak-submission-3.pdf] .

romain Boutellier et mareike Heinzen. Pirates, Pio- neers, innovateurs et imitateurs. En _croissance jusqu'à Innover_ , pages 85–96. Springer, 2014. URL https://www.springer.com/gb/book/9783319040158[https:]

https://www.springer.com/gb/book/9783319040158[//www.springer.com/gb/book/9783319040158] .

Vitalik Buterin. Ethereum : Une Smart de nouvelle génération Contrat et Décentralisé Application Plateforme,

2013a. URL https://github.com/ethereum/wiki/wiki/White-Paper[https://github.com/ethereum/wiki/] https://github.com/ethereum/wiki/wiki/White-Paper[wiki/Livre blanc] .

Vitalik Buterin. Dagger : une mémoire difficile à calculer, Memory-Easy to Verify Scrypt Alternative, 2013b. URL http://www.hashcash.org/papers/dagger.html .

Vitalik Butérine. EIP-2 : Propriété hard-fork changements,

{empty}2015. URL https://eips.ethereum.org/EIPS/eip-2 . Vitalik Butérine. EIP-100 : Changer difficulté ajustement pour cibler moyenne bloc temps y compris oncles, Avril 2016a.

URL https://eips.ethereum.org/EIPS/eip-100 . Vitalik Butérine. EIP-155 : Simple rejouer attaque protéger

tion, Octobre 2016b. URL https://eips.ethereum.org/EIPS/eip-155[https://eips.ethereu m.] https://eips.ethereum.org/EIPS/eip-155[org/EIPS/eip-155] .

Vitalik Buterin. EIP-1014 : Skinny CREATE2, avril 2018. URL https://eips.ethereum.org/EIPS/eip-1014 .
____

Vitalik Butérine et Martin Swende. EIP-2929 : Gaz Coût dans-

plis pour Etat accéder les opcodes, Septembre 2020a. URL

____
https://eips.ethereum.org/EIPS/eip-2929 .

Vitalik Buterin et Martin Swende. EIP-2930 : Accompagnement en option listes d'accès, août 2020b. URL https://eips.ethereum.org/EIPS/eip-2930[https://eips.ethereum.] https://eips.ethereum.org/EIPS/eip-2930[org/EIPS/eip-2930] .

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 18

[#_bookmark83 .anchor]####Éric Conner. EIP-2384 : Muir Glacier difficulté b [#_bookmark85 .anchor]####omb retard, Novembre 2019. URL https://eips.ethereum.org/EIPS/eip-2384[https://eips.ethereum.] [#_bookmark84 .anchor]##https://eips.ethereum.org/EIPS/eip-2384[org/EIPS/eip-2384] .

Nicolas T Courtoise, marek Grajek, et Rahul [#_bookmark86 .anchor]####Naïk.

_Optimisation SHA256 dans Bitcoin Exploitation minière_ , pages 131–

{empty}144. Springer Berlin Heidelberg, Berlin, Heidel- berg, 2014. ISBN 978-3-662-44893-9. est ce que je: dix. 1007/978-3-662-44893-9 12. URL [#_bookmark87 .anchor]##https://doi.org/10.1007/978-3-662-44893-9_12[https://doi.org/10.] [#_bookmark88 .anchor]##https://doi.org/10.1007/978-3-662-44893-9_12[1007/978-3-662-44893-9_12] .

BA Davey et HA Prisley. _Introduction pour treillis et Commande. 2e éd._ Cambridge : Université [#_bookmark89 .anchor]####de Cambridge [#_bookmark90 .anchor]####Presse, 2e éd. édition, 2002. ISBN 0-521-78451-4/pbk. Thaddée Dryja. Hashimoto : E/S lié preuve de travail, 2014. URL http://diyhpl.us/ ~ bryan/papers2/

bitcoin/meh/hashimoto.pdf .

Cynthia Dwork et Moni Naour. Tarification passant par [#_bookmark92 .anchor]####pro- arrêter ou combattre le courrier indésirable. Dans _In 12th An- nual International Cryptology Conference_ , pages 139– 147, 1992. URL http://www.wisdom.weizmann.ac.il/~naor/PAPERS/pvp.pdf[http://www.wisdom.weizmann.ac.il/]

~ naor/PAPERS/pvp.pdf .

Dankrad Feist, Dmitri Khovratovitch, et Marius van [#_bookmark94 .anchor]####der

Wijden. EIP-3607 : Rejeter transactions depuis expéditeurs avec déployé code, Juin 2021. URL [#_bookmark95 .anchor]##https://eips.ethereum.org/EIPS/eip-3607[https://eips.] [#_bookmark96 .anchor]##https://eips.ethereum.org/EIPS/eip-3607[ethereum.org/EIPS/eip-3607] .

Alexandre Forshtat et Yoav Weiss. EIP-1706 : Désactiver sstore

avec gaz gauche plus bas que appel traitement, 2019. URL https:

//eips.ethereum.org/EIPS/eip-1706 .

Phong Vo Glenn Fowler, Landon Curt Noll. Fo [#_bookmark98 .anchor]####wlerNol- Fonction de hachage lVo, 1991. URL http://www.isthe.com/chongo/tech/comp/fnv/index.html[http://www.isthe.com/] [#_bookmark99 .anchor]##http://www.isthe.com/chongo/tech/comp/fnv/index.html[chongo/tech/comp/fnv/index.html] .

Nils Goura, Arun Patel, Arvinderpal Errer, Hans Eberle [#_bookmark100 .anchor]##,

et Sheueling Chang Shantz. Comparer la courbe elliptique cryptographie et RSA sur les processeurs 8 bits. En _cryptographie Matériel et Systèmes Embarqués-CHES 2004_ , [#_bookmark101 .anchor]####pages 119–132. Springer, 2004. URL https://www.iacr.org/archive/ches2004/31560117/31560117.pdf[https://www.iacr.org/] [#_bookmark102 .anchor]##https://www.iacr.org/archive/ches2004/31560117/31560117.pdf[archive/ches2004/31560117/31560117.pdf] .

James Hancock. EIP-3554 : Difficile retard de la bombe à De- décembre 2021, mai 2021. URL [#_bookmark103 .anchor]##https://eips.ethereum.org/EIPS/eip-3554[https://eips.ethereum.] [#_bookmark104 .anchor]##https://eips.ethereum.org/EIPS/eip-3554[org/EIPS/eip-3554] .

Tjaden Hesse, Mat Luongo, Piotr Dyraga, et James

Hancock. EIP-152 : Ajouter la fonction de compression BLAKE2 tion 'F' précompiler, Octobre 2016. URL [#_bookmark105 .anchor]##https://eips.ethereum.org/EIPS/eip-152[https://eips.] [#_bookmark106 .anchor]##https://eips.ethereum.org/EIPS/eip-152[ethereum.org/EIPS/eip-152] .

Christophe Jentzsch. Commettre Date pour éthash, 2015. URL

https://github.com/ethereum/yellowpaper/commit/77a8cf2428ce245bf6e2c39c5e652ba58a278666#commitcomment-24644869[https://github.com/ethereum/yellowpaper/commit/] https://github.com/ethereum/yellowpaper/commit/77a8cf2428ce245bf6e2c39c5e652ba58a278666#commitcomment-24644869[77a8cf2428ce245bf6e2c39c5e652ba58a278666#] [#_bookmark108 .anchor]##https://github.com/ethereum/yellowpaper/commit/77a8cf2428ce245bf6e2c39c5e652ba58a278666#commitcomment-24644869[commitcomment-24644869] .

Enfiler Johnson, Alfred Ménezès, et Scott Van- calcul. Le Elliptique Courbe Signalisation numérique-[#_bookmark109 .anchor]## ture Algorithme (ECDSA), 2001. URL https:

//web.archive.org/web/20170921160141/http://

cs.ucsb.edu/ ~ koc/ccs130h/notes/ecdsa- [#_bookmark110 .anchor]####cert.pdf . Accédé 21 Septembre 2017, mais la original lien a été

inaccessible sur 19 Octobre 2017. Faire référence à section 6.2 pour ECDSAPUBKEY, et section 7 pour ECDSASIGN et

ECDSARECOVER.

Sergio Démian Lerner. Stricte Mémoire Dur Hachage Fonction- tions, 2014. URL http://www.hashcash.org/papers/memohash.pdf[http://www.hashcash.org/papers/] http://www.hashcash.org/papers/memohash.pdf[memohash.pdf] .

Marquer Meunier. Le Futur de Droit. Dans _Pennsylvanie-_

_par livré à la conférence Extra 3 (août 9)_ , 1997. URL https://drive.google.com/file/d/0Bw0VXJKBgYPMS0J2VGIyWWlocms/edit?usp=sharing[https://drive.google.com/file/d/] https://drive.google.com/file/d/0Bw0VXJKBgYPMS0J2VGIyWWlocms/edit?usp=sharing[0Bw0VXJKBgYPMS0J2VGIyWWlocms/edit?usp=partage] .

Satoshi Nakamoto. Bitcoin : UN d'égal à égal électronique espèces

système, 2008. URL http://www.bitcoin.org/bitcoin.pdf[http://www.bitcoin.org/bitcoin.] http://www.bitcoin.org/bitcoin.pdf[pdf] .

Meni Rosenfeld, Yoni Assie, Vitalik Butérine, m li- orhakiLior, Oded Leïba, Assaf Shomer, et Eli- couru Zach. Coloré Pièces de monnaie Protocole Spécification, 2012. URL https://github.com/Colored-Coins/Colored-Coins-Protocol-Specification[https://github.com/Colored-Coins/]

https://github.com/Colored-Coins/Colored-Coins-Protocol-Specification[Spécification du protocole des pièces de couleur] .

Markku-Juhani Saarinen et Jean Philippe Aumasson. RFC 7693 : Le hachage cryptographique BLAKE2 et mes- code d'authentification sage (MAC), novembre 2015. URL https://tools.ietf.org/html/rfc7693 .

Afrique Schoedon. EIP-1234 : Constantinople difficulté bombe

retard et bloc récompense ajustement, 2018. URL https:

//eips.ethereum.org/EIPS/eip-1234 .

Afri Schoedon et Vitalik Buterin. EIP-649 : Métropole- retard de bombe de difficulté de lis et réduction de récompense de bloc, Juin 2017. URL https://eips.ethereum.org/EIPS/eip-649[https://eips.ethereum.org/EIPS/]

https://eips.ethereum.org/EIPS/eip-649[eip-649] .

Michael John Sébastien Forgeron. _Spécifique à l'application Intégré Circuits_ . Addison-Wesley, 1997. ISBN 0201500221.

Yonatan Sompolinsky et Aviv Zohar. Accélération peu- pièces de monnaie transaction En traitement. vite de l'argent grandit sur des arbres, ne pas Chaînes, 2013. URL https://eprint.iacr.org/2013/881[https://eprint.iacr.org/ _]

https://eprint.iacr.org/2013/881[2013/881] .

Simon Sprankel. Technique Base de Numérique Devises, 2013. URL http://www.coderblog.de/wp-content/uploads/technical-basis-of-digital-currencies.pdf[http://www.coderblog.de/wp-content/] http://www.coderblog.de/wp-content/uploads/technical-basis-of-digital-currencies.pdf[téléchargements/ base-technique-des-monnaies-numériques.] http://www.coderblog.de/wp-content/uploads/technical-basis-of-digital-currencies.pdf[pdf] .

pseudo Szabo. Formaliser et sécurisation relation-

navires sur le public réseaux. _Première Lundi_ , 2(9), 1997. URL http://firstmonday.org/ojs/index.php/fm/article/view/548[http://firstmonday.org/ojs/index.php/] http://firstmonday.org/ojs/index.php/fm/article/view/548[fm/article/vue/548] .

Wei Soie. EIP-2200 : structuré définitions pour rapporter gaz moi-

tering, 2019. URL https://eips.ethereum.org/EIPS/eip-2200[https://eips.ethereum.org/EIPS/] https://eips.ethereum.org/EIPS/eip-2200[eip-2200] .

Vivek Vishnumurthy, Sangeeth Chandrakumar, et Emin Gn Sirer. KARMA : Un cadre économique sécurisé pour d'égal à égal Ressource partage, 2003. URL https://

www.cs.cornell.edu/people/egs/papers/karma.pdf .

J R Willette. MasterCoin Complet Spécification, 2013. URL https://github.com/mastercoin-MSC/spec .

Michée Zoltu. EIP-2718 : Tapé transaction enveloppe,

Juin 2020. URL https://eips.ethereum.org/EIPS/eip-2718[https://eips.ethereum.org/EIPS/] https://eips.ethereum.org/EIPS/eip-2718[eip-2718] .

[#Appendix_A._Terminology .anchor]####annexe UN. Terminologie

*Acteur externe :* Une personne ou une autre entité capable de s'interfacer avec un nœud Ethereum, mais extérieure au monde de Ethereum. Il peut interagir avec Ethereum en déposant des transactions signées et en inspectant la blockchain et associé Etat. Possède une (ou alors Suite) intrinsèque Comptes.

*Adresse:* UN 160 bits code utilisé pour identifier Comptes.

*Compte:* Comptes avoir un intrinsèque solde et transaction compter entretenu comme partie de la Ethereum Etat. Ils aussi avoir quelques (peut-être vider) EVM Code et un (peut-être vider) Stockage État associé avec eux.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 19

Bien qu'homogène, il est logique de distinguer deux types pratiques de comptes : ceux avec vide Code EVM associé (ainsi le solde du compte est contrôlé, le cas échéant, par une entité externe) et ceux avec Code EVM associé non vide (le compte représente donc un Objet Autonome). Chaque compte a un Célibataire Adresse que identifie ce.

*Transaction:* Une donnée, signée par un Acteur Externe. Il représente soit un Message soit une nouvelle Autonome Objet. Transactions sont enregistré dans chaque bloc de la chaîne de blocs.

*Objet autonome :* un objet fictif existant uniquement dans l'état hypothétique d'Ethereum. A une valeur intrinsèque adresse et donc un compte associé ; le compte aura un code EVM associé non vide. Incorporé seul comme la Stockage État de que Compte.

*État de stockage :* Les informations propres à un compte donné qui sont conservées entre les moments où le Comptes associé EVM Code court.

*Message:* Les données (sous la forme d'un ensemble d'octets) et la valeur (spécifiée comme Ether) qui sont transmises entre deux comptes, soit par le fonctionnement déterministe d'un Objet Autonome ou la signature cryptographiquement sécurisée du Transaction.

*Appel de message :* action de transmettre un message d'un compte à un autre. Si le compte de destination est associé avec non vide EVM Code, puis le La MV va démarrer avec le état de ledit Objet et le message a agi sur. Si l'expéditeur du message est un objet autonome, l'appel transmet toutes les données renvoyées par la VM opération.

*Gaz:* L'unité de coût de réseau fondamentale. Payé exclusivement par Ether (à partir de PoC-4), qui est converti librement en et du gaz selon les besoins. Le gaz n'existe pas en dehors du moteur de calcul interne d'Ethereum ; son prix est Positionner par la Transaction et mineurs sont libre pour ignorer Transactions à qui Gaz le prix est aussi bas.

*Contrat:* Terme informel utilisé pour désigner à la fois un morceau de code EVM qui peut être associé à un compte ou un Autonome Objet.

*Objet:* Synonyme pour Autonome Objet.

*Application :* Un visible par l'utilisateur final application hébergé dans la Ethereum Navigateur.

*Navigateur Ethereum :* (alias Ethereum Reference Client) Une interface graphique multiplateforme d'une interface similaire à une interface simplifiée navigateur (à la Chrome) capable d'héberger des applications en bac à sable dont le backend est purement sur l'Ethereum protocole.

*Ethereum Virtuel Machine:* (alias EVM) Le virtuel machine que formes la clé partie de la exécution maquette pour un Comptes associé EVM Code.

*Environnement d'exécution Ethereum :* (alias ERE) L'environnement fourni à un objet autonome s'exécutant dans l'EVM. Inclut l'EVM mais aussi la structure de l'état mondial sur laquelle s'appuie l'EVM pour certain E/S des instructions y compris APPEL & CRÉER.

*Code EMV :* Le bytecode que la EVM pouvez nativement exécuter. Utilisé pour officiellement spécifier la sens et ramifications de un message pour un Compte.

*EVM Assemblée:* Le lisible par l'homme formulaire de Code EVM.

*JE VAIS:* Le Lisp-like Niveau faible Langue, un inscriptible par l'homme Langue utilisé pour création Facile contrats et général niveau faible Langue boîte à outils pour trans-compilation pour.

[#Appendix_B._Recursive_Length_Prefix .anchor]####annexe B Récursif Longueur Préfixe

[#_bookmark113 .anchor]####Cette est un sérialisation méthode pour codage arbitrairement structuré binaire Les données (octet tableaux). Nous définir la Positionner de possible structures T :

(188)

(189)

(190)

J ≡ L \± B

L ≡ \{ *t* : *t* = ( *t* [0] _,_ *t* [1] _, ..._ ) ∧ ∀n __ <_ ll *ll* ll : *t* [ _n_ ] ∈ T }

B ≡ \{ *b* : *b* = ( *b* [0] _,_ *b* [1] _, ..._ ) ∧ ∀n __ <_ ll *b* ll : *b* [ _n_ ] ∈ O }

Où O est la Positionner de (8 bits) octets. Ainsi B est la Positionner de tout séquences de octets (autrement connu comme octet tableaux, et une feuille si on l'imagine comme un arbre), L est l'ensemble de toutes les (sous-)structures arborescentes qui ne sont pas une seule feuille (un nœud de branche si imaginé comme un arbre) et J est la Positionner de tout octet tableaux et tel de construction séquences. Le disjoint syndicat \± est avait besoin seul

pour distinguer la vider octet déployer () ∈ B depuis la vider liste () ∈ L , qui sont codé différemment comme défini au dessous de; comme

commun, nous sera abuser de notation et laisser la disjoint syndicat indices implicite, inférable depuis le contexte.

Nous définissons la fonction RLP comme RLP à travers deux sous-fonctions, la première gérant l'instance lorsque la valeur est un octet déployer, la seconde lorsque ce est un séquence de plus loin valeurs:

{empty}(191) RLP ( *x* ) _R_ b ( *x* ) si *X* ∈ B

_R_ ~l~ ( *x* ) sinon

Si la valeur pour être sérialisé est un octet déployer, la RLP sérialisation prend une de Trois formes:
____

* Si la octet déployer contient uniquement un Célibataire octet et que Célibataire octet est moins que 128, alors la saisir est exactement égal pour la production.
* Si la octet déployer contient moins de que 56 octets, alors la production est égal pour la saisir préfixé par la octet égal pour la longueur de la octet déployer plus 128.

____
ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 20
____

* Autrement, la production est égal pour la saisir, à condition de que ce contient moins de que 2 octets, préfixé par la

____
longueur minimale octet déployer qui lorsque interprété comme un big-endian entier est égal pour la longueur de la saisir octet

déployer, qui est lui-même préfixé par la Numéro de octets obligatoire pour fidèlement encoder cette longueur valeur plus 183.

Tableaux d'octets contenant 2 ^64^ ou plusieurs octets ne peuvent pas être encodés. Cette restriction garantit que le premier octet de l'encodage [#_bookmark114 .anchor]####de un octet déployer est toujours au dessous de 192, et Donc ce pouvez être facilement distingué depuis la encodages de séquences dans L. _

Formellement , _ _ nous _ définir _R_ ~b~ :

(192)

[#_bookmark115 .anchor]##_R_ ~b~ ( *x* ) ≡

*x* si ll *x* ll = 1 ∧ *×* [0] _<_ 128

(128 + ll *x* ll ) · *x* sinon si ll *x* ll _<_ 56

∅ sinon

*b* − 1

(193)

ÊTRE ( _x_ ) ≡ ( _b_ 0 _, b_ 1 _, ..._ ) : _b_ 0

0 ∧ _X_ =

_n_ =0

_b n_ · 256 *b* − 1 − _n_

{empty}(194) ( _x_ 1 _, ..., x n_ ) · ( _y_ 1 _, ..., y m_ ) = ( _x_ 1 _, ..., x n , y_ 1 _, ..., y m_ )

Ainsi ÊTRE est la une fonction que se développe un non négatif entier valeur pour un big-endian octet déployer de minimal longueur et la point opérateur effectue séquence enchaînement.

Si Au lieu, la valeur pour être sérialisé est un séquence de autre éléments alors la RLP sérialisation prend une de deux formes:
____

* Si la concaténé sérialisations de chaque contenu Objet est moins que 56 octets dans longueur, alors la production est égal pour que enchaînement préfixé par la octet égal pour la longueur de cette octet déployer plus 192.
* Autrement, la production est égal pour la concaténé sérialisations, à condition de que elles ou ils contenir moins de que 2 octets,

____
préfixé par la longueur minimale octet déployer qui lorsque interprété comme un big-endian entier est égal pour la longueur

de la concaténé sérialisations octet déployer, qui est lui-même préfixé par la Numéro de octets obligatoire pour fidèlement encoder cette longueur valeur plus 247.

Séquences à qui concaténé sérialisé éléments contenir 2 ^64^ ou alors Suite octets ne peux pas être codé. Cette restriction assure [#_bookmark116 .anchor]####que la première octet de la codage Est-ce que ne pas dépasser 255 (autrement ce voudrais ne pas être un octet).

Ainsi nous terminer par officiellement définir _R_ ~l~ :

(195)

_R_ ~l~ ( *x* ) ≡

247 + BE ( ll _s_ ( *x* ) ll ) · BE ( ll _s_ ( *x* ) ll ) · _s_ ( *x* ) autre si _s_ ( *x* ) = ∅ ∧ ll _s_ ( *x* ) ll _<_ 2 ^64^

F

Si RLP est utilisé pour encoder un scalaire, défini seul comme un non négatif entier (dans N , ou alors dans N _x_ pour quelconque _x_ ), ce doit être codé comme le tableau d'octets le plus court dont l'interprétation gros-boutiste est le scalaire. Ainsi, le RLP d'un entier non négatif _i_ est défini comme:

{empty}(197) RLP ( _je_ : _je_ ∈ N ) ≡ RLP ( BE ( _i_ ))

Lors de l'interprétation des données RLP, si un fragment attendu est décodé en tant que scalaire et que des zéros non significatifs sont trouvés dans l'octet séquence, les clients sont tenus de la considérer comme non canonique et de la traiter de la même manière que des données RLP autrement invalides, congédier ce totalement.

Là est non spécifique canonique codage format pour signé ou alors point flottant valeurs.

annexe C Préfixe hexadécimal Codage

Le codage par préfixe hexadécimal est une méthode efficace pour coder un nombre arbitraire de quartets sous la forme d'un tableau d'octets. Il est capable de stocker un indicateur supplémentaire qui, lorsqu'il est utilisé dans le contexte du trie (le seul contexte dans lequel il est utilisé), lève l'ambiguïté entre nœud les types.

Il est défini comme la fonction HP qui mappe à partir d'une séquence de quartets (représentés par l'ensemble Y ) avec un booléen valeur pour un séquence de octets (représentée par la Positionner B ):

(198)

PS ( *x* _, t_ ) : *x* Y (16 _f_ ( _t_ ) _,_ 16 *fois* [0] + *x* [1] _,_ 16 *×* [2] + *x* [3] _, ..._ ) si ll *x* ll est même

(16( _f_ ( _t_ ) + 1) + *x* [0] _,_ 16 *fois* [1] + *x* [2] _,_ 16 *fois* [3] + *x* [4] _, ..._ ) autrement

(199)

_F_ ( _t_ ) ≡ f 2 si _t_ 0

0 autrement

Ainsi, le quartet haut du premier octet contient deux drapeaux ; le bit le plus bas codant l'impair de la longueur et le deuxième codage le plus bas du drapeau _t_ . Le quartet bas du premier octet est nul dans le cas d'un nombre pair de quartets et le premier quartet dans le cas d'un nombre impair. Tous les quartets restants (maintenant un nombre pair) s'insèrent correctement dans le reste octets.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 21

[#Appendix_D._Modified_Merkle_Patricia_Tre .anchor]####annexe RÉ. Modifié Merkel Patricia Arbre

[#_bookmark118 .anchor]####L'arbre Merkle Patricia modifié (trie) fournit une structure de données persistante pour mapper entre binaire de longueur arbitraire données (tableaux d'octets). Il est défini en termes de structure de données mutable pour mapper entre des fragments binaires de 256 bits et données binaires de longueur arbitraire, généralement implémentées sous forme de base de données. Le noyau du trie, et sa seule exigence en termes de la protocole spécification, est pour fournir un Célibataire valeur que identifie un donné Positionner de valeur clé paires, qui mai être Soit une séquence de 32 octets ou la séquence d'octets vide. Il est laissé comme une considération de mise en œuvre pour stocker et maintenir le structure de la essayer dans un manière que permet efficace et efficace la concrétisation de la protocole.

Officiellement, nous présumer la saisir valeur je , un Positionner contenant paires de octet séquences avec unique clés:

{empty}(200) je = \{ ( *k* 0 ∈ B _,_ *v* 0 ∈ B ) _,_ ( *k* 1 ∈ B _,_ *v* 1 ∈ B ) _,_ }

Lors de l'examen d'une telle séquence, nous utilisons la notation d'indice numérique commune pour faire référence à la clé ou à la valeur d'un tuple, Donc:

{empty}(201) ∀ _je_ ∈ Je : _je_ ≡ ( _je_ 0 _, je_ 1 )

Quelconque séries de octets mai aussi trivialement être vu comme un séries de grignote, donné un spécifique à endian notation; ici nous présumer big-endian. Ainsi:

(202)

(203)

∀n ___ : ∀ _je <_ 2 ll *k* _n_

_y_ ( je ) = \{ ( *k* ~0~ ∈ Oui _,_ *v* ~0~ ∈ B ) _,_ ( *k* ~1~ ∈ Oui _,_ *v* ~1~ ∈ B ) _, ..._ }

*k* _n_ [ _je_ 2] 16si _je_ est même

_n_

*k* _n_ [ l _je_ ÷ 2 J ] mod _ _ 16 autrement

Nous définissons la fonction TRIE , qui évalue à la racine du trie qui représente cet ensemble lorsqu'il est encodé dans ce structure:

{empty}(204) TRIE ( I ) ≡ KEC RLP ( _c_ ( je _,_ 0))

Nous supposons également une fonction _n_ , la fonction de cap de nœud du trie. Lors de la composition d'un nœud, nous utilisons RLP pour coder le structure. Comme un moyens de réduire stockage complexité, nous boutique nœuds à qui composé RLP est moins de que 32 octets directement; pour les plus grands, nous affirmons la prescience du tableau d'octets dont le hachage Keccak-256 s'évalue à notre référence. Ainsi nous définissons dans termes de _c_ , la nœud composition une fonction:
____

 () si je = ∅

KEC RLP ( _c_ ( je _, je_ )) sinon

____
D'une manière similaire à un arbre de base, lorsque le trie est parcouru de la racine à la feuille, on peut construire une seule paire clé-valeur. La clé est accumulée tout au long du parcours, en acquérant un seul quartet à partir de chaque nœud de branche (tout comme avec un arbre de base). Contrairement à un base arbre, dans la Cas de plusieurs clés partage la même préfixe ou alors dans la Cas de un Célibataire clé ayant un unique suffixe, deux nœuds d'optimisation sont fournis. Ainsi, lors de la traversée, on peut potentiellement acquérir plusieurs quartets de chaque de la autre deux nœud les types, extension et feuille. Là sont Trois sortes de nœuds dans la essayer :

*Feuille :* une structure à deux éléments dont le premier élément correspond aux quartets dans la clé qui ne sont pas déjà pris en compte par le accumulation de clés et de branches parcourues depuis la racine. La méthode de codage par préfixe hexadécimal est utilisée et le seconde paramètre pour la une fonction est obligatoire pour être 1.

*Extension:* Une structure à deux éléments dont le premier élément correspond à une série de quartets de taille supérieure à un qui sont partagées par au moins deux clés distinctes passé le cumul des clés de quartets et des clés de branches comme traversé à partir de la racine. La méthode de codage par préfixe hexadécimal est utilisée et le deuxième paramètre de la fonction est obligatoire pour être 0.

*Branche :* une structure de 17 éléments dont les seize premiers éléments correspondent à chacune des seize valeurs de quartet possibles pour la clés à cette indiquer dans leur traversée. Le 17ème Objet est utilisé dans la Cas de cette être un terminateur nœud et Donc un clé être terminé à cette indiquer dans son traversée.

Une branche n'est alors utilisée qu'en cas de nécessité ; aucun nœud de branche ne peut exister qui ne contienne qu'une seule entrée non nulle. Nous mai officiellement définir cette structure avec la de construction composition une fonction _c_ :

HP ( _je_ [ _je.._ ( _je_ 1)] _,_ 1) _, je_ si je = 1 où _je_ : _je_ je

HP ( _I_ 0 [ _i.._ ( _j_ − 1)] _,_ 0) _, n_ ( je _, j_ ) si _je_ = _j_ où _j_ = max \{ _x_ : ∃ *l* : ll *ll* ll = _x_ ∧ ∀ _je_ ∈ Je : _je_ 0 [0 _.._ ( _x_ − 1)] = *l* }

{empty}(206) _c_ ( je _, je_ ) ≡ ** ( _u_ (0) _, tu_ (1) _, ..., tu_ (15) _, v_ ) sinon où _tu_ ( _j_ ) ≡ _n_ f ( \{ _je_ : _je_ ∈ je ∧ _je_ 0 [ _je_ ] = _j_ } _, je_ + 1)

D.1. *Essayer Base de données.* Ainsi non explicite hypothèses sont fabriqué concernant quelle Les données est stockée et quelle est ne pas, puisque que est un spécifique à la mise en œuvre considération; nous simplement définir la identité une fonction cartographie la valeur clé Positionner je pour un 32 octets hacher et affirmer que seul un Célibataire tel hacher existe pour quelconque je , qui mais ne pas strictement vrai est précis dans acceptable précision donné la Keccak hachis collision résistance. Dans réalité, un sensible la mise en oeuvre sera ne pas pleinement recalculer la essayer racine hacher pour chaque Positionner.

Une implémentation raisonnable maintiendra une base de données de nœuds déterminée à partir du calcul de divers essais ou, Suite officiellement, ce sera mémoire la une fonction _c_ . Cette stratégie les usages la nature de la essayer pour tous les deux facilement rappeler la Contenu de

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 22

tout ensemble de valeurs-clés précédent et de stocker plusieurs de ces ensembles de manière très efficace. En raison de la relation de dépendance, Merkle-preuves mai être construit avec un _O_ (log _N_ ) espace exigence que pouvez démontrer un particulier feuille doit exister dans un essayer de un donné racine hacher.

[#Appendix_E._Precompiled_Contracts .anchor]####annexe E. Précompilé Contrats

Pour chaque précompilé Contrat, nous Fabriquer utiliser de un modèle une fonction, Ξ PRE , qui met en oeuvre la panne d'essence vérification.

{empty}(207) [#_bookmark120 .anchor]####Ξ
____

PRÉ

( _*σ* , g, UN, Je_ ) ( ∅ _,_ 0 _, UN,_ ()) si _g < g_ r

( _*σ* , g_ − _g_ r _, UN,_ *o* ) autrement

____
Les contrats précompilés utilisent chacun ces définitions et fournissent des spécifications pour le *o* (les données de sortie) et _g_ r , le gaz conditions.

On définit Ξ ECREC sous forme de contrat précompilé pour la clé publique de l'algorithme de signature numérique à courbe elliptique (ECDSA) fonction de récupération (ecrecover). Voir l'annexe link:#Appendix_F._Signing_Transactions[F] pour la définition de la fonction ECDSARECOVER . Nous définissons également *d* comme étant les données d'entrée, bien définies pour une longueur infinie en ajoutant des zéros si nécessaire. En cas de signature invalide ( ECDSARECOVER ( _h, v, r, s_ ) = ∅ ), nous retourner non production.

(208)

(209)

(210)

Ξ ECREC ≡ Ξ PRÉ où:

_g_ r = 3000

*o* = 0 si ECDSARECOVER ( _h, v, r, s_ ) = ∅

32 autrement

(211)

(212)

(213)

(214)

si tout *va* bien = 32 :

*o* [0 _.._ 11] = 0

*o* [12 _.._ 31] = KEC ECDSARECOVER ( _h, v, r, s_ ) [12 _.._ 31] où:

*d* [0 _.._ ( ll link:#_bookmark54[_I_ *~d~*] ll − 1)] = _je_ *~d~*
____

[width="100%",cols="35%,39%,7%,19%",options="header",]
|===
a|
____
(215)
____

|*d* [ ll _je_ *~d~* ll _.._ ] |= a|
____
(0 _,_ 0 _, ..._ )
____

a|
____
(216)
____

|_h_ |= a|
____
*d* [0 _.._ 31]
____

a|
____
(217)
____

|_v_ |= a|
____
*d* [32 _.._ 63]
____

a|
____
(218)
____

|_r_ |= a|
____
*d* [64 _.._ 95]
____

a|
____
(219)
____

|_s_ |= a|
____
*d* [96 _.._ 127]
____

|===

____
Nous définir Ξ SHA256 et Ξ RIP160 comme précompilé contrats exécution la SHA2-256 et RIPEMD-160 hacher les fonctions respectivement. Leur gaz usage est dépendant sur la saisir Les données Taille, un facteur arrondi en haut pour la la plus proche Numéro de mots.

{empty}(220) Ξ SHA256 ≡ Ξ PRÉ où:

(221)

_g_ = 60 + 12 +++ll _je_ *d* ll+++

32

{empty}(222) *ou* [0 _.._ 31] = SHA256 ( _je_ *~d~* )

{empty}(223) Ξ RIP160 ≡ Ξ PRÉ où:

(224)

_g_ = 600 + 120 +++ll _je_ *d* ll+++

32

{empty}(225) *ou* [0 _.._ 11] = 0

{empty}(226) *ou* [12 _.._ 31] = RIPEMD160 ( _I_ *~d~* )

Pour la fins ici, nous présumer nous avoir bien défini la norme cryptographique les fonctions pour RIPEMD-160 et SHA2-256 de la formulaire:

(227)

(228)

SHA256 ( *je* ∈ B ) ≡ _o_ ∈ B 32

RIPEMD160 ( *je* ∈ B ) ≡ _o_ ∈ B 20

Le Quatrième Contrat, la identité une fonction Ξ ID simplement définit la production comme la saisir:

{empty}(229) Ξ ID ≡ Ξ PRÉ où:

(230)

_g_ = 15 + 3 +++ll _je_ *d* ll+++

32
____

[arabic, start=231]
. *o* = _je_ *~d~*

____
Le cinquième contrat _ _ effectue _ précision arbitraire ex p on n tiation en dessous de moi dulo . Tiens , _ 0 ^0^ est pris _ _ pour être _ une, et _X_ mod _ _ 0 est nul pour tout _x_ . Le premier mot de l'entrée spécifie le nombre d'octets occupés par le premier entier non négatif _B._ Le deuxième mot de l'entrée spécifie le nombre d'octets occupés par le deuxième entier non négatif _E._ Le troisième mot dans la saisir précise la Numéro de octets que la troisième non négatif entier _M_ occupe. Celles-ci Trois mots sont

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 23

suivi par _B_ , _E_ et _M_ . Le le repos de la saisir est mis au rebut. Chaque fois que la saisir est aussi court, la disparu octets sont considéré pour être zéro. Le production est codé big-endian dans la même format comme _M_ 's.
____

[arabic, start=232]
. Ξ EXPMOD ≡ Ξ PRÉ à l'exception:
. {blank}

____
_g_ = maximum 200 _,_ je _F_ max( _.€_ ~M~ _, .€_ ~B~ ) max( _.€_ ~E~ _,_ 1)
____

[arabic, start=234]
. {blank}
. {blank}

____
_G_ quaddiviseur ≡ 3

_F_ ( _x_ ) ≡ _+++X+++_ l 2

quaddiviseur
____

[arabic, start=236]
. {blank}

____
_.€_ ~E~ =

0 si _.€_ E ≤ 32 ∧ _E_ = 0

l log ~2~ ( _E_ ) J si _ _.€_ E ≤ 32 ∧ _E_ = 0

8( _.€_ E − 32) + l lo g ~2~ ( _je_ [(96 + _.€_ B ) _.._ (127 + _.€_ B )]) J si 32 _< . €_ E ∧ _je_ [(96 + _.€_ B ) _.._ (127 + _.€_ B )] = 0

8( _.€_ E − 32) sinon
____

[arabic, start=237]
. *o* = _B ^E^_ mod _ _ _M_ ∈ N ~8 _£_~

[width="100%",cols="19%,14%,6%,61%",options="header",]
|===
a|
____
(238)
____

|_.€_ B |≡ a|
____
_je_ [0 _.._ 31]
____

a|
____
(239)
____

|_.€_ E |≡ a|
____
_je_ [32 _.._ 63]
____

a|
____
(240)
____

|_.€_ M |≡ a|
____
_je_ [64 _.._ 95]
____

a|
____
(241)
____

|_B_ |≡ a|
____
_je_ [96 _.._ (95 + _.€_ B )]
____

a|
____
(242)
____

|_E_ |≡ a|
____
_je_ [(96 + _.€_ B ) _.._ (95 + _.€_ B + _.€_ E )]
____

a|
____
(243)
____

|_M_ |≡ a|
____
_je_ [(96 + _.€_ B + _.€_ E ) _.._ (95 + _.€_ B + _.€_ E + _.€_ M )]
____

|===

____
(244)

_je_ [ _x_ ] _je_ *~ré~* [ _x_ ] si _X <_ ll _je_ *~d~* ll

0 sinon
____

[arabic]
. *zkSNARK Lié Précompilé Contrats.* Nous choisir deux Nombres, tous les deux de qui sont prime.

____
{empty}(245) _p_ ≡ 2188824287183927522246405745257275088696311157297823662689037894645226208583

{empty}(246) _q_ ≡ 2188824287183927522246405745257275088548364400416034343698204186575808495617

Depuis _p_ est un prime Numéro, \{ 0 _,_ 1 _, . . . , p_ − 1 } formes un domaine avec une addition et multiplication modulo _p_ . Nous appel cette domaine _Fp_ . _

Nous définir un Positionner _C_ 1 avec

{empty}(247) _C_ 1 ≡ \{ ( _X, Oui_ ) ∈ _F_ p × _F_ p | _Oui_ 2 = _X3_ _ + 3 } ∪ \{ (0 _,_ 0) }

Nous définir un binaire opération + sur _C_ 1 pour distinct éléments ( _X_ 1 _, Y_ 1 ) _,_ ( _X_ 2 _, Oui_ 2 ) avec

(248)

[#_bookmark121 .anchor]##( _X , Oui_ ) + ( _X , Oui_ ) ≡ f ( _X , Oui_ ) si _X_ 1 = _X2_ _
____

_λ +++Y +++_+++2 − _Oui_ 1+++

_X2_ _ − _X_ 1

____
_X_ ≡ _λ_ 2 − _X_ 1 − _X2_ _

_Oui_ ≡ _λ_ ( _X_ 1 − _X_ ) − _Oui_ 1

Dans la Cas où ( _X_ 1 _, Oui_ 1 ) = ( _X_ 2 _, Y_ 2 ), nous définir + sur _C_ 1 avec

{empty}(249) [#_bookmark122 .anchor]##( _X , Oui_ ) + ( _X , Oui_ ) ≡ f ( _X , Oui_ ) si _Oui_ 1 0
____

1 1 2 2

_λ_ ≡

____
(0 _,_ 0) sinon

3 _X_ ^2^

2 _ans_ 1

_X_ ≡ _λ_ 2 − 2 _X_ 1

_Oui_ ≡ _λ_ ( _X_ 1 − _X_ ) − _Oui_ 1

( _C_ 1 _,_ +) est connu pour formulaire un grouper. Nous définir scalaire multiplication [#_bookmark123 .anchor]##· avec

{empty}(250) _n_ · _P_ ≡ (0 _,_ 0) + _P_ + · · · + _P_

_n_

pour un Naturel Numéro _n_ et un indiquer _P_ dans _C1_ . _

Nous définir _P_ 1 pour être un indiquer (1 _,_ 2) sur _C1_ . _ Laisser _G_ 1 être la sous-groupe de ( _C_ 1 _,_ +) généré par _P1_ . _ _G_ 1 est connu pour être un cyclique grouper de Commande _Q._ _ Pour un indiquer _P_ dans _G_ 1 , nous définir journal ~_P_ 1~ ( _P_ ) pour être la le plus petit Naturel Numéro _n_ satisfaisant _n_ · _P_ 1 = _P_ . journal _P_ 1 ( _P_ ) est à plus _q_ − 1.

Laisser __F ~p ~__2 être _ un domaine _F ~p ~_[ _je_ ] _/_ ( _je_ ^2^ + 1). Nous _ définir un Positionner _C2_ ~_~ avec

{empty}(251) _C_ ~2~ ≡ \{ ( _X, Oui_ ) ∈ __F ~p ~__2 × __F ~p ~__2 | _Oui_ ^2^ = _X3_ ^_^ + 3( _je_ + 9) ^− 1^ } ∪ \{ (0 _,_ 0) }

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 24

Nous définir un binaire opération + et scalaire multiplication · avec la même équations link:#_bookmark121[(248),] link:#_bookmark122[(249)] et link:#_bookmark123[(250).] ( _C2 ,_ _ +) est aussi connu pour être un grouper. Nous définir _P2_ _ dans _C2_ _ avec

(252)

_P_ 2 ≡ (11559732032986387107991004021392285783925812861821192530917403151452391805634 × _je_

+10857046999023057135944570762232829481370756359578518086990519993285655852781 _,_

4082367875863433681332203403145435568316851327593401208105741076214120093531 × _je_

+8495653923123431417604973247489272438418190587263600148770280649306958101930)

Nous définir _G_ 2 pour être la sous-groupe de ( _C2 ,_ _ +) généré par _P2_ . _ _G_ 2 est connu pour être la seul cyclique grouper de Commande _q_ sur _C2_ . _ Pour un indiquer _P_ dans _G_ 2 , nous définir journal ~_P_ 2~ ( _P_ ) être la le plus petit Naturel Numéro _n_ satisfaisant _n_ · _P2_ _ = _P_ . Avec cette définition, journal _P_ 2 ( _P_ ) est à plus _q_ − 1.

Laisser _G~ T~_ être la multiplicatif abélien grouper sous-jacent __F ~q ~__12 . Ce est connu que un non dégénéré bilinéaire carte _e_ : _G_ 1 × _G_ 2 → _G T_ existe. Cette application bilinéaire est un appariement de type trois. Il existe plusieurs cartes bilinéaires de ce type, ce n'est pas le cas question qui est choisi pour être _e_ . Laisser _PT __ = _e_ ( _P_ 1 _, P_ 2 ), _un_ être un Positionner de _k_ points dans _G_ 1 , et _b_ être un Positionner de _k_ points dans _G_ 2 . Ce suit depuis la définition de un jumelage que la Suivant sont équivalent

(253)

(254)

[#_bookmark124 .anchor]####log _P_ 1 _ ( _un_ ~1~ ) × log _P_ 2 _ ( _b_ ~1~ ) + · · · + log _P_ 1 _ ( _un ~k ~_) × log _P_ 2 _ ( _bk_ ) _~_~_ ≡ 1 mod _ _ _q_
____

_k_

____
_e_ ( _un je , b je_ ) = _PT __

_je_ =0

Ainsi la jumelage opération fournit un méthode pour Vérifier link:#_bookmark124[(253).]

UN 32 octet Numéro *X* ∈ *P256* _ pourrait et pourrait ne pas représenter un élément de _Fp_ . _

{empty}(255) _δ_ ( *x* ) ≡ f *x* si *X* _< p_

∅ autrement

UN 64 octet Les données *X* ∈ *B* 512 pourrait et pourrait ne pas représenter un élément de _G_ 1 .

(256)

_δ_ ( *x* ) ≡ f _g_ 1 si _g_ 1 ∈ _G_ 1

(257)

∅ sinon
____

[loweralpha, start=7]
. ( _x, y_ ) si _X_ = ∅ ∧ _y_ ∅

____
∅ sinon

{empty}(258) _x_ ≡ _δ_ p ( *x* [0 _.._ 31])

{empty}(259) _y_ ≡ _δ_ p ( *x* [32 _.._ 63])

UN 128 octet Les données *X* ∈ *B* 1024 pourrait et pourrait ne pas représenter un élément de _G_ 2 .

(260)

_δ_ ( *x* ) ≡ f _g_ 2 si _g_ 2 ∈ _G_ 2

(261)

∅ sinon

_g_ (( _x_ 0 _je_ + _y_ 0 ) _,_ ( _x_ 1 _je_ + _y_ 1 )) si _x_ 0 = ∅ ∧ _y_ 0 = ∅ ∧ _x1_ _

∅ sinon

∅ ∧ _y_ 1 = ∅
____

[width="100%",cols="33%,27%,8%,32%",options="header",]
|===
a|
____
(262)
____

|_x_ 0 a|
____
≡
____

a|
____
_δ_ p ( *x* [0 _.._ 31])
____

a|
____
(263)
____

|_y_ 0 a|
____
≡
____

a|
____
_δ_ p ( *x* [32 _.._ 63])
____

a|
____
(264)
____

|_x1_ _ a|
____
≡
____

a|
____
_δ_ p ( *x* [64 _.._ 95])
____

a|
____
(265)
____

|_y_ 1 a|
____
≡
____

a|
____
_δ_ p ( *x* [96 _.._ 127])
____

|===

____
Nous définir Ξ SNARKV comme un précompilé Contrat qui chèques si link:#_bookmark124[(253)] tient, pour prévu utiliser dans zkSNARK vérification.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 25
____

[arabic, start=266]
. Ξ SNARKV ≡ Ξ PRÉ à l'exception:
. Ξ SNARKV ( _*σ* , g, UN, je_ ) = ( ∅ _,_ 0 _, UN,_ ()) si _F_
. {blank}
. {blank}
. {blank}
. {blank}
. {blank}
. {blank}
. {blank}
. {blank}
. {blank}

____
_F_ ≡ ( ll _je_ *~d~* ll mod _ _ 192 = 0 ∨ ( ∃ _j. un_ ~j~ = ∅ ∨ _b_ ~j~ = ∅ ))

_k_ = +++ll _je_ *~d~* ll+++

192

_g_ r = 34000k ___ + 45000

*o* [0 _.._ 31] 0 _x_ 0000000000000000000000000000000000000000000000000000000000001 si _v_ ∧ ¬F ___

0 _x_ 00000000000000000000000000000000000000000000000000000000000000 si ¬ _v_ ∧ ¬ _F_

_v_ ≡ ( log _P_ 1 ( _un_ ~1~ ) × log _P_ 2 _ ( _b_ ~1~ ) + · · · + log _P_ 1 _ ( _un ~k ~_) × log _P_ 2 _ ( _bk_ ) _~_~_ ≡ 1 mod _ _ _q_ ) _une_ ~1~ ≡ _δ_ ~1~ ( _I_ *~d~* [0 _.._ 63])

_b_ ~1~ ≡ _δ_ ~2~ ( _I_ *~d~* [64 _.._ 191])

.

_un ~k~_ ≡ _δ_ ~1~ ( _je_ *~ré~* [( ll _je_ *~ré~* ll − 192) _.._ ( ll _je_ *~d~* ll − 129)])

_b ~k~_ ≡ _δ_ ~2~ ( _je_ *~ré~* [( ll _je_ *~ré~* ll − 128) _.._ ( ll _je_ *~d~* ll − 1)])

Nous définir un précompilé Contrat pour une addition sur _G_ 1 .
____

[arabic, start=277]
. (277)
. {blank}
. {blank}
. {blank}
. {blank}
. {blank}
. {blank}

____
[#_bookmark125 .anchor]####ΞBN _ AJOUTER ≡ ΞBN _ PRÉ à l'exception:

ΞBN _ AJOUTER ( _*σ* , g, UN, je_ ) = ( ∅ _,_ 0 _, UN,_ ()) si _X_ = ∅ ∨ _y_ = ∅

_g_ r = 150

*o* ≡ _δ_ − 1 ( _x_ + _y_ ) où + est la grouper op ération _ dans _G_ 1 _x δ_ ~1~ _Je_ ¯ *d* [0 _.._ 63]

_y_ ≡ _δ_ ~1~ _je_ ¯ *d* [64 _.._ 127]

*ré*

0 sinon

Nous _ définir un précompilé contrat _ _ pour scalaire m ultiplication sur _G_ ~1~ , où _je_ ¯ *d* est défini _ dans link:#_bookmark125[(283).]
____

[arabic, start=284]
. {blank}
. {blank}
. {blank}
. {blank}
. {blank}

____
ΞBN _ MU ≡ Ξ PRÉ à l'exception:

ΞBN _ MUL ( _*σ* , g, UN, je_ ) = ( ∅ _,_ 0 _, UN,_ ()) si _X_ = ∅

_g_ r = 6000

*o* ≡ _δ_ − 1 ( _n_ · _x_ ) où · est la scalaire m ultiplication dans _G 1x_ _ ≡ _δ_ ~1~ _Je_ ¯ *d* [0 _.._ 63]

{empty}(289) _n_ ≡ _Je_ ¯ *d* [64 _.._ 95]
____

[arabic]
. *BLAKE2 Précompilé Contrat.* EIP-152 par link:#_bookmark104[Hess et al.] link:#_bookmark104[[2016]] définit Ξ BLAKE2 F sous forme de contrat pré-compilé implémentant la fonction de compression F utilisée dans l'algorithme de hachage cryptographique BLAKE2. La compression F une fonction est spécifié dans RFC 7693 par link:#_bookmark92[Saarinen et Aumasson [2015].]

____
(290)

(291)

(292)

(293)

Ξ BLAKE2 F ≡ Ξ PRE à l'exception:

Ξ ~BLAKE2~ ~F~ ( _*σ* , g, UN, je_ ) = ( ∅ _,_ 0 _, UN,_ ()) si ll _je_ *~d~* ll =
____

_g_ r = _r_

____
*o* ≡ LE ~8~ ( _h_ ~0~ ) · _..._ · LE ~8~ ( _h_ ~7~ )

213 ∨ _F_ ∈ _/_ \{ 0 _,_ 1 }
____

[width="100%",cols="20%,25%,5%,50%",options="header",]
|===
a|
____
(294)
____

|( _h_ ~0~ _, . . . , h_ ~7~ ) a|
____
≡
____

a|
____
F ( _h, moi, t_ ~bas~ _, t_ ~élevé~ _, F_ ) avec _r_ Les manches et _w_ = 64
____

a|
____
(295)
____

|BE 4 ( _r_ ) a|
____
≡
____

a|
____
_Je_ *~d~* [0 _.._ 4]
____

a|
____
(296)
____

|LE 8 ( _h_ 0 ) a|
____
≡
____

a|
____
_Je_ *~d~* [4 _.._ 12]
____

a|
____
(297)
____

| a|
____
_. . ._
____

|
a|
____
(298)
____

|LE 8 ( _h_ 7 ) a|
____
≡
____

a|
____
_Je_ *~d~* [60 _.._ 68]
____

a|
____
(299)
____

|LE 8 ( _m_ 0 ) a|
____
≡
____

a|
____
_je_ [68 *~..~* _76_ ]
____

a|
____
(300)
____

| a|
____
_. . ._
____

|
a|
____
(301)
____

|LE 8 ( _m_ 15 ) a|
____
≡
____

a|
____
_Je_ *~d~* [188 _.._ 196]
____

a|
____
(302)
____

|LE ~8~ ( _t_ ~faible~ ) a|
____
≡
____

a|
____
_Je_ *~d~* [196 _.._ 204]
____

a|
____
(303)
____

|LE 8 ( _t_ élevé ) a|
____
≡
____

a|
____
_Je_ *~d~* [204 _.._ 212]
____

a|
____
(304)
____

|_F_ a|
____
≡
____

a|
____
_je [_ *~212~* ]
____

|===

____
ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 26

où _r_ ∈ B ~32~ , ∀ _je_ ∈ 0 _.._ 7 : _h ~je~_ ∈ B ~64~ , ∀ _je_ ∈ 0 _.._ 15 : _m ~je~_ ∈ B ~64~ , _t_ ~faible~ ∈ B ~64~ , _t_ ~élevé~ ∈ B ~64~ , _f_ ∈ B ~8~ , BE _~k~_ est le _k_ -octet big-endian représentation—comparer link:#_bookmark115[avec(193):]

_k_ - 1

{empty}(305) BE _~k~_ ( _x_ ) ≡ ( _b_ ~0~ _, b_ ~1~ _, ..., b ~k ~_~- 1~ ) : _X_ = _b ~n~_ · 256 ^−^ ^−^

_n_ =0

et LE _~k~_ est la _k_ -octet petit endian représentation:

_k_ - 1

{empty}(306) LE _~k~_ ( _x_ ) ≡ ( _b_ ~0~ _, b_ ~1~ _, ..., b ~k ~_~- 1~ ) : _X_ = _b ~n~_ · 256 _^n^_

_n_ =0

[#Appendix_F._Signing_Transactions .anchor]####annexe F. Signature Transactions

Les transactions sont signées à l'aide de signatures ECDSA récupérables. Cette méthode utilise la courbe SECP-256k1 comme décrit par link:#_bookmark84[Courtois et Al. [2014],] et est mis en œuvre De même pour comme décrit par link:#_bookmark99[Goura et Al.] [ link:#_bookmark99[2004]] sur p. 9 de 15, para. 3.

Ce est assumé que la expéditeur possède un valide privé clé _p_ r , qui est un au hasard choisi positif entier (représentée comme un octet déployer de longueur 32 dans big-endian formulaire) dans la Portée [1 _,_ secp256k1n − 1].

Nous présumer la existence de les fonctions ECDSAPUBKEY , ECDSASIGN et ECDSARECOVER . Celles-ci sont officiellement défini dans la

Littérature, par exemple par link:#_bookmark108[Johnson et Al. [2001].]

(307)

(308)

(309)

ECDSAPUBKEY ( _p_ r ∈ B 32 ) ≡ _p_ tu ∈ B 64

ECDSASIGN ( _e_ ∈ B 32 _, p_ r ∈ B 32 ) ≡ ( _v_ ∈ B 1 _, r_ ∈ B 32 _, s_ ∈ B 32 )

ECDSARECOVER ( _e_ ∈ B 32 _, v_ ∈ B 1 _, r_ ∈ B 32 _, s_ ∈ B 32 ) ≡ _p_ tu ∈ B 64

Où _tu_ es est la clé publique, supposée être un tableau d'octets de taille 64 (formé de la concaténation de deux entiers chaque _<_ 2 ^256^ ), _p_ r est la privé clé, un octet déployer de Taille 32 (ou alors un Célibataire positif entier dans la susmentionné Portée) et _e_ est la hacher de la transaction, link:#_bookmark130[_h_ ( _T_] ). Ce est assumé que [#_bookmark127 .anchor]##_v_ est la 'récupération identifiant'. Le récupération identifiant

est une valeur de 1 octet spécifiant la parité et la finitude des coordonnées du point de courbe pour lequel _r_ est la valeur x ; cette la valeur est dans la plage de [0 _,_ 3], cependant nous déclarons les deux possibilités supérieures, représentant des valeurs infinies, invalides. Le valeur 0 représente un même _y_ valeur et 1 représente un étrange _y_ valeur.

Nous déclarer que un ECDSA Signature est invalide sauf si tout la Suivant conditions sont vrai:

(310)

(311)

(312)

où: (313)

0 _<_[#_bookmark128 .anchor]## [#_bookmark129 .anchor]##_r <_ secp256k1n

0 _< s <_ secp256k1n ÷ 2 + 1

link:#_bookmark127[_v_] ∈ \{ 0 _,_ 1 }

secp256k1n = 115792089237316195423570985008687907852837564279074904382605163141518161494337

Pour un donné privé clé, _p_ r , la Ethereum adresse _A_ ( _p_ r ) (un 160 bits valeur) pour qui ce correspond est défini comme la le plus à droite 160 bits de la Keccak-256 hacher de la correspondant ECDSA Publique clé:

{empty}(314) _A_ ( _p_ r ) = [#_bookmark130 .anchor]####B 96 _.._ 255 KEC ECDSAPUBKEY ( _p_ r )

Le message hacher, _h_ ( _T_ ), pour être signé est la Keccak-256 hacher de la transaction. Trois différent les saveurs de signature régimes sont disponible:

(315)

_LX_ ( _T_ _ ) ≡

où

( _T_ n _, T_ p _, T_ g _, T_ t _, Télé ,_ _ *p* ) si _T_ x = 0 ∧ _T_ w ∈ \{ 27 _,_ 28 }

( _T_ n _, T_ p _, T_ g _, T_ t _, Télé ,_ _ *p* _, β,_ () _,_ ()) si _T_ x = 0 ∧ _T_ w ∈ \{ 2 _β_ + 35 _,_ 2 _β_ + 36 }

 ( _T_ ~c~ _, T_ ~n~ _, T_ ~p~ _, T_ ~g~ _, T_ ~t~ _, Télé ,_ ~_~ *p* _, T_ *~A~* ) si _T_ ~x~ = 1

(316)

*p* _T_ *~je~* si _T_ ~t~ = ∅

_T_ *~d~* autrement
____

_h_ ( _T_ ) KEC ( RLP ( _L_ X ( _T_ ))) si _T_ x = 0

KEC ( _T_ x · RLP ( _L_ X ( _T_ ))) autrement

____
Le signé transaction _G_ ( _T, p_ r ) est défini comme: (317)

_G_ ( _T, p_ r ) ≡ _T_ sauf :

(318)

link:#_bookmark8[Réitérant depuis précédemment:] (319)

(320)

( _T_ y _, T_ r _, Ts_ ) _ = ECDSASIGN ( _h_ ( _T_ ) _, p_ r )

_T_ r = _link:#_bookmark128[r] Ts_ _ = link:#_bookmark129[_s_]

et link:#_bookmark11[_T_ w] de héritage transactions est Soit 27 + _T_ y ou alors 2 link:#_bookmark1[_β_] + 35 + _T_ y .

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 27
____

[width="100%",cols="17%,83%",options="header",]
|===
a|
____
Nous mai alors définir la expéditeur une fonction _S_ de la transaction comme:
____

|
a|
____
(321)
____

a|
____
_S_ ( _T_ ) ≡ B 96 _.._ 255 KEC ECDSARECOVER ( _h_ ( _T_ ) _, v, T_ r _, Ts_ ) _
____

a|
____
(322)
____

a|
____
   _T_ w − 27 si _T_ x = 0 ∧ _T_ w ∈ \{ 27 _,_ 28 }

_v_ ≡ ( _T_ w − 35) mode 2 si _T_ x = 0 ∧ _T_ w ∈ \{ 2 _β_ + 35 _,_ 2 _β_ + 36 }

  _T_ y si _T_ x = 1
____

a|
____
Le affirmation que la expéditeur de un signé transaction équivaut à la adresse de la signataire devrait être va de soi :

(323 _)_ ∀T : ∀ _p_ r : _S_ ( _G_ ( _T , p_ r )) ≡ _A_ ( _p_ r )

[#Appendix_G._Fee_Schedule .anchor]####annexe G. Frais Programme

Le frais programme _g_ est un tuple de scalaire valeurs correspondant pour la relatif frais, dans gaz, de un Numéro de abstrait opérations que un transaction mai effet.
____

|
|===

[width="100%",cols="16%,6%,78%",options="header",]
|===
a|
____
Nom
____

|Valeur a|
____
La description
____

a|
____
_G_ zéro
____

|0 a|
____
Rien payé pour opérations de la Positionner _W_ zéro .
____

a|
____
_G_ jumpdest
____

|1 a|
____
Montant de gaz pour Payer pour un JUMPDEST opération.
____

a|
____
Base _G_
____

|2 a|
____
Montant _ _ de gaz pour payer _ _ pour op érations _ de la ensemble _ _ _W_ ~base e~ .
____

a|
____
_Sol_ très bas
____

|3 a|
____
Montant _ _ de gaz pour payer _ _ pour op érations _ de la ensemble _ _ _W_ ~très bas~ . ~_ _~
____

a|
____
_sol_ bas
____

|5 a|
____
Montant de gaz pour Payer pour opérations de la Positionner _W_ ~faible~ .
____

a|
____
_sol_ moyen
____

|8 a|
____
Montant _ _ de gaz pour payer _ _ pour op érations _ de la ensemble _ _ _W_ ~mi d~ .
____

a|
____
_Sol_ aigu
____

|dix a|
____
Montant _ _ de gaz pour payer _ _ pour op érations _ de la Positionner _W_ ~haut h~ .
____

a|
____
_G_ warmaccess
____

|100 a|
____
Coût de un chauffer Compte ou alors stockage accéder.
____

a|
____
[#_bookmark132 .anchor]####Adresse de la liste d'accès _G_
____

|2400 a|
____
Coût de échauffement en haut un Compte avec la accéder liste.
____

a|
____
[#_bookmark133 .anchor]####Stockage des listes d'accès _G_
____

|1900 a|
____
Coût de échauffement en haut un stockage avec la accéder liste.
____

a|
____
_G_ coldaccountacces
____

|2600 a|
____
Coût de un du froid Compte accéder.
____

a|
____
_G_ charge froide
____

|2100 a|
____
Coût de un du froid stockage accéder.
____

a|
____
_G_ sset
____

|20000 a|
____
Payé pour un STORE opération lorsque la stockage valeur est Positionner pour non nul depuis zéro.
____

a|
____
_G_ sréinitialiser
____

|2900 a|
____
Payé pour un STORE opération lorsque la stockage valeurs le zéro restes inchangé ou alors est Positionner pour zéro.
____

a|
____
_R_ clair
____

|15000 a|
____
Rembourser donné (ajoutée dans rembourser compteur) lorsque la stockage valeur est Positionner pour zéro depuis

non nul.
____

a|
____
_R_ autodestruction
____

|24000 a|
____
Rembourser donné (ajoutée dans rembourser compteur) pour autodestructeur un Compte.
____

a|
____
_G_ autodestruction
____

|5000 a|
____
Montant de gaz pour Payer pour un AUTO-DESTRUCTION opération.
____

a|
____
_G_ créer
____

|32000 a|
____
Payé pour un CRÉER opération.
____

a|
____
Dépôt de code _G_
____

|200 a|
____
Payé par octet pour un CRÉER opération pour réussir dans placement code dans Etat.
____

a|
____
Valeur d'appel _G_
____

|9000 a|
____
Payé pour un non nul valeur transférer comme partie de la APPEL opération.
____

a|
____
[#_bookmark134 .anchor]####Allocation d'appel _G_
____

|2300 a|
____
UN traitement pour la appelé Contrat soustrait depuis ~Valeur d'appel~ _G_ pour un non nul valeur transférer.
____

a|
____
_G_ nouveau compte
____

|25000 a|
____
Payé pour un APPEL ou alors AUTO-DESTRUCTION opération qui crée un Compte.
____

a|
____
_G_ exp
____

|dix a|
____
Partiel Paiement pour un EXP opération.
____

a|
____
_G_ expbyte
____

|50 a|
____
Partiel Paiement lorsque multiplié par la Numéro de octets dans la exposant pour la EXP opération.
____

a|
____
Mémoire _G_
____

|3 a|
____
Payé pour tous Additionnel mot lorsque expansion Mémoire.
____

a|
____
[#_bookmark135 .anchor]##_G_ txcreate
____

|32000 a|
____
Payé par tout création de contrat transactions après la _Propriété_ passage.
____

a|
____
[#_bookmark136 .anchor]##_G_ txdatazero
____

|4 a|
____
Payé pour tous zéro octet de Les données ou alors code pour un transaction.
____

a|
____
[#_bookmark137 .anchor]##_G_ txdatanonzero
____

|16 a|
____
Payé pour tous non nul octet de Les données ou alors code pour un transaction.
____

a|
____
[#_bookmark138 .anchor]####transaction__ G__
____

|21000 a|
____
Payé pour tous transaction.
____

a|
____
Journal _G_
____

|375 a|
____
Partiel Paiement pour un JOURNAL opération.
____

a|
____
Données de journal _G_
____

|8 a|
____
Payé pour chaque octet dans un JOURNAL l'opération Les données.
____

a|
____
Sujet de journal _G_
____

|375 a|
____
Payé pour chaque sujet de un JOURNAL opération.
____

a|
____
_G_ keccak256
____

|30 a|
____
Payé pour chaque KECCAK256 opération.
____

a|
____
_G_ keccak256word
____

|6 a|
____
Payé pour chaque mot (arrondi en haut) pour saisir Les données pour un KECCAK256 opération.
____

a|
____
Copie _G_
____

|3 a|
____
Partiel Paiement pour *COPIE opérations, multiplié par mots copié, arrondi en haut.
____

a|
____
_G_ bloc de hachage
____

|20 a|
____
Paiement pour chaque BLOCHASH opération.
____

|===

____
[#Appendix_H._Virtual_Machine_Specificatio .anchor]####annexe H Virtuel Machine spécification

Lorsque interprétant 256 bits binaire valeurs comme entiers, la représentation est big-endian.

Lorsqu'une donnée machine 256 bits est convertie vers et à partir d'une adresse ou d'un hachage 160 bits, la droite (ordre inférieur pour BE) 20 octets sont utilisés et les 12 les plus à gauche sont ignorés ou remplis de zéros, ainsi les valeurs entières (lorsque les octets sont interprété comme big-endian) sont équivalent.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 28
____

[arabic]
. *Gaz Coût.* Le général gaz Coût une fonction, _C_ , est défini comme:

____
(324)

_C_ ( _*σ* , *µ* , UN, je_ ) ≡ _C_ mém ( *_µ_* i ) − _C_ mém ( *_µ_* ~i~ ) +

_C_ SSTORE ( _*σ* , *µ* , UN, je_ ) si _w_ = STORE

_G_ exp si _w_ = EXP ∧ *_µs [_ ~1 ~*] = 0

_G_ ~exp~ + _G_ ~expoctet~ × (1 + l log 256 ( *_µ_ s* [1]) J ) si _w_ = EXP ∧ *_µs [_ 1* ] _>_ 0 _Sol_ ~très bas~ + ~Copie~ _G_ × r *_µs_ [* 2] ÷ 32 1 si _w_ ∈ _W_ ~copie~ _C_ aaccès ( *_µ_ ~s ~*[0] mode 2 ^160^ _, A_ ) + Copie _G_ × r **_µs_ ~[ ~**3] ÷ 32 1 si _w_ = EXTCODECOPIE _C_ aaccès ( *_µ_ s* [0] mode 2 160 _, A_ ) si _w_ ∈ _W_ excompte

~Journal~ _G_ + ~Données de journal~ _G_ × *_µs [_ 1* ] si _w_ = LOG0

Journal _G_ + Données de journal _G_ × *_µs [_ 1* ] + _G_ logtopic si _w_ = LOG1

Journal _G_ + Données de journal _G_ × *_µs [_ 1* ] + 2 _G_ logtopic si _w_ = LOG2

Journal _G_ + Données de journal _G_ × *_µs [_ 1* ] + 3 _G_ logtopic si _w_ = LOG3

Journal _G_ + Données de journal _G_ × *_µs [_ 1* ] + 4 _G_ logtopic si _w_ = LOG4

_C_ ~APPEL~ ( _*σ* , *µ* , A_ ) si _w_ ∈ _W_ ~appel~

_C_ AUTODESTRUCTION ( _*σ* , *µ *_) si _w_ = AUTO-DESTRUCTION

_G_ créer si _w_ = CRÉER

_G_ créer + _G_ keccak256word × r *_µs_ [* 2] ÷ 32 1 si _w_ = link:#_bookmark150[CRÉER2] _G_ keccak256 + _G_ keccak256word × r *_µs [_ 1* ] ÷ 32 1 si _w_ = KECCAK256 _G_ jumpdest si _w_ = JUMPDEST

_C_ SLOAD ( _*µ* , A, I_ ) si _w_ = SLOAD

_G_ zéro si _w_ ∈ _W_ zéro

Base _G_ si _w_ ∈ socle en _W_

_G_ très faible si _w_ ∈ _W_ très bas

_G_ bas si _w_ ∈ _W_ faible

_G_ mi si _w_ ∈ _W_ mi

_G_ élevé si _w_ ∈ _W_ haut
____

 _G_ blockhash si _w_ = link:#_bookmark144[BLOCHASH]

[arabic, start=325]
. _w je_ *~b~* [ *_µ_* pc ] si *_µpc_* _ _<_ ll _je_ *~b~* ll

ARRÊTER sinon

____
où:
____

[arabic, start=326]
. _C_ mém ( _un_ ) ≡ Mémoire _G_ · _un_ +

____
_un_ 2

512
____

[arabic, start=327]
. [#_bookmark140 .anchor]##_C_

un accès

( _x, A_ ) _G_ warmaccess si _x_ ∈ link:#_bookmark39[_Un_ *un*] _G_ coldaccountacces autrement

____
avec _C_ CALL , _C_ SELFDESTRUCT , _C_ SLOAD et _C_ SSTORE comme spécifié dans la section appropriée ci-dessous. Nous définissons ce qui suit sous-ensembles de des instructions:

_W_ zéro = \{ ARRÊTER , RETOUR , RETOUR }

~socle en~ _W_ = \{ ADRESSE , ORIGINE , APPELANT , CALLVALUE , CALLDATASIZE , CODESIZE , GASPRICE , COINBASE , Horodatage , NOMBRE , DIFFICULTE , LIMITE DE GAZ , CHAINID , RETURNDATASIZE , POP , PC , TAILLE , GAZ }

_W_ ~très bas~ = \{ AJOUTER , SOUS , PAS , LT , GT , SLT , SGT , égaliseur , ISZÉRO , ET , OU , XOR , OCTET , SHL , SHR , RAS , CALLDATALOAD , CHARGEMENT , MSTORE , MSTORE8 , POUSSER* , DUP* , ÉCHANGE* }

_W_ ~bas~ = \{ MUL , DIV , SDIV , MOD , SMOD , SIGNEXTEND , ÉQUILIBRE AUTONOME }

_W_ ~mi~ = \{ ADDMOD , MULMOD , SAUT }

_W_ ~élevé~ = \{ JUMPI }

_W_ copie = \{ CALLDATACOPY , CODECOPIE , RENVOYER UNE COPIE } _W_ ~appel~ = \{ APPEL , CODE APPEL , DELEGATECALL , STATICCALL } _W_ excompte = \{ ÉQUILIBRE , EXTCODETAILLE , EXTCODEHACHE }

Notez le composant de coût de la mémoire, donné comme le produit de la mémoire _G_ et du maximum de 0 et du plafond du nombre nombre de mots en taille que la mémoire doit dépasser du nombre de mots courant, *_µ_* i pour que tous les accès référencent valide Mémoire qu'il s'agisse pour lis ou alors écrivez. Tel accède doit être pour non nul Numéro de octets.

Référencement un zéro longueur Portée (par exemple par tenter pour passer ce comme la saisir Portée pour un APPEL) Est-ce que ne pas exiger Mémoire pour être élargi pour la début de la Portée. *_µ_* je est défini comme cette Nouveau maximum Numéro de mots de actif Mémoire; cas spéciaux sont donné où celles-ci deux sont ne pas égal.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 29

Notez également que _C_ mem est la fonction de coût mémoire (la fonction d'expansion étant la différence entre le coût avant et après). C'est un polynôme, avec le coefficient d'ordre supérieur divisé et plancher, et donc linéaire jusqu'à 724B de mémoire utilisé, après qui ce frais substantiellement Suite.

Tandis que définir la instruction Positionner, nous défini la extension de mémoire pour Portée une fonction, _M_ , Donc:
____

[arabic, start=328]
. _M_ ( _s, F, l_ ) _s_ si _je_ = 0 max( _s,_ r ( _f_ + _l_ ) ÷ 32 1 ) autrement

____
Une autre utile une fonction est "tout mais une 64e » une fonction _L_ défini comme:

{empty}(329) [#_bookmark141 .anchor]##_L_ ( _n_ ) ≡ _n_ − l _n/_ 64 J
____

[arabic]
. [#H.2._Instruction_Set .anchor]##*Jeu d'instructions.* Comme précisé précédemment dans la section link:#9._Execution_Model[9,] ces définitions prennent place dans le contexte final ici. Dans particulier nous présumer _O_ est la EVM progression d'état une fonction et définir la termes se rapportant pour la suivant cycle Etat ( _*σ* , *µ *_) tel que:

____
{empty}(330) _O_ ( _*σ* , *µ* , UN, je_ ) ≡ ( _*σ* , *µ* , UN , je_ ) avec exceptions, comme c'est noté

Voici les différentes exceptions aux règles de transition d'état données dans la section link:#9._Execution_Model[9] spécifiées pour chaque instruction, ainsi que les définitions supplémentaires spécifiques aux instructions de _J_ et _C._ _ Pour chaque instruction, est également spécifié _α_ , le Additionnel éléments mis sur la pile et _δ_ , la éléments supprimé depuis pile, comme défini dans section link:#9._Execution_Model[9.]

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 30
____

== 0 : Arrêt et Arithmétique Opérations

____
Tout arithm e tic est moi dulo _ 2 ^256^ sauf si sinon _ c'est noté. Le zéro-ième puissance _ _ _ de zéro 0 ^0^ est défini _ pour être _ une.
____

== Valeur Mnémonique _δ α_ La description

____
[#_bookmark143 .anchor]####0x00 ARRÊTER 0 0 Arrêts exécution.

0x01 AJOUTER 2 1 Une addition opération.

*_µs [_ 0* ] ≡ *_µs [_ 0* ] + *_µs [_ 1* ]

0x02 MU 2 1 Multiplication opération.

*_µs [_ 0* ] ≡ *_µs [_ 0* ] × *_µs [_ 1* ]

0x03 SOUS 2 1 Soustraction opération.

*_µs [_ 0* ] ≡ *_µs [_ 0* ] − *_µs [_ 1* ]

0x04 DIV 2 1 Entier division opération.
____

0 si *_µs [_ 1* ] = 0

____
*s*

lµs *_[_ 0* ] ÷ *_µs [_ 1* ] J autrement

0x05 SDIV 2 1 Signé entier division opération (tronqué).

  *sgn* ( *_µ_ s* [0] ÷ *_µs_* [1]) *l* | *_µs [_ 0* ] ÷ *_µs [_ 1* ] |J autrement

Où tout valeurs sont traité comme deux complément signé 256 bits entiers. Noter la débordement _ _ _ _ séma ntique _ lorsque − 2 ^255^ est nier d.

0x06 MOD 2 1 Modulo reste opération.

*_µ_* [0] ≡ 0 si *_µs [_ 1* ] = 0

0x07 SMOD 2 1 Signé modulo reste opération.

*_µ_* [0] ≡ 0 si *_µs [_ 1* ] = 0

*sg* ( *_µ_* [0])( | *_µ_* [0] | mode | *_µ_* [1] | ) autrement

Où tout valeurs sont traité comme deux complément signé 256 bits entiers.

0x08 ADDMOD 3 1 Modulo une addition opération.

*_µ_* [0] ≡ 0 si *_µs_ [* 2] = 0

Tout intermédiaire calculs de cette opération sont ne pas matière pour la 2 ^256^ modulo.

0x09 MULMOD 3 1 Modulo multiplication opération.

*_µ_* [0] ≡ 0 si *_µs_ [* 2] = 0

( *_µ_* [0] × *_µ_* [1]) mode *_µ_* [2] autrement

Tout intermédiaire calculs de cette opération sont ne pas matière pour la 2 ^256^ modulo.

0x0a EXP 2 1 Exponentiel opération.

*_µ_* [0] ≡ *_µ_* [0] *_^µs [^_ 1* ]

0x0b SIGNEXTEND 2 1 Étendre longueur de deux complément signé entier.
____

∀ _je_ ∈ [0 _.._ 255] : *_µ_* [0]

____
≡ fµs *_[_ ~1 ~*] t si _je_ _t_ où _t_ = 256 − 8( *_µs [_ ~0 ~*] + 1)

*_µ_ ~s ~*[ _x_ ] je donne la _je_ th bit (compte depuis zéro) de *_µs_* [ _x_ ] *~_~*

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 31
____

== 10s : Comparaison & Au niveau du bit Logique Opérations

____
*_µ_* [0] ≡ f 1 si *_µs [_ 0* ] _< *µs [ *_*1* ]

0x11 GT 2 1 Plus grand que comparaison.

*_µ_* [0] ≡ 1 si *_µs [_ 0* ] _> *µs [ *_*1* ]

0x12 PS 2 1 Signé moins que comparaison.

*_µ_* [0] ≡ 1 si *_µs [_ 0* ] _< *µs [ *_*1* ]

Où tout valeurs sont traité comme deux complément signé 256 bits entiers.

0x13 SGT 2 1 Signé plus grand que comparaison.

*_µ_* [0] ≡ 1 si *_µs [_ 0* ] _> *µs [ *_*1* ]

Où tout valeurs sont traité comme deux complément signé 256 bits entiers.

0x14 EQ 2 1 Égalité comparaison.

*_µ_* [0] ≡ 1 si *_µs [_ 0* ] = *_µs [_ 1* ]

0x15 ISZÉRO 1 1 Simple ne pas opérateur.

*_µ_* [0] ≡ 1 si *_µs [_ 0* ] = 0

0x16 ET 2 1 Au niveau du bit ET opération.

∀ _je_ ∈ [0 _.._ 255] : *_µs [_ ~0 ~*] je ≡ *_µs [_ ~0 ~*] je ∧ *_µs [_ ~1 ~*] je

0x17 OU 2 1 Au niveau du bit OU ALORS opération.

∀ _je_ ∈ [0 _.._ 255] : *_µs [_ ~0 ~*] je ≡ *_µs [_ ~0 ~*] je ∨ *_µs [_ ~1 ~*] je

0x18 OU exclusif 2 1 Au niveau du bit XOR opération.

∀ _je_ ∈ [0 _.._ 255] : *_µs [_ ~0 ~*] je ≡ *_µs [_ ~0 ~*] je ⊕ *_µs [_ ~1 ~*] je

0x19 PAS 1 1 Au niveau du bit NE PAS opération.

∀ _je_ ∈ [0 _.._ 255] : *_µs [_ ~0 ~*] je

1 si *_µs [_ ~0 ~*] je = 0

0 autrement

0x1a OCTET 2 1 Récupérer Célibataire octet depuis mot.

∀ _je_ ∈ [0 _.._ 255] : *_µs [_ ~0 ~*] je

*_µ_ s* [1] ~( _je_ − 248+8 *_µ _*~*s* [0]) si _je_ ≥ 248 ∧ *_µs [_ 0* ] _<_ 32

0 sinon

Pour la Nième octet, nous compter depuis la la gauche (c'est à dire N=0 voudrais être la plus important dans gros endien).
____

[width="100%",cols="9%,9%,6%,76%",options="header",]
|===
|0x1b a|
____
SHL
____

|2 a|
____
1 La gauche changement opération.

*_µ_* [0] ≡ ( *_µ_* [1] × 2 *_^µs [^_ 0* ] ) mode 2 ^256^

*s s*
____

|0x1c a|
____
SHR
____

|2 a|
____
1 Logique à droite changement opération.

*_µ_* [0] ≡ l *_µ_* [1] ÷ 2 *_^µs [^_ 0* ] J

*s s*
____

|0x1d a|
____
DAS
____

|2 a|
____
1 Arithmétique (signé) à droite changement opération.
____

|===

____
*_µ_* [0] ≡ *_lµ_* [1] ÷ 2 *_^µs [^_ 0* ] J

Où *_µs [_ 0* ] et *_µs [_ 1* ] sont traité comme deux complément signé 256 bits entiers, pendant que *_µs [_ 0* ] est traité comme non signé.
____

== 20 s : KECCAK256

[width="100%",cols="12%,23%,5%,60%",options="header",]
|===
|*Valeur* a|
____
*Mnémonique* _δ_
____

|_α_ a|
____
*La description*
____

|0x20 a|
____
KECCAK256 2
____

a|
____
1
____

a|
____
Calculer Keccak-256 hacher.

*_µs [_ 0* ] ≡ KEC ( *_µ_ m* [ *_µ_ s* [0] _. . ._ ( *_µs [_ 0* ] + *_µs [_ 1* ] − 1)])

*_µ_* je ≡ _M_ ( *_µ_* je _, *µs [ *_*0* ] _, *µs [ *_*1* ])
____

|===

____
ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 32

∀ _je_ ∈ \{ 0 _. . . *µ *_[2] − 1 } : *_µ_*

[ *_µ_* [0] + _je_ ] ≡ f _je_ *~d~* [ *_µs [_ 1* ] + _je_ ] si *_µs [_ 1* ] + _je <_ ll _je_ *~d~* ll

Le ajouts dans *_µ_* [1] + _je_ sont ne pas matière pour la 2 ^256^ modulo.

*_µ_* je ≡ _M_ ( *_µ_* je _, *µs [ *_*0* ] _, *µs *_*[* 2])

Cette se rapporte pour la saisir Les données passé avec la message appel instruction

ou alors transaction.

0x38 CODETAILLE 0 1 Avoir Taille de code course dans courant environnement.

*_µs [_ 0* ] ≡ ll _je_ *~b~* ll

0x39 CODECOPIE 3 0 Copie code course dans courant environnement pour Mémoire.

∀ _je_ ∈ \{ 0 _. . . *µ *_[2] − 1 } : *_µ_*

[ *_µ_* [0] + _je_ ] ≡ f _je_ *~b~* [ *_µs [_ 1* ] + _je_ ] si *_µs [_ 1* ] + _je <_ ll _je_ *~b~* ll
____

*s m s*

____
*_µ_* je ≡ _M_ ( *_µ_* je _, *µs [ *_*0* ] _, *µs *_*[* 2])

ARRÊTER sinon

Le ajouts dans *_µ_* [1] + _je_ sont ne pas matière pour la 2 ^256^ modulo.
____

*_µs [_ 0* ] ≡

____
160

*s*

0 sinon

où CEC ( *b* ) ≡ *_σ_* [ *_µ_* [0] mod _ _ 2 ^16 0^ ] c

_Un_ *~un~* ≡ _Un_ *~un~* ∪ \{ *_µ_* [0] mode 2 ^160^ }

0x3c EXTCODECOPIE 4 0 Copie un comptes code pour Mémoire.

∀ _je_ ∈ \{ 0 _. . . *µ *_[3] − 1 } : *_µ_*

[ *_µ_* [1] + _je_ ] ≡ f *b* [ *_µs_ [* 2] + _je_ ] si *_µs_ [* 2] + _je <_ ll *b* ll

où CEC ( *b* ) ≡ *_σ_* [ *_µ_* [0] mod _ _ 2 ^16 0^ ] c

Nous _ présumer *b* ≡ () si *_σ_* [ *_µ_* [0] mod _ _ 2 ^16 0^ ] = ∅ .

*_µ_* je _M_ ( *_µ_* je _, *µs [ *_*1* ] _, *µs *_*[* 3])

Le ajouts dans *_µ_* [2] + _je_ sont ne pas matière pour la 2 ^256^ modulo.

_Un_ *~un~* ≡ _Un_ *~un~* ∪ \{ *_µ_* [0] mode 2 ^160^ }

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 33

0x3d RETURNDATASIZE 0 1 Avoir Taille de production Les données depuis la précédent appel depuis la courant

environnement.

*_µs [_ 0* ] ≡ ll *_µ_ o* ll

0x3e RETOURDATACOPIE 3 0 Copie production Les données depuis la précédent appel pour Mémoire.

∀ _je_ ∈ \{ 0 _. . . *µ *_[2] − 1 } : *_µ_*

[ *_µ_* [0] + _je_ ] ≡ f *_µ_ o* [ *_µ_ s* [1] + _je_ ] si *_µs [_ 1* ] + _je <_ ll *_µ_ o* ll

Le ajouts dans *_µ_* [1] + _je_ sont ne pas matière pour la 2 ^256^ modulo.

*_µ_* je ≡ _M_ ( *_µ_* je _, *µs [ *_*0* ] _, *µs *_*[* 2])

0x3f EXTCODEHAS 1 1 Avoir hacher de un comptes code.

0 si MORT ( _*σ* , *µ *_[0] mode 2 ^160^ )

_Un_ *~un~* ≡ _Un_ *~un~* ∪ \{ *_µ_* [0] mode 2 ^160^ }
____

== 40 ans : Bloc Information

____
[#_bookmark144 .anchor]####où _P_ est la hacher de un bloc de un particulier Numéro, en haut pour un maximum âge. 0 est la gauche sur la pile si la regardé pour bloc Numéro est plus grand que ou alors

égal pour la courant bloc Numéro ou alors Suite que 256 blocs derrière la courant bloc.
____

_P_ ( _h, n, un_ ) ≡

[loweralpha, start=8]
. si _n_ = _Salut_ _

____
  _P_ ( _H_ p _, n, un_ + 1) autrement

et nous affirmer la entête _H_ pouvez être déterminé depuis son hacher _h_ sauf si _h_ est zéro (comme est la Cas pour la parent hacher de la genèse bloc).

0x41 COINBASE 0 1 Avoir la courant bloc de Bénéficiaire adresse.

*_µs [_ ~0 ~*] ≡ _je_ hc

0x42 Horodatage 0 1 Avoir la courant bloc de horodatage.

*_µs [_ ~0 ~*] ≡ _Je_ Hs

0x43 NUMÉRO 0 1 Avoir la courant bloc de Numéro.

*_µs [_ ~0 ~*] ≡ _je_ salut

0x44 DIFFICULTÉ 0 1 Avoir la courant bloc de difficulté.

*_µs [_ ~0 ~*] ≡ _je me_ suis

0x45 LIMITE DE GAZ 0 1 Avoir la courant bloc de gaz limite.

*_µs [_ ~0 ~*] ≡ _je_ hl

0x46 CHAINID 0 1 Avoir la link:#_bookmark1[chaîne IDENTIFIANT.]

*_µs [_ 0* ] ≡ _β_

0x47 AUTO-ÉQUILIBRE 0 1 Avoir solde de actuellement exécution Compte.

*_µ_* *s* [0] ≡ *_σ_* [ _je_ ~une~ ] ~b~

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 34
____

== 50 ans : Pile, Mémoire, Stockage et Flux Opérations

[width="100%",cols="10%,13%,3%,3%,71%",options="header",]
|===
a|
____
*Valeur*

0x50
____

a|
____
*Mnémonique*

POPULAIRE
____

a|
_δ_

____
1
____

a|
____
_α_

0
____

a|
____
*La description*

Éliminer Objet depuis pile.
____

|0x51 a|
____
MLOAD
____

a|
____
1
____

|1 a|
____
Charge mot depuis Mémoire.

*_µs [_ 0* ] ≡ *_µ_ m* [ *_µ_ s* [0] _. . ._ ( *_µs [_ 0* ] + 31)]

*_µ_* je ≡ max( *_µ_* je _,_ r ( *_µs [_ 0* ] + 32) ÷ 32 1 )

Le une addition dans la calcul de *_µ_* est ne pas matière pour la 2 ^256^ modulo.
____

je

|0x52 a|
____
MSTORE
____

a|
____
2
____

|0 a|
____
Sauver mot pour Mémoire.

*_µ_ m* [ *_µ_ s* [0] _. . ._ ( *_µs [_ 0* ] + 31)] ≡ *_µs [_ 1* ] *_µ_* je ≡ max( *_µ_* je _,_ r ( *_µs [_ 0* ] + 32) ÷ 32 1 )

Le une addition dans la calcul de *_µ_* est ne pas matière pour la 2 ^256^ modulo.
____

je

|0x53 a|
____
MSTORE8
____

a|
____
2
____

|0 a|
____
Sauver octet pour Mémoire.

*_µ_ m* [ *_µ_ s* [0]] ≡ ( *_µs [_ 1* ] mode 256)

*_µ_* je ≡ max( *_µ_* je _,_ r ( *_µs [_ 0* ] + 1) ÷ 32 1 )

Le une addition dans la calcul de *_µ_* est ne pas matière pour la 2 ^256^ modulo.
____

je

|0x54 a|
____
SLOAD
____

a|
____
1
____

|1 a|
____
Charge mot depuis stockage.
____

|===

____
*_µs [_ ~0 ~*] ≡ *_σ_* [ _je_ une ] *s* [ *_µ_ ~s ~*[0]]

_UN_ *K* ≡ *~AK~* ___ ∪ \{ ( _je_ ~un~ __, *µ *__f *s* [0]) }

[#_bookmark145 .anchor]####0x55 STORE 2 0 Sauver mot pour stockage.

*_σ_* [ _je_ une ] *s* [ *_µ_ ~s ~*[0]] ≡ *_µs [_ ~1 ~*]

*AK* ___ ≡ *~AK~* ___ ∪ \{ ( _je_ ~un~ _, *µs [ *_*0* ]) }

[#_bookmark146 .anchor]##_C_ ~SSTORE~ ( _*σ* , *µ *_) et _Un_ ~r~ sont spécifié par EIP-2200 comme suit.

Nous rappeler la lecteur que la point de contrôle ("original") Etat link:#_bookmark41[*_σ_* 0] est la Etat si la courant transaction ont été pour revenir.

Laisser _v_ 0 = *_σ_* 0 [ _je_ une ] *s* [ *_µ_ ~s ~*[0]] être la original valeur de la stockage insérer. Laisser _v_ = *_σ_* [ _je_ une ] *s* [ *_µ_ ~s ~*[0]] être la courant valeur.

Laisser _v_ = *_µs [_ 1* ] être la Nouveau valeur.

Puis:
____

_C_ SSTORE

( _*σ* , *µ* , UN, je_ ) 0 si ( _je_ ~une~ _, *µ *_*s* [0]) ∈ _A_ *~K~* _G_ ~charge froide~ autrement

____
   _G_ w armac c ess si _v_ = _v_ ∨ _v_ 0 = _v_

+ _G_ sset si _v_ = _v_ ∧ _v_ 0 = _v_ ∧ _v_ 0 = 0

  _G_ sreset si _v_ = _v_ ∧ _v_ 0 = _v_ ∧ _v_ 0 = 0

  _R_ ~clair~ si _v_ = _v_ ∧ _v_ ~0~ = _v_ ∧ _v_ = 0
____

où

____
  0 sinon

   − _R_ ~clair~ si _v_ ~0~ = 0 ∧ _v_ = 0

_r_ saleclair ≡

_r_ salereset ≡

_R_ ~clair~ si _v_ ~0~ = 0 ∧ _v_ = 0

0 sinon

_G_ sset − _G_ warmaccess si _v_ 0 = _v_ ∧ _v_ 0 = 0

_G_ sréinitialiser − _G_ warmaccess si _v_ 0 = _v_ ∧ _v_ 0 = 0

[#_bookmark147 .anchor]#### 0 sinon
____

[width="100%",cols="11%,10%,5%,3%,71%",options="header",]
|===
|0x56 a|
____
SAUTER
____

|1 a|
____
0 Modifier la programme compteur.
____

|
| | | | a|
____
_J_ SAUT ( *_µ_* ) ≡ *_µs [_ ~0 ~*]

Cette possède la effet de en écrivant mentionné valeur pour *_µ_* pc . Voir section link:#9._Execution_Model[9.]
____

|[#_bookmark148 .anchor]####0x57 a|
____
JUMPI
____

|2 a|
____
0
____

a|
____
Conditionnellement modifier la programme compteur.
____

|===

_J_ JUMPI

( *_µ_* ) *_µ_ s* [0] si *_µs [_ 1* ] = 0

____
*_µ_* pc + 1 autrement

Cette possède la effet de en écrivant mentionné valeur pour *_µ_* pc . Voir section link:#9._Execution_Model[9.]

0x58 PC 0 1 Avoir la valeur de la programme compteur _avant_ pour la incrément correspondant pour cette instruction.

*_µs [_ 0* ] ≡ *_µ_* pc

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 35

0x59 MSIZE 0 1 Avoir la Taille de actif Mémoire dans octets.

*_µs [_ 0* ] ≡ 32 *_µ_* je

0x5a GAZ 0 1 Avoir la montant de disponible gaz, y compris la correspondant réduction pour la Coût de cette instruction.

*_µs [_ 0* ] ≡ *_µg_* _

0x5b JUMPDEST 0 0 Marquer un valide destination pour saute.

Cette opération possède non effet sur machine Etat pendant exécution.
____

== années 60 & années 70 : Pousser Opérations Valeur Mnémonique _δ α_ La description

____
0x60 PUSH1 0 1 Lieu 1 octet Objet sur pile.

*_µ_* *s* [0] ≡ _c_ ( *_µ_* p c + f 1)
____

[width="100%",cols="9%,10%,81%",options="header",]
|===
| | a|
____
Le octets sont lis dans doubler depuis la programme codes octets déployer.

Le une fonction _c_ assure la octets défaut pour zéro si elles ou ils étendre passé la limites. Le octet est aligné à droite (prend la le plus bas important lieu dans gros endien).
____

a|
____
0x61
____

a|
____
PUSH2
____

a|
____
0 1 Lieu 2 octets Objet sur pile.
____

|===

____
. . .

*_µs [_ 0* ] ≡ *_c_* ( *_µpc_* _ + 1) _. . ._ ( *_µpc_* _ + 2)

avec *_c_* ( *_x_* ) ≡ ( _c_ ( *_x_* ~0~ ) _, ..., c_ ( _*x* ~X ~_~− 1~ )) avec _c_ comme défini comme au dessus de.

Le octets sont aligné à droite (prend la le plus bas important lieu dans gros endien).

. .

0x7f PUSH32 0 1 Lieu 32 octets (plein mot) Objet sur pile.

*_µs_* [0 *_]_ ≡* c ( *_µpc_* _ + 1) _. . ._ ( *_µpc_* _ + 32) où *_c_* est défini comme au dessus de.

Le octets sont aligné à droite (prend la le plus bas important lieu dans gros endien).
____

== années 80 : Reproduction Opérations

[width="100%",cols="16%,24%,7%,7%,46%",options="header",]
|===
|*Valeur* a|
____
*Mnémonique*
____

a|
____
_δ_
____

|_α_ a|
____
*La description*
____

|0x80 a|
____
DUP1
____

a|
____
1
____

|2 a|
____
Dupliquer 1er pile Objet.
____

|0x81 a|
____
DUP2
____

a|
____
2
____

|3 a|
____
*_µs [_ 0* ] ≡ *_µs [_ 0* ]

Dupliquer 2e pile Objet.
____

| | | | a|
____
*_µs [_ 0* ] ≡ *_µs [_ 1* ]
____

|===

____
. ....

0x8f DUP16 16 17 Dupliquer 16e pile Objet.

*_µs [_ 0* ] ≡ *_µs_ [* 15]
____

== Années 90 : Échanger Opérations

[width="100%",cols="14%,21%,6%,6%,53%",options="header",]
|===
|*Valeur* a|
____
*Mnémonique*
____

a|
____
_δ_
____

|_α_ a|
____
*La description*
____

|0x90 a|
____
SWAP1
____

a|
____
2
____

|2 a|
____
Échanger 1er et 2e pile éléments.

*_µs [_ 0* ] ≡ *_µs [_ 1* ]

*_µs [_ 1* ] ≡ *_µs [_ 0* ]
____

|0x91 a|
____
SWAP2
____

a|
____
3
____

|3 a|
____
Échanger 1er et 3ème pile éléments.
____

|===

____
. . .

*_µs [_ 0* ] ≡ *_µs_ [* 2]

*_µs_ [* 2] ≡ *_µs [_ 0* ]

. .

0x9f SWAP16 17 17 Échangez la 1ère et la 17ème pile éléments.

*_µs [_ 0* ] ≡ *_µs_ [* 16]

*_µs_ [* 16] ≡ *_µs [_ 0* ]

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 36
____

== a0s : Enregistrement Opérations

____
Pour tout enregistrement opérations, la Etat monnaie est pour ajouter un Additionnel Journal entrée sur pour la sous-état Journal séries:

_A_ *l* ≡ _A_ *~l~* · ( _je_ ~une~ _,_ *t* _, *µ *_*m* [ *_µ_ s* [0] _. . ._ ( *_µ_ s* [0] + *_µ_ s* [1] − 1)]) et pour mettre à jour la Mémoire consommation compteur: *_µ_* je ≡ _M_ ( *_µ_* je _, *µs [ *_*0* ] _, *µs [ *_*1* ])

Le entrée sujet séries, *t* , diffère par conséquent:
____

[width="100%",cols="12%,16%,3%,4%,65%",options="header",]
|===
|*Valeur* a|
____
*Mnémonique*
____

|_δ_ |_α_ a|
____
*La description*
____

|0xa0 a|
____
LOG0
____

a|
____
2
____

|0 a|
____
Ajouter Journal record avec non les sujets.
____

|0xa1 a|
____
LOG1
____

a|
____
3
____

|0 a|
____
*t* ≡ ()

Ajouter Journal record avec une sujet.
____

| | | | a|
____
*t* ≡ ( *_µs_ [* 2])
____

|===

____
. ....

0xa4 LOG4 6 0 Ajouter Journal record avec quatre les sujets.

*t* ≡ ( *_µs_ [* 2] _, *µs *_*[* 3] _, *µs *_*[* 4] _, *µs *_*[* 5])

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 37
____

== f0s : Système opérations

____
*Valeur Mnémonique* _δ α_ *La description*

0xf0 CRÉER 3 1 Créer un Nouveau Compte avec associé code.

*je* ≡ *_µ_ m* [ *_µ_ s* [1] _. . ._ ( *_µs [_ 1* ] + *_µs_ [* 2] − 1)]

link:\l[_ζ_] ≡ ∅

( _*σ* , *µg* ,_ _ _UN , z,_ *o* ) ≡

   link:#_bookmark44[Λ (] *_σ_* ^∗^ _, UN, je_ ~un~ _, je_ ~o~ _, L_ ( *_µ_* g ) _, je_ ~p~ _, *µs [ *_*0* ] _,_ *je* _, je_ ~e~ + 1 _, , _ je_ ~w~ ) si *_µs [_ 0* ] *_σ_* [ _je_ ~une~ ] ~b~

  _*σ* , *µg* ,_ _ _UN,_ 0 _,_ () autrement

*_σ_* ^∗^ ≡ *_σ_* à l'exception *_σ_* ^∗^ [ _je_ une ] n = *_σ_* [ _je_ une ] n + 1

*_µs [_ 0* ] ≡x ___

où _X_ = 0 si _z_ = 0, c'est à dire, la link:#_bookmark48[Contrat création processus manqué,] ou alors _je_ e = 1024

(la m axi m um appel profondeur J'imite _ est atteint ) _ ou alors *_µs [_ 0* ] _> *σ *_[ _je_ ~une~ ] ~b~ (solde de la l'appelant est aussi bas pour remplir la valeur transférer); et sinon _x_ = ADDR ( _je_ une _, *σ *_[ _je_ une ] n _, ζ,_ *je* ), la adresse de la nouvellement créé Compte link:#_bookmark45[(86).]

*_µ_* je ≡ _M_ ( *_µ_* je _, *µs [ *_*1* ] _, *µs *_*[* 2])

*_µo_ _* ≡ ()

Ainsi la opérande Commande est: valeur, saisir décalage, saisir Taille.
____

0xf1 APPEL 7 1 Message-appel dans un Compte.

( _*σ* , g , UN , X,_ *o* ) ≡

____
link:#_bookmark47[Θ (] _*σ* , UN , je_ un _, je_ o _, t, t, C_ CALGAS ( _*σ* , *µ* , A_ ) _,_

_je_ p _, *µs *_*~[~* 2] _, *µs *_*~[~* 2] _,_ *je* _, je_ e + 1 _, je_ w )

si *_µs_ [* 2] *_σ_* [ _je_ ~une~ ] ~b~ ∧

_je_ e _<_ 1024

( _*σ* , g, UN,_ 0 _,_ ()) sinon

_n_ ≡ min( \{ *_µ_ s* [6] _,_ ll *o* ll} )

*_µ_ m* [ *_µ_ s* [5] _. . ._ ( *_µs_ [* 5] + _n_ − 1)] = *o* [0 _. . ._ ( _n_ − 1)]

*_µo_ _* = *o*

*_µg_* _ ≡ *_µg_* _ + _g_

*_µs [_ 0* ] ≡x ___

_Un_ ^∗^ ≡ _UN_ à l'exception _Un_ ^∗^ *~un~* ≡ _Un_ *~un~* ∪ \{ _t_ }

_t_ ≡ *_µ_* [1] mode 2 ^160^

*_µ_* je ≡ _M_ ( _M_ ( *_µ_* je _, *µs *_[3] _,_ *µs [* 4]) _, *µs [ *_*5* ] _, *µs *_*[* 6])

où _X_ = 0 si la link:#_bookmark50[code exécution pour cette opération manqué,] ou alors si

*_µs_ [* 2] _> *σ *_[ _je_ ~une~ ] ~b~ (ne pas pas assez fonds) ou alors _je_ ~e~ = 1024 (appel profondeur limite atteint ) ; _ _X_ = 1 sinon.

Ainsi la opérande Commande est: gaz, pour, valeur, dans décalage, dans Taille, dehors décalage, dehors Taille.

_C_ CAL L ( _*σ* , *µ* , A_ ) ≡ _C_ G A f SCA P ( _*σ* , *µ* , A_ ) + _C_ EXTR A ( _*σ* , *µ* , A_ )
____

_C_ GASCAP

( _*σ* , *µ* , A_ ) min \{ link:#_bookmark141[_L_] ( *_µ_* ~g~ − _C_ EXTRA ( _*σ* , *µ* , A_ )) _, *µs [ *_*~0~* ] } si *_µg_* ~_~ ≥ _C_ EXTRA ( _*σ* , *µ* , A_ )

____
*_µs [_ 0* ] sinon

_C_ EXTR A ( _*σ* , *µf* ,_ _ _A_ ) ≡ link:#_bookmark140[_C_ a accès s] ( _t, A_ ) + _C_ XFE R ( *_µ_* ) + _C_ NE W ( _*σ* , *µ *_)
____

_C_ NOUVEAU

( _*σ* , *µ *_) _G_ nouveau compte si MORT ( _*σ* , t_ ) ∧ **_µs_ ~[ ~**2] 0

____
0 sinon

0xf2 CODE APPEL 7 1 Message-appel dans cette Compte avec un alternative comptes code.

Exactement équivalent pour APPEL à l'exception:
____

( _*σ* , g , UN , X,_ *o* ) ≡

____
Θ ( _*σ* , A_ ^∗^ _, je_ un _, je_ o _, je_ un _, t, C_ CALGAS ( *_µ_* ) _,_

_je_ p _, *µs *_*~[~* 2] _, *µs *_*~[~* 2] _,_ *je* _, je_ e + 1 _, je_ w )

si *_µs_ [* 2] *_σ_* [ _je_ ~une~ ] ~b~ ∧

_je_ e _<_ 1024

( _*σ* , g, UN,_ 0 _,_ ()) sinon

Noter la monnaie dans la Quatrième paramètre pour la appel link:#_bookmark47[Θ] depuis la 2e pile valeur *_µs [_ ~1 ~*] (comme dans APPEL ) pour la cadeau adresse _je_ un . Cette moyens que la destinataire est dans fait la même Compte comme à cadeau, simplement que la code est écrasé.

[#_bookmark149 .anchor]####0xf3 RETOUR 2 0 Arrêt exécution retour production Les données.

_H_ RETOUR ( *_µ_* ) ≡ *_µ_ ~m ~*[ *_µ_ ~s ~*[0] _. . ._ ( *_µs [_ ~0 ~*] + *_µs [_ ~1 ~*] − 1)]

Cette possède la effet de s'arrêter la exécution à cette indiquer avec production défini.

Voir section link:#9._Execution_Model[9.]

*_µ_* je ≡ _M_ ( *_µ_* je _, *µs [ *_*0* ] _, *µs [ *_*1* ])

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 38
____

0xf4 DÉLÉGUÉ APPEL 6 1 Message-appel dans cette Compte avec un alternative comptes code, mais

____
persistant la courant valeurs pour _expéditeur_ et _valeur_ .

Par rapport avec APPEL , APPEL DÉLÉGUÉ prend une moins de arguments. Le omis argument est *_µs_* [2] *.* Comme un résultat, *_µs_ [* 3], *_µs_ [* 4], *_µs_ [* 5] et *_µs_ [* 6] dans la définition de APPEL devrait respectivement être remplacé avec *_µs_ [* 2], *_µs_ [* 3], *_µs_ [* 4] et *_µs_* [5] *.* Autrement ce est équivalent pour APPEL à l'exception:

   Θ( _*σ* , A_ ^∗^ _, je_ suis _, je_ o _, je_ un _, t, C_ CALLGA S ( *_µ_* ) _,_

si _je_

_<_ 1024

( _*σ* , g, UN,_ 0 _,_ ()) sinon

Noter la changements (dans une addition pour que de la Quatrième paramètre) pour la seconde et neuvième paramètres pour la appel link:#_bookmark47[Θ.]

Cette moyens que la destinataire est dans fait la même Compte comme à cadeau, simplement que la code est écrasé _et_ la le contexte est presque entièrement identique.
____

[width="100%",cols="8%,16%,3%,73%",options="header",]
|===
a|
____
[#_bookmark150 .anchor]####0xf5
____

a|
____
CRÉER2
____

a|
____
4
____

a|
____
1 Créer un Nouveau Compte avec associé code. Exactement équivalent pour CRÉER à l'exception:

Le sel _ζ_ ≡ *_µs_* [3] *.*
____

a|
____
0xfa
____

a|
____
APPEL STATIQUE
____

a|
____
6
____

a|
____
1 Statique message-appel dans un Compte. Exactement équivalent pour APPEL à l'exception:

Le argument *_µs_ [* 2] est remplacé avec 0.

Le Plus profond argument *_µs_ [* 3], *_µs_ [* 4], *_µs_ [* 5] et *_µs_ [* 6] sont respectivement remplacé avec *_µs_ [* 2], *_µs_ [* 3], *_µs_ [* 4] et *_µs_* [5] *.*

Le dernière argument de link:#_bookmark47[Θ] est ⊥ .
____

a|
____
[#_bookmark151 .anchor]####0xfd
____

a|
____
REVENIR
____

a|
____
2
____

a|
____
0 Arrêt exécution revenant Etat changements mais retour Les données et restant gaz. Le effet de cette opération est décrit dans link:#_bookmark55[(143).]

Pour la gaz calcul, nous utiliser la Mémoire expansion une fonction,

*_µ_* je ≡ _M_ ( *_µ_* je _, *µs [ *_*0* ] _, *µs [ *_*1* ])
____

a|
____
0xfe
____

a|
____
INVALIDE
____

a|
____
∅
____

a|
____
∅ Désigné invalide instruction.
____

a|
____
[#_bookmark152 .anchor]####0xff
____

a|
____
AUTO-DESTRUCTION
____

a|
____
1
____

a|
____
0 Arrêt exécution et S'inscrire Compte pour plus tard effacement.
____

|===

____
_Un_ *~s~* ≡ _Un_ *~s~* ∪ \{ _je_ ~un~ }

_Un_ *~un~* ≡ _Un_ *~un~* ∪ \{ _r_ }
____

*_σ_* [ _r_ ] ≡

____
( *_σ_* [ _r_ ] ~n~ _, *σ *_[ _r_ ] ~b~ + *_σ_* [ _je_ ~une~ ] ~b~ _, *σ *_[ _r_ ] *~s~* _, *σ *_[ _r_ ] ~c~ ) si _r_ = _je_ ~un~

 ( *_σ_* [ _r_ ] n _,_ 0 _, *σ *_[ _r_ ] *s* _, *σ *_[ _r_ ] c ) sinon

où _r_ = *_µ_* [0] mode 2 ^160^

*_σ_* [ _je_ ~une~ ] ~b~ = 0

_C_ AUTODESTRUCTION
____

( _*σ* , *µ *_) ≡ _g_

auto-destruction

____
+ 0 si _r_ ∈ link:#_bookmark39[_Un_ *un*]

_G_ coldaccountacces autrement

+ ~Compte~ _G_ ~ne w _ _~ si MORT ( _*σ* , r_ ) ∧ *_σ_* [ _je_ ~une~ ] ~b~ = 0

0 sinon

annexe JE. Genèse Bloc

[#_bookmark153 .anchor]####Le genèse bloc est 15 éléments, et est spécifié Donc:

{empty}(331) 0 256 _,_ KEC RLP () _,_ 0 160 _, étatRoot,_ 0 _,_ 0 _,_ 0 2048 _,_ 2 34 _,_ 0 _,_ 0 _,_ 3141592 _, temps,_ 0 _,_ 0 256 _,_ KEC (42) _,_ () _,_ ()

Où 0 256 fait référence au hachage parent, un hachage de 256 bits composé uniquement de zéros ; 0 160 fait référence à l'adresse du bénéficiaire, un 160 bits hachage composé uniquement de zéros ; 0 2048 fait référence à la floraison du journal, 2048 bits de tous les zéros ; 2 ^34^ fait référence à la difficulté; l'essai de transaction racine, racine de trie de réception, gaz utilisé, numéro de bloc et données supplémentaires sont tous deux 0, ce qui équivaut au tableau d'octets vide. Le séquences de tous les deux ommers et transactions sont vider et représentée par (). KEC (42) réf rs pour e e Keccak-256 hacher de

La série de preuves de concept comprend une prémine de développement, faisant du hachage de la racine d'état une valeur _stateRoot_ . Aussi _time_ sera défini sur l'horodatage initial du bloc de genèse. La documentation la plus récente doit être consultée pour ceux valeurs.

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 39

[#Appendix_J._Ethash .anchor]####annexe J Éthash
____

[arabic]
. *Définitions.* Nous employer la Suivant définitions : Nom ValeurDescription

____
_J_ ~motoctets~ 4 octets en mot.

[#_bookmark156 .anchor]##_J_ ~datasetinit~ 2 ^30^ octets dans base de données à genèse. _J_ ~datasetgrowth~ 2 ^23 Croissance de l'ensemble de^ données par époque. [#_bookmark155 .anchor]##_J_ ~cacheinit~ 2 ^24^ octets dans cache à la genèse. _J_ ~cachecroissance~ 2 ^17^ Croissance du cache par époque.
____

[width="100%",cols="21%,13%,66%",options="header",]
|===
a|
____
[#_bookmark157 .anchor]##_J_ époque
____

a|
____
30000
____

a|
____
Blocs par époque.
____

a|
____
_J_ mixbytes
____

a|
____
128
____

a|
____
mélanger longueur dans octets.
____

a|
____
_J_ octets de hachage
____

a|
____
64
____

a|
____
Hacher longueur dans octets.
____

a|
____
_J_ parents
____

a|
____
256
____

a|
____
Numéro de parents de chaque base de données élément.
____

a|
____
Tours de cache _J_
____

a|
____
3
____

a|
____
Numéro de Les manches dans cache production.
____

a|
____
_J_ accède
____

a|
____
64
____

a|
____
Numéro de accède dans hashimoto boucle.
____

|===

[arabic, start=2]
. *Taille de base de données et cache.* Le Taille pour d'Ethash cache *c* ∈ B et base de données *ré* ∈ B dépendre sur la époque, qui dans tourner dépend sur la bloc Numéro.

____
{empty}(332) _E_ ( _H_ ) = +++_Salut_ _+++

La taille de la croissance du jeu de données par _J_ ~datasetgrowth~ octets, et la taille du cache par _J_ ~cachegrowth~ octets, chaque époque. Dans Afin d'éviter une régularité conduisant à un comportement cyclique, la taille doit être un nombre premier. La taille est donc réduite d'un multiple de _J_ ~mixbytes~ , pour le jeu de données, et _J_ ~hashbytes~ pour le cache. Soit _d_ ~taille~ = ll *d* ll soit la taille de l'ensemble de données. Lequel est calculé en utilisant
____

[arabic, start=333]
. taille _d_ = _E_ prime ( _J_ datasetinit + Croissance du jeu de données _J_ · _E_ époque − _J_ mixbytes _, J_ mixbytes )

____
Le Taille de la cachette, taille _c_ , est calculé en utilisant
____

[arabic, start=334]
. taille _C_ = _E_ prime ( _J_ cacheinit + Croissance du cache _J_ · _E_ époque − _J octets de_ hachage _, J_ octets de hachage )
. _E_

prime

( _x, y_ ) = _x_ si _x/y_ ∈ N

____
_E_ premier ( _x_ − 2 · _y, y_ ) autrement
____

[arabic]
. *Base de données génération.* Dans Commande pour produire la base de données nous avoir besoin la cache *c* , qui est un déployer de octets. Ce dépend sur la cache Taille taille _C_ et la la graine hacher *s* ∈ B 32 .
[arabic]
.. _Hachage de graines._ Le hachage de graines est différent pour chaque époque. Pour la première époque c'est le hachage Keccak-256 d'une série de 32 octets de des zéros. Pour tous autre époque ce est toujours la Keccak-256 hacher de la précédent la graine hacher:

[arabic, start=336]
. *s* = _C_ ~seedhash~ ( _H_ ~i~ )
. _C_ seedhash

( _H_ ) = f *0* ~32~ si _Ep_ ~o c h~ ( _H_ ~je~ ) ~_ _~ = 0

____
Avec *0* 32 être 32 octets de des zéros.

KEC ( _C_ ~seedhas h~ ( _H_ ~i~ − _J_ ~e p o c h~ )) autrement
____

[arabic]
. _Cachette._ Le processus de production de cache consiste à utiliser le hachage de départ pour d'abord remplir séquentiellement des octets de taille _c de_ Mémoire, alors effectuer ~Tours de cache~ _J_ passe de la RandMemoHash algorithme créé par link:#_bookmark85[Lerner [2014] ]. Le initial cache *c* , être un déployer de tableaux de Célibataire octets, sera être construit comme suit.

____
Nous définir la déployer *c* _je_ , qui consiste de 64 Célibataire octets, comme la _je_ e élément de la initial cache :
____

[arabic, start=338]
. *c* _je_

____
Donc *c* pouvez être défini comme
____

= KEC512 ( *s* ) si _je_ = 0

KEC512 ( *c* _je_ − 1 ) autrement

[arabic, start=339]
. *c* [ _je_ ] = *c* _je_ ∀ _je < n_
. _n_ = +++taille _C_+++

____
_J_ octets de hachage

Le cache est calculé par effectuer ~Tours de cache~ _J_ Les manches de la RandMemoHash algorithme pour la initial cache *c* :
____

[arabic, start=341]
. *c* = _E_ rondes de cache ( *c* _, J_ tours de cache )
. _E tours de_ ~cache~ ( *x* _, y_ ) =

____
_E_ RMH ( *x* ) si _y_ = 1

  _E_ ~ca c heround s~ ( _E_ ~RM H~ ( *x* ) _, y_ − 1) autrement

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 40

Où un Célibataire tour modifie chaque sous-ensemble de la cache comme suit :

{empty}(343) _E_ ~RMH~ ( *x* ) = _E_ ~rmh~ ( *x* _,_ 0) _, E_ ~rmh~ ( *x* _,_ 1) _, , E_ ~rmh~ ( *x* _, n_ − 1)

{empty}(344) _E_ ~rmh~ ( *x* _, je_ ) = KEC512 ( *x* [( _je_ − 1 + _n_ ) mode _n_ ] ⊕ *X* [ *x* [ _je_ ][0] mode _n_ ])

avec *X* = *X* à l'exception *X* [ _j_ ] = _E_ ~rmh~ ( *x* _, j_ ) ∀ _j < je_
____

[arabic]
. [#_bookmark158 .anchor]##_Plein base de données calcul._ Essentiellement, nous combiner Les données depuis _J_ parents pseudo-aléatoire choisi cache nœuds, et hacher que pour calculer la base de données. Le entier base de données est alors généré par un Numéro de éléments, chaque _J_ ~octets de hachage~ octets dans Taille:

____
{empty}(345) *ré* [ _je_ ] = _E_ ~élément de jeu de données~ ( *c* _, je_ ) ∀ _je <_

+++taille _d_+++

octets de hachage

Dans Commande pour calculer la Célibataire Objet nous utiliser un algorithme inspiré par la FNV hacher link:#_bookmark97[(Glenn Chasseur [1991])] dans quelques cas comme un non associatif remplaçant pour XOR.

{empty}(346) _E_ ( *x* _,_ *y* ) = ( *x* · (0x01000193 ⊕ *y* )) mode 2 ^32^

Le Célibataire Objet de la base de données pouvez à présent être calculé comme:
____

[arabic, start=347]
. _E_ ~ensemble de données m~ ( *c* _, je_ ) = _É_ ~pare n t s~ ( *c* _, je,_ − 1 _,_ ∅ )
. _E_

parents

( *c* _, je, p,_ *m* ) = _E_ parents ( *c* _, je, p_ + 1 _, E_ mix ( *m* _,_ *c* _, je, p_ + 1)) si _p < J_ parents − 2

____
_E_ mix ( *m* _,_ *c* _, je, p_ + 1) sinon

f KEC512 ( *c* [ _je_ mod _ _ _c_ taille e ] ⊕ _je_ ) si _p_ = 0
____

[arabic]
. *Fonction de preuve de travail.* Essentiellement, nous maintenons un "mix" _J_ ~mixbytes~ octets de large, et récupérer séquentiellement à plusieurs reprises _J_ ~mixbytes~ octets du jeu de données complet et utilisez la fonction _E_ ~FNV~ pour le combiner avec le mix. _J_ ~mixbytes~ octets séquentiels accéder sont utilisé alors que chaque tour de la algorithme toujours extractions un plein page depuis RAM, minimiser Traduction regarder de côté amortir manque qui ASIC voudrais théoriquement être capable pour éviter de.

____
Si la production de cette algorithme est au dessous de la voulu cibler, alors la nonce est valide. Noter que la En plus application de KEC à la fin assure qu'il existe un nonce intermédiaire qui peut être fourni pour prouver qu'au moins un petit la quantité de travail a été effectuée; cette vérification PoW externe rapide peut être utilisée à des fins anti-DDoS. Il sert également à fournir statistique assurance que la résultat est un impartial, 256 bit Numéro.

Le Fonction PoW Retour un déployer avec la comprimé mélanger comme son première Objet et la Keccak-256 hacher de la enchaînement de la comprimé mélanger avec la la graine hacher comme la seconde Objet:

(350)

PoW ( _H_ n _, H_ ~n~ _,_ *ré* ) = \{ *m* ~c~ ( KEC ( RLP ( _L_ ~H~ ( _H_ n ))) _, H_ ~n~ _,_ *d* ) _,_ KEC ( *s* ~h~ ( KEC ( RLP ( _L_ ~H~ ( _H_ n ))) _, H_ ~n~ ) + *m* ~c~ ( KEC ( RLP ( _L_ ~H~ ( _H_ n ))) _, H_ ~n~ _,_ *d* )) }

Avec _H_ n être la hacher de la entête sans pour autant la nonce. Le comprimé mélanger *m* c est obtenu comme suit :

_n_ mélanger
____

[arabic, start=351]
. *m* ~c~ ( *h* _,_ *n* _,_ *ré* ) = _E_ ~compresse~ ( _E_ ~accède s~ ( *d* _,_ ~_~ *s* ~h~ ( *h* _,_ *n* ) _,_ *s* ~h~ ( *h* _,_ *n* ) _,_ − 1) _,_ − 4)

____
_je_ =0

Le la graine hacher être:
____

[arabic, start=352]
. *s* ~h~ ( *h* _,_ *n* ) = KEC512 ( *h* + _E_ ~re v e r t~ ( *n* )) _E_ revert ( *n* ) Retour la inversé octets séquence de la nonce *n* :
. _E_ re v er t ( *n* )[ _i_ ] = *n* [ ll *n* ll − _je_ ]

____
Nous Remarque que la Opérateur "+" entre deux octet séquences résultats dans la enchaînement de tous les deux séquences.

Le base de données *ré* est obtenu comme décrit dans section link:#_bookmark158[J.3.3.] Le Numéro de répliqué séquences dans la mélanger est:
____

[arabic, start=354]
. _n_

mélanger

____
= +++_J_ mixbytes+++

octets de hachage

Dans Commande pour ajouter Aléatoire base de données nœuds pour la mélanger, la _E_ accède une fonction est utilisé:
____

[arabic, start=355]
. _E_

accède

( *ré* _,_ *moi* _,_ *s* _, je_ ) = _E_ mixdataset ( *d* _,_ *moi* _,_ *s* _, je_ ) si _je_ = _J_ accède − 2

____
_E_ ~accède à~ ( _E_ ~mixdataset~ ( *d* _,_ *moi* _,_ *s* _, je_ ) _,_ *s* _, je_ + 1) autrement
____

[arabic, start=356]
. _E_ ~mixdataset~ ( *d* _,_ *moi* _,_ *s* _, je_ ) = _E_ ~FNV~ ( *m* _, E_ ~nouvelledonnée~ ( *d* _,_ *moi* _,_ *s* _, je_ )) _E_ ~nouvelles données~ Retour un déployer avec _n_ ~mélanger~ éléments:
. _E_ ( *ré* _,_ *moi* _,_ *s* _, je_ )[ _j_ ] = *ré* [ _E_ ( _je_ ⊕ *s* [0] _,_ *m* [ _je_ mode +++_J_ mixbytes+++ ]) mode +++_d_ taille _/J_ octets de hachage+++ · _n_

____
+ _j_ ] ∀ _j < n_

ÉTHERUM : UN SÉCURISE DÉCENTRALISÉ GÉNÉRALISÉ TRANSACTION COMPTABLE *BERLIN VERSION* 41

Le mélanger est comprimé comme suit :
____

[arabic, start=358]
. _E_

compresse

( *moi* _, je_ ) = *moi* si _je_ ;;: ll *m* ll − 8

____
_E_ compresser ( _E_ FNV ( _E_ FNV ( _E_ FNV ( *m* [ _i_ + 4] _,_ *m* [ _je_ + 5]) _,_ *m* [ _je_ + 6]) _,_ *m* [ _je_ + 7]) _, je_ + 8) autrement

annexe K Anomalies sur la Principale Réseau

K.1. *Suppression d'un compte malgré la panne d'essence.* Au bloc 2675119, dans la transaction 0xcf416c536ec1a19ed1fb89e 4ec7ffb3cf73aa413b3aa9b77d60e4fd81a4296ba, un compte à l'adresse 0x03 a été appelé et une panne de gaz s'est produite pendant l'appel. Contre l'équation link:#_bookmark120[(207),] cela a ajouté 0x03 dans l'ensemble des adresses touchées, et cette transaction est devenue *_σ_* [0 _x_ 03] dans ∅ .

annexe L Lister de mathématique symboles

Symbole Latex Commande La description

\bigvee Ceci est la moins plus haut lié, suprême, ou alors rejoindre de tout éléments exploité sur. Ainsi ce est la le plus grand élément de tel éléments link:#_bookmark88[(Davey et Priestley [2002] ]).
____
